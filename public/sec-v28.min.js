var cdwpb;!function(){"use strict";var n={492:function(e,t,n){function apply(e){function Qe(e,t){for(var n=0,r=i.length,o=[];n<r;n++)i[n][e]==t&&o.push(i[n]);return o}function Re(e,t){for(var n,r=i.length;r--;)(n=i[r]).entryType!=e||void 0!==t&&n.name!=t||i.splice(r,1)}var t=Date.now?Date.now():+new Date,r=e.performance||{},i=[],o={};r.now||(r.now=r.webkitNow||r.mozNow||r.msNow||function(){return(Date.now?Date.now():+new Date)-t}),r.mark||(r.mark=r.webkitMark||function(e){var t={name:e,entryType:"mark",startTime:r.now(),duration:0};i.push(t),o[e]=t}),r.measure||(r.measure=r.webkitMeasure||function(e,t,n){if(void 0!==n&&void 0===o[n])throw new SyntaxError("Failed to execute 'measure' on 'Performance': The mark '"+n+"' does not exist.");if(void 0!==t&&void 0===o[t])throw new SyntaxError("Failed to execute 'measure' on 'Performance': The mark '"+t+"' does not exist.");t=o[t]?o[t].startTime:0,n=o[n]?o[n].startTime:r.now(),i.push({name:e,entryType:"measure",startTime:t,duration:n-t})}),r.getEntriesByType||(r.getEntriesByType=r.webkitGetEntriesByType||function(e){return Qe("entryType",e)}),r.getEntriesByName||(r.getEntriesByName=r.webkitGetEntriesByName||function(e){return Qe("name",e)}),r.clearMarks||(r.clearMarks=r.webkitClearMarks||function(e){Re("mark",e)}),r.clearMeasures||(r.clearMeasures=r.webkitClearMeasures||function(e){Re("measure",e)}),e.performance=r,"function"==typeof define&&n.amdO&&define("performance",[],function(){return r})}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Polyfills_apply(){var r,t,n;function Uf(e){return"function"==typeof e||"[object Function]"===t.call(e)}function Vf(e){return e=Number(e),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}function Xf(e){return e=Vf(e),Math.min(Math.max(e,0),n)}Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}),Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),1}catch(e){return}}()||(r=Object.defineProperty,Object.defineProperty=function(e,t,n){if(r)try{return r(e,t,n)}catch(e){}if(e!==Object(e))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in n&&Object.prototype.__defineGetter__.call(e,t,n.get),Object.prototype.__defineSetter__&&"set"in n&&Object.prototype.__defineSetter__.call(e,t,n.set),"value"in n&&(e[t]=n.value),e}),"function"!=typeof Object.defineProperties&&(Object.defineProperties=function(e,t){if(e!==Object(e))throw TypeError("Object.defineProperties called on non-object");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&Object.defineProperty(e,n,t[n]);return e}),"function"!=typeof Object.create&&(Object.create=function(e,t){if("object"!==_typeof(e))throw TypeError();function Ctor(){}Ctor.prototype=e;var n=new Ctor;if(e&&(n.constructor=Ctor),void 0!==t){if(t!==Object(t))throw TypeError();Object.defineProperties(n,t)}return n}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw TypeError("Object.keys called on non-object");var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,r;if(null==this)throw new TypeError(" this is null or not defined");var o,i=Object(this),s=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=t),r=0;r<s;)r in i&&(o=i[r],e.call(n,o,r,i)),r++}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw TypeError("Bind must be called on a function");function Sf(){return r.apply(this.prototype&&this instanceof nop?this:e,n.concat(t.call(arguments)))}var t=[].slice,n=t.call(arguments,1),r=this;function nop(){}return nop.prototype=r.prototype,Sf.prototype=new nop,Sf}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.from||(Array.from=(t=Object.prototype.toString,n=Math.pow(2,53)-1,function from(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,r=1<arguments.length?arguments[1]:void 0;if(void 0!==r){if(!Uf(r))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=arguments[2])}for(var o,i=Xf(t.length),s=Uf(this)?Object(new this(i)):new Array(i),a=0;a<i;)o=t[a],s[a]=r?void 0===n?r(o,a):r.call(n,o,a):o,a+=1;return s.length=i,s})),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function value(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function value(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0==r)return!1;var t=0|t,o=Math.max(0<=t?t:r-Math.abs(t),0);for(;o<r;){if(function sameValueZero(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}(n[o],e))return!0;o++}return!1},configurable:!0,writable:!0}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function assign(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===t&&(t=0),-1!==this.indexOf(e,t)}),self.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function WeakMapPolyfill_typeof(e){return(WeakMapPolyfill_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WeakMapPolyfill_apply(e){var n,r;function isObject(e){return Object(e)===e}function checkInstance(e,t){if(!isObject(e)||!n.call(e,"_id"))throw new TypeError(t+" method called on incompatible receiver "+WeakMapPolyfill_typeof(e))}function rand(){return Math.random().toString().substring(2)}function WeakMap(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(r(this,"_id",function genId(e){return e+"_"+rand()+"."+rand()}("_WeakMap")),0<arguments.length)throw new TypeError("WeakMap iterable is not supported")}e.WeakMap||(n=Object.prototype.hasOwnProperty,r=function defineProperty(e,t,n){Object.defineProperty?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:n}):e[t]=n},e.WeakMap=(r(WeakMap.prototype,"delete",function(e){if(checkInstance(this,"delete"),!isObject(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)&&(delete e[this._id],!0)}),r(WeakMap.prototype,"get",function(e){if(checkInstance(this,"get"),isObject(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}}),r(WeakMap.prototype,"has",function(e){if(checkInstance(this,"has"),!isObject(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)}),r(WeakMap.prototype,"set",function(e,t){if(checkInstance(this,"set"),!isObject(e))throw new TypeError("Invalid value used as weak map key");var n=e[this._id];return n&&n[0]===e?n[1]=t:r(e,this._id,[e,t]),this}),r(WeakMap,"_polyfill",!0),WeakMap))}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{default:function(){return Co}});var c=function(){function HttpRequestFactory(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HttpRequestFactory)}return function _createClass(e,t,n){t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(HttpRequestFactory,null,[{key:"create",value:function create(){if(self.XMLHttpRequest&&Object.prototype.hasOwnProperty.call(XMLHttpRequest.prototype,"withCredentials"))return new XMLHttpRequest;if(self.XDomainRequest)return new XDomainRequest;if(!self.XMLHttpRequest)throw new Error("There is no supported http request object");return new XMLHttpRequest}}]),HttpRequestFactory}(),r=1,o=0,i=-1;function CDUtils_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a,s,u,l=(a=null,function(o,e,i){function Hh(){return e}var s,t;(function testNativeCode(){return-1<e.toString().indexOf("[native code]")})()?i(Hh()):(s=0,t=function timerFunction(){if(a.contentWindow){for(var e=a.contentWindow,t=o.split("."),n=e,r=0;r<t.length;r++)n=n[t[r]];i(n)}else s<45?(setTimeout(timerFunction,s),s++):i(Hh())},a||((a=document.createElement("IFRAME")).setAttribute("sandbox","allow-same-origin"),a.style.display="none",document.documentElement.appendChild(a)),t())}),f=function(){function CDUtils(){!function CDUtils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CDUtils)}return function CDUtils_createClass(e,t,n){t&&CDUtils_defineProperties(e.prototype,t),n&&CDUtils_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CDUtils,null,[{key:"isUndefinedNull",value:function isUndefinedNull(e){return null==e||void 0===e}},{key:"isBoolean",value:function isBoolean(e){return"boolean"==typeof e}},{key:"addEventListener",value:function addEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=5<arguments.length&&void 0!==arguments[5]&&arguments[5];this.isPassiveSupported?e.addEventListener(t,n,{capture:r,passive:o,once:i}):e.addEventListener?e.addEventListener(t,n,r):e.attachEvent("on"+t,n)}},{key:"removeEventListener",value:function removeEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent("on"+t,n)}},{key:"hasProtocol",value:function hasProtocol(e){return e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")}},{key:"clearTextFromNumbers",value:function clearTextFromNumbers(e){return e?e.replace(/(\d)/g,"*"):""}},{key:"maskText",value:function maskText(e){return this.isUndefinedNull(e)?"":e.replace(/[\d]/g,"1").replace(/[a-zA-Z]/g,"a").replace(/[^a-zA-Z\d\u0000-\u0080]/g,"*")}},{key:"getDropDownListValues",value:function getDropDownListValues(e){for(var t=[],n=0;n<e.length;n++){var r=e.options[n].text||e.options[n].value||"";t.push(CDUtils.maskText(r))}return t}},{key:"getDocUrl",value:function getDocUrl(){var e=window.location;return e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")+CDUtils.clearTextFromNumbers(e.pathname)}},{key:"getHash",value:function getHash(e){for(var t=0,n=0,r=e.length;n<r;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}},{key:"getTruncatedHash",value:function getTruncatedHash(e,t){return e?this.murmurhash3(e).toString().substring(t):""}},{key:"murmurhash3",value:function murmurhash3(e,t){for(var n,r,o=3&e.length,i=e.length-o,s=t,a=3432918353,c=461845907,u=0;u<i;)r=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,s=27492+(65535&(n=5*(65535&(s=(s^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*c+(((r>>>16)*c&65535)<<16)&4294967295)<<13|s>>>19))+((5*(s>>>16)&65535)<<16)&4294967295))+((58964+(n>>>16)&65535)<<16);switch(r=0,o){case 3:r^=(255&e.charCodeAt(u+2))<<16;break;case 2:r^=(255&e.charCodeAt(u+1))<<8;break;case 1:s^=r=(65535&(r=(r=(65535&(r^=255&e.charCodeAt(u)))*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*c+(((r>>>16)*c&65535)<<16)&4294967295}return s^=e.length,s=2246822507*(65535&(s^=s>>>16))+((2246822507*(s>>>16)&65535)<<16)&4294967295,s=3266489909*(65535&(s^=s>>>13))+((3266489909*(s>>>16)&65535)<<16)&4294967295,(s^=s>>>16)>>>0}},{key:"generateUUID",value:function generateUUID(){var n=CDUtils.dateNow();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)})}},{key:"convertToArrayByMap",value:function convertToArrayByMap(e,t){for(var n=[null],r=0,o=e.length;r<o;r++)n[r+1]=t[e[r]];return n}},{key:"getPostUrl",value:function getPostUrl(e,t,n,r,o,i,s){var a=c.create();a instanceof self.XMLHttpRequest?(a.open(t,e,!0),void 0!==s&&(a.timeout=s),a.withCredentials=!1!==i,"POST"===t&&a.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.onreadystatechange=function(){4===a.readyState&&204!==a.status&&(200===a.status?r&&r(a.responseText):o&&o(a.responseText))},a.ontimeout=function(){o&&o("timeout",n)},a.send(n)):(a.onload=function(){r&&r(a.responseText)},a.onerror=function(){o&&o()},a.onprogress=function(){},a.ontimeout=function(){},a.open(t,e,!0),setTimeout(function(){a.send(n)},0))}},{key:"minutesToMilliseconds",value:function minutesToMilliseconds(e){return 60*e*1e3}},{key:"cutDecimalPointDigits",value:function cutDecimalPointDigits(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}}]),CDUtils}();function CDMap_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}_defineProperty(f,"scriptVersion","2.28.0.1370.1bbbfa1"),_defineProperty(f,"isPassiveSupported",function isPassiveSupported(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function get(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}()),_defineProperty(f,"dateNow",Date.now),_defineProperty(f,"setZeroTimeout",(s=[],u="Window_"+f.generateUUID(),f.addEventListener(window,"message",function receiveMessage(e){e.data===u&&(e.stopPropagation&&e.stopPropagation(),e.returnValue&&(e.returnValue=!1),e.cancelBubble&&(e.cancelBubble=!0),s.shift()())},!0),function(e){s.push(e),window.postMessage(u,self.location.href)})),_defineProperty(f,"asyncCall",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this;f.setZeroTimeout(function(){o.apply(e||window,n)})}),_defineProperty(f,"StorageUtils",{counter:0,getAndUpdateEventSequenceNumber:function getAndUpdateEventSequenceNumber(){return this.counter++},deserialize:function deserialize(t){if("string"!=typeof t)return null;try{return JSON.parse(t)}catch(e){return t||null}},getFromLocalStorage:function getFromLocalStorage(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;try{var n=this.deserialize(window.localStorage.getItem(e));return n?n.exp&&f.dateNow()-n.time>n.exp?(this.removeFromLocalStorage(e),null):void 0===t||t?n.val:n:null}catch(e){return null}},saveToLocalStorage:function saveToLocalStorage(e,t,n){var r={val:t};n&&(r.exp=n,r.time=f.dateNow());try{window.localStorage.setItem(e,JSON.stringify(r))}catch(e){return null}return r},removeFromLocalStorage:function removeFromLocalStorage(e){try{window.localStorage.removeItem(e)}catch(e){return null}},setExpirationInLocalStorage:function setExpirationInLocalStorage(e,t){var n=this.getFromLocalStorage(e);return""===n||null===n?r:this.saveToLocalStorage(e,n,t)?o:i},getFromSessionStorage:function getFromSessionStorage(e){try{var t=this.deserialize(window.sessionStorage.getItem(e));return t?t:null}catch(e){return null}},saveToSessionStorage:function saveToSessionStorage(e,t){try{return t?(window.sessionStorage.setItem(e,JSON.stringify(t)),t):window.sessionStorage.removeItem(e)}catch(e){return null}},removeFromSessionStorage:function removeFromSessionStorage(e){try{window.sessionStorage.removeItem(e)}catch(e){return null}},getCookie:function getCookie(e){e=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie);return e?decodeURIComponent(e[1]):""},setCookie:function setCookie(e,t,n,r){var o,i="";n&&((o=new Date).setTime(o.getTime()+n),i="; expires="+o.toUTCString());for(var s=0,a=location.hostname,c=a.split("."),u="",l=!1;s<=c.length-1&&!l;)"localhost"===(a=c.slice(-1-++s).join("."))?u="":""!==a&&(u="; domain=."+a),l=this.setCookieWithAttributes(e,t,i,u,r);return l||(u="",l=this.setCookieWithAttributes(e,t,i,u,r)),l},setCookieWithAttributes:function setCookieWithAttributes(e,t,n,r,o){r=encodeURIComponent(e)+"="+encodeURIComponent(t)+n+r+"; path=/;";return document.cookie=o?r+" ".concat("SameSite=None;"," ").concat("Secure"):r,this.getCookie(e)===t},setExpirationInCookie:function setExpirationInCookie(e,t){var n=this.getCookie(e);return""===n||null===n?r:this.setCookie(e,n,t)?o:i},removeCookie:function removeCookie(e){try{document.cookie=e+"=; Max-Age=0"}catch(e){return null}},validateBcId:function validateBcId(e){return/^([0-9]{13,}-)?[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?e:null}}),_defineProperty(f,"getNativeWindowFn",l),_defineProperty(f,"JQueryUtils",{isJQueryAvailable:function isJQueryAvailable(){return void 0!==window.jQuery},addEventListener:function addEventListener(e,t,n){jQuery(e).on(t,n)},removeEventListener:function removeEventListener(e,t,n){jQuery(e).off(t,n)}}),function dateNowFixer(){Date.now?l("Date.now",Date.now,function(e){f.dateNow=e}):f.dateNow=function now(){return(new Date).getTime()}}();var p=function(){function CDMap(){!function CDMap_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CDMap),this._pairs=[],this.size=0}return function CDMap_createClass(e,t,n){t&&CDMap_defineProperties(e.prototype,t),n&&CDMap_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CDMap,[{key:"has",value:function has(e){return-1<this._indexOf(e)}},{key:"get",value:function get(e){e=this._indexOf(e);if(-1<e)return this._pairs[e][1]}},{key:"set",value:function set(e,t){var n=this._indexOf(e);-1<n?this._pairs[n][1]=t:(this._pairs.push([e,t]),this.size++)}},{key:"delete",value:function _delete(e){e=this._indexOf(e);return-1<e&&(this._pairs.splice(e,1),this.size--,!0)}},{key:"forEach",value:function forEach(e){for(var t=0;t<this._pairs.length;t++)e(this._pairs[t][1],this._pairs[t][0])}},{key:"clear",value:function clear(){this._pairs=[]}},{key:"_indexOf",value:function _indexOf(e){for(var t=0;t<this._pairs.length;t++)if(this._pairs[t][0]===e)return t;return-1}}]),CDMap}(),d=function create(){return new(self.Map||p)};function CDSet_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function CDSet(){!function CDSet_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CDSet),this._set=[],this.size=0}return function CDSet_createClass(e,t,n){t&&CDSet_defineProperties(e.prototype,t),n&&CDSet_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CDSet,[{key:"add",value:function add(e){return this._set.push(e),this.size++,this}},{key:"has",value:function has(e){return-1<this._set.indexOf(e)}},{key:"delete",value:function _delete(e){for(var t=0;t<this._set.length;t++)if(this._set[t]===e)return this._set.splice(t,1),this.size--,!0;return!1}},{key:"forEach",value:function forEach(e){for(var t=0;t<this._set.length;t++)e(this._set[t])}},{key:"clear",value:function clear(){this._set=[]}}]),CDSet}(),h=function create(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=new(self.Set||y),n=0;n<e.length;n++)t.add(e[n]);return t};function MessageBus_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function MessageBus(){!function MessageBus_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MessageBus),this.subscribers=d()}return function MessageBus_createClass(e,t,n){t&&MessageBus_defineProperties(e.prototype,t),n&&MessageBus_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MessageBus,[{key:"subscribe",value:function subscribe(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=!1;this.subscribers.has(e)?(n=this.subscribers.get(e))&&n.forEach(function(e){t===e.handler&&(o=!0)}):(n=h(),this.subscribers.set(e,n)),o||n.add({handler:t,isOneTime:r})}},{key:"unsubscribe",value:function unsubscribe(e,t){var n;e&&this.subscribers.has(e)&&((n=this.subscribers.get(e))&&n.forEach(function(e){t===e.handler&&n.delete(e)}),0===n.size&&this.subscribers.delete(e))}},{key:"publish",value:function publish(e,t){if(!e)throw new Error("invalid argument messageType must be defined");this._notifySubscribers(e,t)}},{key:"_notifySubscribers",value:function _notifySubscribers(e,t){var n=this.subscribers.get(e);n&&n.forEach(function(e){e.handler(t),e.isOneTime&&n.delete(e)})}}]),MessageBus}(),_={TouchEvent:"touchEvent",KeyEvent:"keyEvent",ConfigurationLoadedEvent:"ConfigurationLoadedEvent",NewSessionStartedEvent:"NewSessionStartedEvent",WupDispatchRateUpdatedEvent:"WupDispatchRateUpdatedEvent",ApiContextChangeEvent:"ApiContextChangeEvent",ApiResetSessionEvent:"ApiResetSessionEvent",ApiCustomerMetadataEvent:"ApiCustomerMetadataEvent",ApiChangeStateEvent:"ApiChangeStateEvent",ApiSetCsidEvent:"ApiSetCsidEvent",ApiSetPsidEvent:"ApiSetPsidEvent",ApiSetCustomerBrand:"ApiSetCustomerBrand",ServerStateUpdatedEvent:"ServerStateUpdatedEvent",ServerRestoredMuidEvent:"ServerRestoredMuidEvent",StateChangedEvent:"StateChangedEvent",MutationSingleEvent:"MutationSingleEvent",MutationAddedNodes:"MutationAddedNodes",MutationRemovedNodes:"MutationRemovedNodes",StandardInputEvent:"StandardInputEvent",StandardInputFocusEvent:"StandardInputFocusEvent",StandardInputBlurEvent:"StandardInputBlurEvent",StandardOnClickEvent:"StandardOnClickEvent",StandardOnSelectEvent:"StandardOnSelectEvent",ElementFocusEvent:"ElementFocusEvent",ElementBlurEvent:"ElementBlurEvent",StandardOnFormSubmitEvent:"StandardOnFormSubmitEvent",SyntheticInputMaskEvent:"SyntheticInputMaskEvent",CutEvent:"CutEvent",CopyEvent:"CopyEvent",PasteEvent:"PasteEvent",DeviceOrientationEvent:"DeviceOrientationEvent",BeforeInstallPromptEvent:"BeforeInstallPromptEvent",FocusEvent:"FocusEvent",BlurEvent:"BlurEvent",ResizeEvent:"ResizeEvent",DOMContentLoadedEvent:"DOMContentLoadedEvent",VisibilityChangeEvent:"VisibilityChangeEvent",ScrollEvent:"ScrollEvent",WindowMessageEvent:"WindowMessageEvent",WorkerSystemStatusEvent:"WorkerSystemStatusEvent",CustomElementDetectedEvent:"CustomElementDetectedEvent",CustomElementAddedEvent:"CustomElementAddedEvent",CustomElementRemovedEvent:"CustomElementRemovedEvent",CustomElementInaccessible:"CustomElementInaccessible",CustomElementSubmitted:"CustomElementSubmitted",BrowserContextAdded:"BrowserContextAdded",RunDefaultFeatures:"RunDefaultFeatures",StopDefaultFeatures:"StopDefaultFeatures"},m="registerSlave",g="updateSlaveConf",b="updateSlaveState",C="updateMasterContext",E="resetSessionTriggerFromSlave",P="mouseChallengeTriggerFromSlave",w="onbeforeunload",O="SlaveHandShake",S="CDHandShake",k="slaveAlive",B="channelMessageIdAck",F="isChannelSupportsAckMessageLogic",D={DEBUG:10,INFO:20,WARN:30,ERROR:40,CRITICAL:50,OFF:80},T={resetSessionApiThreshold:"resetSessionApiThreshold",dataWupDispatchRateSettings:"dataWupDispatchRateSettings",logWupDispatchRateSettings:"logWupDispatchRateSettings",forceDynamicDataWupDispatchSettings:"forceDynamicDataWupDispatchSettings",wupStatisticsLogIntervalMs:"wupStatisticsLogIntervalMs",serverCommunicationSettings:"serverCommunicationSettings",wupResponseTimeout:"wupResponseTimeout",wupMessageRequestTimeout:"wupMessageRequestTimeout",logMessageRequestTimeout:"logMessageRequestTimeout",collectKeyRegionValue:"collectKeyRegionValue",crossDomainsList:"crossDomainsList",crossDomainsTimeout:"crossDomainsTimeout",isMutationObserver:"isMutationObserver",isEnabled:"isEnabled",slaveChannelHandshakeTimeout:"slaveChannelHandshakeTimeout",slaveAliveMessageInterval:"slaveAliveMessageInterval",collectCustomElementAttribute:"collectCustomElementAttribute",customElementAttribute:"customElementAttribute",enableFramesProcessing:"enableFramesProcessing",enableSameSiteNoneAndSecureCookies:"enableSameSiteNoneAndSecureCookies",wupServerURL:"wupServerURL",logAddress:"logAddress",shouldMaskClickEventValueField:"shouldMaskClickEventValueField",isCaptureKeyEvents:"isCaptureKeyEvents",locationEventsTimeoutMsec:"locationEventsTimeoutMsec",heartBeatMessageInterval:"heartBeatMessageInterval",isMotionAroundTouchEnabled:"isMotionAroundTouchEnabled",motionPaddingAroundTouchMSec:"motionPaddingAroundTouchMSec",isMotionOnSessionStart:"isMotionOnSessionStart",motionPaddingOnSessionStartMSec:"motionPaddingOnSessionStartMSec",isVMDetection:"isVMDetection",isScrollCollect:"isScrollCollect",isContextPropsFeature:"isContextPropsFeature",isCrossDomain:"isCrossdomain",gyroEventsThreshold:"gyroEventsThreshold",gyroEventsSamplePeriod:"gyroEventsSamplePeriod",dataQPassWorkerInterval:"dataQPassWorkerInterval",accelerometerEventsSamplePeriod:"accelerometerEventsSamplePeriod",orientationEventsThreshold:"orientationEventsThreshold",orientationEventsSamplePeriod:"orientationEventsSamplePeriod",isAudioDetection:"isAudioDetection",stateChangeEnabled:"stateChangeEnabled",logLevel:"logLevel",enableCustomElementsProcessing:"enableCustomElementsProcessing",keyEventsMaskSpecialChars:"keyEventsMaskSpecialChars",collectSelectElementBlurAndFocusEvents:"collectSelectElementBlurAndFocusEvents",allowedUnmaskedValuesList:"allowedUnmaskedValuesList",enableUnmaskedValues:"enableUnmaskedValues",wupMessageNumToRetry:"wupMessageNumToRetry",wupMessageRetryInterval:"wupMessageRetryInterval",wupIncrementalGrowthBetweenFailures:"wupIncrementalGrowthBetweenFailures",wupMaxIntervalBetweenFailures:"wupMaxIntervalBetweenFailures",logMessageNumToRetry:"logMessageNumToRetry",logMessageRetryInterval:"logMessageRetryInterval",logIncrementalGrowthBetweenFailures:"logIncrementalGrowthBetweenFailures",logMaxIntervalBetweenFailures:"logMaxIntervalBetweenFailures",cdsNumExpirationTime:"cdsNumExpirationTime",enableCoordinatesMasking:"enableCoordinatesMasking",maskElementsAttributes:"maskElementsAttributes",enableAcknowledgeMessageEvents:"enableAcknowledgeMessageEvents",timeTillClearingElementsBufferQueueTimeout:"timeTillClearingElementsBufferQueueTimeout",acknowledgeDataDispatchingRate:"acknowledgeDataDispatchingRate",isChannelSupportsAckMessageLogic:"isChannelSupportsAckMessageLogic"};function Logger_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Logger_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Logger_createClass(e,t,n){return t&&Logger_defineProperties(e.prototype,t),n&&Logger_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var M=function(){function Log(){Logger_classCallCheck(this,Log)}return Logger_createClass(Log,null,[{key:"setLogger",value:function setLogger(e){this._logger=e}},{key:"isDebug",value:function isDebug(){if(this._logger)return this._logger.isDebug()}},{key:"error",value:function error(e,t){this._logger&&this._logger.error(e,t||null)}},{key:"warn",value:function warn(e,t){this._logger&&this._logger.warn(e,t||null)}},{key:"trace",value:function trace(e){this._logger&&this._logger.trace(e)}},{key:"debug",value:function debug(e){this._logger&&this._logger.debug(e)}},{key:"info",value:function info(e){this._logger&&this._logger.info(e)}}]),Log}(),R=function(){function Logger(e,t){Logger_classCallCheck(this,Logger),this._logBridge=e,this._logLevel=t||D.INFO}return Logger_createClass(Logger,[{key:"trace",value:function trace(e){this._sendToLogBridge(e,D.DEBUG)}},{key:"debug",value:function debug(e){this._sendToLogBridge(e,D.DEBUG)}},{key:"info",value:function info(e){this._sendToLogBridge(e,D.INFO)}},{key:"warn",value:function warn(e,t){this._sendToLogBridge(e,D.WARN,t)}},{key:"error",value:function error(e,t){this._sendToLogBridge(e,D.ERROR,t)}},{key:"isDebug",value:function isDebug(){return this._logLevel===D.DEBUG}},{key:"updateLogConfig",value:function updateLogConfig(e){this._logLevel=e.get(T.logLevel)||this._logLevel,this._logBridge.setLogLevel(this._logLevel),this._logBridge.clearLogEntriesByLogLevel(this._logLevel)}},{key:"_sendToLogBridge",value:function _sendToLogBridge(e,t,n){t>=this._logLevel&&(n&&n.stack&&(e+=" ;stack: ".concat(n.stack)),this._logBridge.log(e,t))}}]),Logger}();function BrowserContext_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function BrowserContext(e){!function BrowserContext_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserContext),this.context=e||window.self}return function BrowserContext_createClass(e,t,n){t&&BrowserContext_defineProperties(e.prototype,t),n&&BrowserContext_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserContext,[{key:"Context",get:function get(){return this.context}},{key:"getDocument",value:function getDocument(){return this.context.document}}]),BrowserContext}();function FeatureService_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function FeatureService(e,t,n,r,o,i){!function FeatureService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FeatureService),this._features=e,this._frameHandler=t,this._configurationRepository=n,this._domUtils=r,this._cdUtils=o,this._browserContextsCache=i,this.buildFrameRelatedLists()}return function FeatureService_createClass(e,t,n){t&&FeatureService_defineProperties(e.prototype,t),n&&FeatureService_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FeatureService,[{key:"buildFrameRelatedLists",value:function buildFrameRelatedLists(){this._frameRelatedDefaultFeatures=this._collectFrameRelated(this._features.getDefaultFeatures()),this._frameRelatedNonDefaultFeatures=this._collectFrameRelated(this._features.getNonDefaultFeatures())}},{key:"runDefault",value:function runDefault(){M.info("Running default features"),this._runFeatures(this._features.getDefaultFeatures(),this._frameRelatedDefaultFeatures)}},{key:"stopDefault",value:function stopDefault(){M.info("Stopping default features"),this._stopFeatures(this._features.getDefaultFeatures(),this._frameRelatedDefaultFeatures)}},{key:"runPerSessionFeatures",value:function runPerSessionFeatures(){M.info("Running per session features"),this._configurationRepository.isConfigurationUpdatedFromServer()?this._startFeatures(this._features.getPerSessionFeatures()):M.info("We didn't receive configurations from the server yet. Skipping per session features start until configuration arrives.")}},{key:"stopPerSessionFeatures",value:function stopPerSessionFeatures(){M.info("Stopping per session features"),this._stopFeatures(this._features.getPerSessionFeatures())}},{key:"runNonDefault",value:function runNonDefault(){M.info("Running non default features"),this._configurationRepository.isConfigurationUpdatedFromServer()?this._runFeatures(this._features.getNonDefaultFeatures(),this._frameRelatedNonDefaultFeatures):M.info("We didn't receive configurations from the server yet. Skipping non default features start until configuration arrives.")}},{key:"stopNonDefault",value:function stopNonDefault(){M.info("Stopping non default features"),this._stopFeatures(this._features.getNonDefaultFeatures(),this._frameRelatedNonDefaultFeatures)}},{key:"runPerContextFeatures",value:function runPerContextFeatures(e){M.info("Running per context features"),this._configurationRepository.isConfigurationUpdatedFromServer()?(this._runFeatures(this._features.getPerContextFeatures()),"cd_auto"!==e.name&&this._frameRelatedDefaultFeatures&&this._frameHandler.startFeatures(this._frameRelatedDefaultFeatures)):M.info("We didn't receive configurations from the server yet. Skipping per context features start until configuration arrives.")}},{key:"stopPerContextFeatures",value:function stopPerContextFeatures(){M.info("Stopping per context features"),this._stopFeatures(this._features.getPerContextFeatures())}},{key:"stopAllFeatures",value:function stopAllFeatures(){M.info("Stopping all features"),this.stopDefault(),this.stopNonDefault(),this.stopPerSessionFeatures(),this.stopPerContextFeatures()}},{key:"updateRunByConfig",value:function updateRunByConfig(e){M.info("Updating features configuration"),this._updateFeatures(this._features.getDefaultFeatures(),e),this._updateFeatures(this._features.getNonDefaultFeatures(),e),this._updateFeatures(this._features.getPerContextFeatures(),e)}},{key:"runFeaturesOnBrowserContext",value:function runFeaturesOnBrowserContext(t){var n=this,r=this._features.getDefaultFeatures();r&&(this._browserContextsCache.unRegisterContextFeatures(t.Context,r),Object.keys(r).forEach(function(e){e=r[e];e.shouldRun&&e.isFrameRelated&&(e.isRunning=!0,e.instance&&n._cdUtils.asyncCall.call(e.instance.startFeature,e.instance,t))}))}},{key:"stopFeaturesOnBrowserContextRemove",value:function stopFeaturesOnBrowserContextRemove(t){var n=this,r=this._features.getDefaultFeatures();r&&(this._browserContextsCache.unRegisterContextFeatures(t.Context,r),Object.keys(r).forEach(function(e){e=r[e];e.shouldRun&&e.isFrameRelated&&e.isRunning&&e.instance&&n._cdUtils.asyncCall.call(e.instance.stopFeature,e.instance,t)}))}},{key:"_runFeatures",value:function _runFeatures(t,e){var n=this;t&&Object.keys(t).forEach(function(e){e=t[e];e.shouldRun&&(n._cdUtils.asyncCall.call(e.instance.startFeature,e.instance,new j(window.self)),e.isRunning=!0)}),e&&(this._frameHandler.startFeatures(e),this._domUtils.onPageLoad(window,function(){n._frameHandler.startFeatures(e)}))}},{key:"_stopFeatures",value:function _stopFeatures(t,e){var n=this;t&&Object.keys(t).forEach(function(e){e=t[e];e.instance.stopFeature&&n._cdUtils.asyncCall.call(e.instance.stopFeature,e.instance,new j(window.self)),e.isRunning=!1}),e&&this._frameHandler.stopFeatures(e)}},{key:"_actOnFeature",value:function _actOnFeature(e,t){e.isFrameRelated&&this._frameHandler[t](e),e.instance[t]&&this._cdUtils.asyncCall.call(e.instance[t],e.instance,new j(window.self))}},{key:"_startFeatures",value:function _startFeatures(n){var r=this;n&&Object.keys(n).forEach(function(e){var t=n[e],e=r._configurationRepository.get(t.configKey);"boolean"==typeof e&&(t.shouldRun=e),t.shouldRun&&(r._actOnFeature(t,"startFeature"),t.isRunning=!0)})}},{key:"_startFeatureOnBrowserContexts",value:function _startFeatureOnBrowserContexts(t){var n=this;t.isFrameRelated&&this._browserContextsCache.browserContexts.forEach(function(e){t.shouldRun&&!n._browserContextsCache.hasFeature(e.Context,t)&&(n._browserContextsCache.registerContextFeature(e.Context,t),n._cdUtils.asyncCall.call(t.instance.startFeature,t.instance,e),t.isRunning=!0)})}},{key:"_stopFeatureOnBrowserContexts",value:function _stopFeatureOnBrowserContexts(t){var n=this;t.isFrameRelated&&this._browserContextsCache.browserContexts.forEach(function(e){n._browserContextsCache.hasFeature(e.Context,t)&&n._cdUtils.asyncCall.call(t.instance.stopFeature,t.instance,e),t.isRunning=!1,n._browserContextsCache.exists(e.Context)&&n._browserContextsCache.unRegisterContextFeature(e.Context,t),n._browserContextsCache.remove(e.Context)})}},{key:"_updateFeatureConfigOnBrowserContexts",value:function _updateFeatureConfigOnBrowserContexts(t){var n=this;t.isFrameRelated&&this._browserContextsCache.browserContexts.forEach(function(e){n._browserContextsCache.hasFeature(e.Context,t)&&n._cdUtils.asyncCall.call(t.instance.updateFeatureConfig,t.instance,e)})}},{key:"_updateFeatures",value:function _updateFeatures(n,r){var o=this;n&&Object.keys(n).forEach(function(e){var t=n[e],e=r.get(t.configKey);"boolean"==typeof e&&(t.shouldRun=e),t.isRunning&&!t.shouldRun?(o._actOnFeature(t,"stopFeature"),o._stopFeatureOnBrowserContexts(t),t.isRunning=!1):!t.isRunning&&t.shouldRun&&(o._actOnFeature(t,"startFeature"),o._startFeatureOnBrowserContexts(t),t.isRunning=!0),t.isRunning&&(o._actOnFeature(t,"updateFeatureConfig"),o._updateFeatureConfigOnBrowserContexts(t))})}},{key:"_collectFrameRelated",value:function _collectFrameRelated(t){var n=[];return t&&Object.keys(t).forEach(function(e){e=t[e];e.isFrameRelated&&n.push(e)}),n}}]),FeatureService}();function FeaturesBuilder_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function FeaturesBuilder(e,t,n,r,o,i,s,a,c,u,l,f,p,d){!function FeaturesBuilder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FeaturesBuilder),this._features=e,this._configurationRepository=t,this._utils=n,this._elements=r,this._mutationObserver=o,this._dataQ=i,this._sessionService=s,this._muidService=a,this._perfMonitor=c,this._sensorDataQ=u,this._msgBus=l,this._cidCache=f,this._sameCharService=p,this._maskingService=d}return function FeaturesBuilder_createClass(e,t,n){t&&FeaturesBuilder_defineProperties(e.prototype,t),n&&FeaturesBuilder_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FeaturesBuilder,[{key:"buildFeatures",value:function buildFeatures(){var n=this;!function buildFeaturesInList(t){t&&Object.keys(t).forEach(function(e){t[e].init.apply(n)})}(this._features.list)}}]),FeaturesBuilder}();function CDEvent_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function CDEvent(){!function CDEvent_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CDEvent),this._listeners=[]}return function CDEvent_createClass(e,t,n){t&&CDEvent_defineProperties(e.prototype,t),n&&CDEvent_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CDEvent,[{key:"subscribe",value:function subscribe(e){this._listeners.push(e)}},{key:"publish",value:function publish(e){for(var t=0,n=this._listeners.length;t<n;t++)this._listeners[t](e)}},{key:"unsubscribe",value:function unsubscribe(e){for(var t=0,n=this._listeners.length;t<n;t++)if(e===this._listeners[t]){this._listeners.splice(t,1);break}}}]),CDEvent}(),A={rtcframe:"cd__rtcframe",fontDetectionFrame:"cd__fontDetectionFrame",ignorePrefixFrame:"cd__frame__"};function FramesDetector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function FramesDetector(e,t){!function FramesDetector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FramesDetector),this._elementsMutationObserverFactory=e,this._domUtils=t,this._windowMutationObservers=d(),this._loadedFrames=d(),this._framesToIgnore=h(),this._frameSelector="frame, iframe",this._frameLoadedCallback=this._onFrameLoad.bind(this),this.frameAdded=new L,this.frameRemoved=new L,this.frameInaccessible=new L}return function FramesDetector_createClass(e,t,n){t&&FramesDetector_defineProperties(e.prototype,t),n&&FramesDetector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FramesDetector,[{key:"frames",get:function get(){var n=[];return this._loadedFrames.forEach(function(e,t){n.push(t)}),n}},{key:"start",value:function start(e){var t=this;this._monitorWindow(e),this._findFrames(e.document).forEach(function(e){t._processNewFrame(e)})}},{key:"stop",value:function stop(){this._windowMutationObservers.forEach(function(e){e.disconnect()}),this._windowMutationObservers.clear(),this._loadedFrames.clear(),this._framesToIgnore.clear()}},{key:"addToIgnoreList",value:function addToIgnoreList(e){this._framesToIgnore.add(e)}},{key:"_monitorWindow",value:function _monitorWindow(e){var t;this._windowMutationObservers.has(e)||((t=new this._elementsMutationObserverFactory.create(e,self.MutationObserver)).observe(e.document),t.nodeAdded.subscribe(this._processAddedNode.bind(this)),t.nodeRemoved.subscribe(this._processRemovedNode.bind(this)),this._windowMutationObservers.set(e,t))}},{key:"_unMonitorWindow",value:function _unMonitorWindow(e){var t=this._windowMutationObservers.get(e);t&&t.disconnect(),this._windowMutationObservers.delete(e)}},{key:"_processAddedNode",value:function _processAddedNode(e){var t=this;this._domUtils.matches(e,this._frameSelector)?this._processNewFrame(e):e.hasChildNodes()&&this._findFrames(e).forEach(function(e){t._processNewFrame(e)})}},{key:"_processNewFrame",value:function _processNewFrame(e){this._framesToIgnore.has(e.id)||e.id.startsWith(A.ignorePrefixFrame)||this._loadedFrames.has(e)||(this._domUtils.addEventListener(e,"load",this._frameLoadedCallback),this._domUtils.canAccessIFrame(e)?this._domUtils.isWindowDocumentReady(e.contentWindow)&&this._addFrame(e):this.frameInaccessible.publish(e))}},{key:"_addFrame",value:function _addFrame(e){var t=this;this._monitorWindow(e.contentWindow),this._findFrames(e.contentWindow.document).forEach(function(e){t._processNewFrame(e)}),this._loadedFrames.set(e,e.contentDocument),this.frameAdded.publish(e)}},{key:"_processRemovedNode",value:function _processRemovedNode(e){var t=this;this._domUtils.matches(e,this._frameSelector)?this._removeFrame(e):e.hasChildNodes()&&this._findFrames(e).forEach(function(e){t._removeFrame(e)})}},{key:"_removeFrame",value:function _removeFrame(e){this._unMonitorWindow(e.contentWindow),this._domUtils.removeEventListener(e,"load",this._frameLoadedCallback),this._loadedFrames.delete(e)&&this.frameRemoved.publish(e)}},{key:"_onFrameLoad",value:function _onFrameLoad(e){e=e.target;this._loadedFrames.has(e)&&this._removeFrame(e),this._processNewFrame(e)}},{key:"_findFrames",value:function _findFrames(e){for(var t=[],n=[],r=e.querySelectorAll(this._frameSelector),o=0;o<r.length;o++)n.push(r[o]);for(var i=0;i<n.length;i++){var s,a=n[i];t.push(a),this._domUtils.canAccessIFrame(a)?0<(s=this._findFrames(a.contentWindow.document)).length&&(t=t.concat(s)):this.frameInaccessible.publish(a)}return t}}]),FramesDetector}();function FramesHandlerBase_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function FramesHandlerBase(){!function FramesHandlerBase_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FramesHandlerBase)}return function FramesHandlerBase_createClass(e,t,n){t&&FramesHandlerBase_defineProperties(e.prototype,t),n&&FramesHandlerBase_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FramesHandlerBase,[{key:"startFeatures",value:function startFeatures(){}},{key:"startFeature",value:function startFeature(){}},{key:"stopFeatures",value:function stopFeatures(){}},{key:"stopFeature",value:function stopFeature(){}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){}}]),FramesHandlerBase}();function FrameContext_typeof(e){return(FrameContext_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FrameContext_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=_getPrototypeOf(n);return function _possibleConstructorReturn(e,t){{if(t&&("object"===FrameContext_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function _assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=function(){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(FrameContext,j);var e=_createSuper(FrameContext);function FrameContext(){return function FrameContext_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FrameContext),e.apply(this,arguments)}return function FrameContext_createClass(e,t,n){t&&FrameContext_defineProperties(e.prototype,t),n&&FrameContext_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FrameContext,[{key:"getDocument",value:function getDocument(){return this.context.document||this.context.contentDocument}}]),FrameContext}();function FramesHandler_typeof(e){return(FramesHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FramesHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FramesHandler_setPrototypeOf(e,t){return(FramesHandler_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FramesHandler_createSuper(n){var r=function FramesHandler_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FramesHandler_getPrototypeOf(n);return function FramesHandler_possibleConstructorReturn(e,t){{if(t&&("object"===FramesHandler_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return FramesHandler_assertThisInitialized(e)}(this,r?(e=FramesHandler_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FramesHandler_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FramesHandler_getPrototypeOf(e){return(FramesHandler_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(){!function FramesHandler_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FramesHandler_setPrototypeOf(e,t)}(FramesHandler,U);var i=FramesHandler_createSuper(FramesHandler);function FramesHandler(e,t,n,r){var o;return function FramesHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FramesHandler),(o=i.call(this))._framesCache=e,o._framesDetector=t,o._framesDetector.frameAdded.subscribe(o._onFrameAdded.bind(FramesHandler_assertThisInitialized(o))),o._framesDetector.frameRemoved.subscribe(o._onFrameRemoved.bind(FramesHandler_assertThisInitialized(o))),o._framesDetector.frameInaccessible.subscribe(o._onFrameInaccessible.bind(FramesHandler_assertThisInitialized(o))),o._featuresList=[],o._domUtils=n,o._utils=r,o._framesDetector.addToIgnoreList(A.rtcframe),o._framesDetector.addToIgnoreList(A.fontDetectionFrame),o._framesDetector.start(window.self),o._buildFramesCache(),o}return function FramesHandler_createClass(e,t,n){t&&FramesHandler_defineProperties(e.prototype,t),n&&FramesHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FramesHandler,[{key:"startFeatures",value:function startFeatures(e){try{if(this._buildFeaturesMap(e),0===this._featuresList.length)return;M.debug("startFeatures:Running features on ".concat(this._framesCache.count," frames")),this._startFeaturesOnFrames(this._framesCache.contexts,e)}catch(e){M.debug("Failed to start features in FrameHandler.startFeatures: ".concat(e.message),e)}}},{key:"startFeature",value:function startFeature(e){try{this._featuresList.push(e),e.isRunning=!0,this._startFeaturesOnFrames(this._framesCache.contexts,[e])}catch(e){M.debug("Failed to start feature in FrameHandler.startFeature: ".concat(e.message),e)}}},{key:"stopFeatures",value:function stopFeatures(e){try{this._stopFeaturesOnFrames(e,this._framesCache.contexts)}catch(e){M.debug("Failed to stop features in FrameHandler.stopFeatures: ".concat(e.message),e)}}},{key:"stopFeature",value:function stopFeature(e){try{e.isRunning=!1,this._stopFeaturesOnFrames([e],this._framesCache.contexts)}catch(e){M.debug("Failed to stop feature in FrameHandler.stopFeature: ".concat(e.message),e)}}},{key:"updateFeatureConfig",value:function updateFeatureConfig(e){e.instance.updateFeatureConfig&&this._updateFeaturesConfigOnFrames([e],this._framesCache.contexts)}},{key:"_onFrameAdded",value:function _onFrameAdded(t){try{M.debug("Frame:".concat(t.name,", id:").concat(t.id,". was loaded.")),this._framesCache.exists(t)?this._framesCache.unRegisterContextFeatures(t,this._featuresList):this._framesCache.add(t),this._startFeaturesOnFrames([t],this._featuresList)}catch(e){M.warn("Failed to start features on frame ".concat(t.id,": ").concat(e.message),e)}}},{key:"_onFrameRemoved",value:function _onFrameRemoved(t){try{M.debug("Frame:".concat(t.name,", id:").concat(t.id,". was removed.")),this._stopFeaturesOnFrames(this._featuresList,[t])}catch(e){M.warn("Failed to stop features on frame ".concat(t.id,": ").concat(e.message),e)}}},{key:"_onFrameInaccessible",value:function _onFrameInaccessible(e){M.debug("Frame:".concat(e.name,", id:").concat(e.id,". was detected as inaccessible."))}},{key:"_buildFeaturesMap",value:function _buildFeaturesMap(e){var t=this;this._featuresList=[],e.forEach(function(e){t._featuresList.push(e)})}},{key:"_buildFramesCache",value:function _buildFramesCache(){var t=this;this._framesDetector.frames.forEach(function(e){t._framesCache.exists(e)||t._framesCache.add(e)})}},{key:"_startFeaturesOnFrames",value:function _startFeaturesOnFrames(e,r){var o=this;e.forEach(function(t){try{if(!o._domUtils.canAccessIFrame(t))return;for(var e=0;e<r.length;e++){var n=r[e];n.shouldRun&&!o._framesCache.hasFeature(t,n)&&(o._framesCache.registerContextFeature(t,n),o._domUtils.isWindowDocumentReady(t.contentWindow)&&(M.debug("_startFeaturesOnFrames: run feature on frame:".concat(t.name,", id:").concat(t.id,". feature:").concat(n.configKey)),o._utils.asyncCall.call(o._runFeatureOnFrame,o,t,n),n.isRunning=!0))}}catch(e){M.error("An error has occurred while starting features on frame ".concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}})}},{key:"_runFeatureOnFrame",value:function _runFeatureOnFrame(t,n){try{this._domUtils.canAccessIFrame(t)?n.instance.startFeature(new Q(t.contentWindow)):M.debug("Not starting features on frame ".concat(t.name," with id: ").concat(t.id," as it is not accessible"))}catch(e){M.error("An error has occurred while starting feature ".concat(n.configKey," on frame ").concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}}},{key:"_stopFeaturesOnFrames",value:function _stopFeaturesOnFrames(r,e){var o=this;try{e.forEach(function(t){try{if(!o._domUtils.canAccessIFrame(t))return;if(t.contentWindow&&t.contentWindow.document)for(var e=0,n=r.length;e<n;e++)o._framesCache.hasFeature(t,r[e])&&o._utils.asyncCall.call(o._stopFeatureOnFrame,o,t,r[e]),r[e].isRunning=!1}catch(e){M.error("An error has occurred while stopping features on frame ".concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}o._framesCache.exists(t)&&o._framesCache.unRegisterContextFeatures(t,r),o._framesCache.remove(t)})}catch(e){M.warn("Failed stopping features on frames ".concat(e.message),e)}}},{key:"_stopFeatureOnFrame",value:function _stopFeatureOnFrame(t,n){try{this._domUtils.canAccessIFrame(t)?n.instance.stopFeature(new Q(t.contentWindow)):M.debug("Not stopping feature ".concat(n.configKey," on frame ").concat(t.name," with id: ").concat(t.id," as it is not accessible"))}catch(e){M.error("An error has occurred while stopping feature ".concat(n.configKey," ").concat(func," on frame ").concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}}},{key:"_updateFeaturesConfigOnFrames",value:function _updateFeaturesConfigOnFrames(r,e){var o=this;e.forEach(function(t){try{if(!o._domUtils.canAccessIFrame(t))return;for(var e=0,n=r.length;e<n;e++)o._framesCache.hasFeature(t,r[e])&&o._utils.asyncCall.call(o._updateFeatureConfigOnFrame,o,t,r[e])}catch(e){M.error("An error has occurred while updating features configuration on frame ".concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}})}},{key:"_updateFeatureConfigOnFrame",value:function _updateFeatureConfigOnFrame(t,n){try{this._domUtils.canAccessIFrame(t)?n.instance.updateFeatureConfig(new Q(t.contentWindow)):M.debug("Not updating feature ".concat(n.configKey," config on frame ").concat(t.name," with id: ").concat(t.id," as it is not accessible"))}catch(e){M.error("An error has occurred while updating feature ".concat(n.configKey," config on frame ").concat(t.name," with id: ").concat(t.id,". Error: ").concat(e.message),e)}}}]),FramesHandler}();function NullFramesHandler_typeof(e){return(NullFramesHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NullFramesHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NullFramesHandler_setPrototypeOf(e,t){return(NullFramesHandler_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function NullFramesHandler_createSuper(n){var r=function NullFramesHandler_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=NullFramesHandler_getPrototypeOf(n);return function NullFramesHandler_possibleConstructorReturn(e,t){{if(t&&("object"===NullFramesHandler_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function NullFramesHandler_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=NullFramesHandler_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function NullFramesHandler_getPrototypeOf(e){return(NullFramesHandler_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W=function(){!function NullFramesHandler_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NullFramesHandler_setPrototypeOf(e,t)}(NullFramesHandler,U);var e=NullFramesHandler_createSuper(NullFramesHandler);function NullFramesHandler(){return function NullFramesHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NullFramesHandler),e.apply(this,arguments)}return function NullFramesHandler_createClass(e,t,n){return t&&NullFramesHandler_defineProperties(e.prototype,t),n&&NullFramesHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(NullFramesHandler)}();function BrowserContextsCache_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){function BrowserContextsCache(){!function BrowserContextsCache_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserContextsCache),this._contexts=d()}return function BrowserContextsCache_createClass(e,t,n){t&&BrowserContextsCache_defineProperties(e.prototype,t),n&&BrowserContextsCache_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserContextsCache,[{key:"contexts",get:function get(){var n=[];return this._contexts.forEach(function(e,t){n.push(t)}),n}},{key:"browserContexts",get:function get(){var t=[];return this._contexts.forEach(function(e){t.push(e.browserContext)}),t}},{key:"count",get:function get(){return this._contexts.size}},{key:"add",value:function add(e){this._contexts.set(e,{registered:!0,features:d()})}},{key:"addBrowserContext",value:function addBrowserContext(e){this._contexts.set(e.Context,{registered:!0,features:d(),browserContext:e})}},{key:"remove",value:function remove(e){this.exists(e)&&0===this._contexts.get(e).features.size&&this._contexts.delete(e)}},{key:"get",value:function get(e){return this._contexts.get(e)}},{key:"exists",value:function exists(e){return this._contexts.has(e)&&this._contexts.get(e).registered}},{key:"registerContextFeature",value:function registerContextFeature(e,t){this.exists(e)&&this._contexts.get(e).features.set(t.configKey,!0)}},{key:"unRegisterContextFeature",value:function unRegisterContextFeature(e,t){this.exists(e,t)&&this._contexts.get(e).features.delete(t.configKey)}},{key:"unRegisterContextFeatures",value:function unRegisterContextFeatures(e,t){for(var n=0;n<t.length;n++){var r=t[n];this.unRegisterContextFeature(e,r)}}},{key:"hasFeature",value:function hasFeature(e,t){return this.exists(e)&&this._contexts.get(e).features.has(t.configKey)}}]),BrowserContextsCache}();function NodesRemovedMutationEvent_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NodesRemovedMutationEvent_createClass(e,t,n){return t&&NodesRemovedMutationEvent_defineProperties(e.prototype,t),n&&NodesRemovedMutationEvent_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var K=NodesRemovedMutationEvent_createClass(function NodesRemovedMutationEvent(e,t){!function NodesRemovedMutationEvent_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NodesRemovedMutationEvent),this.browserContext=e,this.removedNodes=t});function NodesAddedMutationEvent_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NodesAddedMutationEvent_createClass(e,t,n){return t&&NodesAddedMutationEvent_defineProperties(e.prototype,t),n&&NodesAddedMutationEvent_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var V=NodesAddedMutationEvent_createClass(function NodesAddedMutationEvent(e,t){!function NodesAddedMutationEvent_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NodesAddedMutationEvent),this.browserContext=e,this.addedNodes=t});function ElementsMutationObserver_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function ElementsMutationObserver(e,t){!function ElementsMutationObserver_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementsMutationObserver),function ElementsMutationObserver_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"ignoreNodeTypes",h([Node.COMMENT_NODE,Node.TEXT_NODE,Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE])),this._mutationObserver=new t(this._mutationObserved.bind(this,e)),this.nodesAdded=new L,this.nodesRemoved=new L,this.nodeAdded=new L,this.nodeRemoved=new L}return function ElementsMutationObserver_createClass(e,t,n){t&&ElementsMutationObserver_defineProperties(e.prototype,t),n&&ElementsMutationObserver_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ElementsMutationObserver,[{key:"observe",value:function observe(e){this._mutationObserver.observe(e,{childList:!0,subtree:!0})}},{key:"disconnect",value:function disconnect(){this._mutationObserver.disconnect()}},{key:"_mutationObserved",value:function _mutationObserved(t,e){var n=this;e.forEach(function(e){n._processMutation(t,e)})}},{key:"_processMutation",value:function _processMutation(e,t){var n=this._processNodes(t.addedNodes,this.nodeAdded),t=this._processNodes(t.removedNodes,this.nodeRemoved);this._publishNodesMutationEvents(e,n,t)}},{key:"_publishNodesMutationEvents",value:function _publishNodesMutationEvents(e,t,n){0<t.length&&this.nodesAdded.publish(new V(e,t)),0<n.length&&this.nodesRemoved.publish(new K(e,n))}},{key:"_processNodes",value:function _processNodes(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];this._isValidNodeType(o)&&(n.push(o),t.publish(o))}return n}},{key:"_isValidNodeType",value:function _isValidNodeType(e){return!1===this.ignoreNodeTypes.has(e.nodeType)}}]),ElementsMutationObserver}();function ElementsMutationObserverFactory_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function ElementsMutationObserverFactory(){!function ElementsMutationObserverFactory_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementsMutationObserverFactory)}return function ElementsMutationObserverFactory_createClass(e,t,n){t&&ElementsMutationObserverFactory_defineProperties(e.prototype,t),n&&ElementsMutationObserverFactory_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ElementsMutationObserverFactory,[{key:"create",value:function create(e,t){return new G(e,t)}}]),ElementsMutationObserverFactory}();function FramesHandlerFactory_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function FramesHandlerFactory(e,t,n){!function FramesHandlerFactory_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FramesHandlerFactory),this._configurationRepository=e,this._domUtils=t,this._utils=n}return function FramesHandlerFactory_createClass(e,t,n){t&&FramesHandlerFactory_defineProperties(e.prototype,t),n&&FramesHandlerFactory_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FramesHandlerFactory,[{key:"create",value:function create(){if(this._configurationRepository.get(T.enableFramesProcessing)){var e=new z,t=new N(new q,this._domUtils);return new H(e,t,this._domUtils,this._utils)}return new W}}]),FramesHandlerFactory}();function DOMUtils_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=function(){function DOMUtils(){!function DOMUtils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DOMUtils)}return function DOMUtils_createClass(e,t,n){t&&DOMUtils_defineProperties(e.prototype,t),n&&DOMUtils_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DOMUtils,null,[{key:"addEventListener",value:function addEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=5<arguments.length&&void 0!==arguments[5]&&arguments[5];this.isPassiveSupported?e.addEventListener(t,n,{capture:r,passive:o,once:i}):e.addEventListener?e.addEventListener(t,n,r):e.attachEvent("on"+t,n)}},{key:"removeEventListener",value:function removeEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent("on"+t,n)}},{key:"outerHTML",value:function outerHTML(e){return e.outerHTML||(new XMLSerializer).serializeToString(e)}},{key:"onDocumentBody",value:function onDocumentBody(e,t){e.document.body?t():window.addEventListener?window.addEventListener("DOMContentLoaded",t,!0):window.attachEvent("onload",t)}},{key:"onPageLoad",value:function onPageLoad(e,t){DOMUtils.addEventListener(e,"load",t,!0),(e.contentWindow&&"complete"===e.contentWindow.document.readyState||e.document&&"complete"===e.document.readyState)&&t()}},{key:"waitUntilDocumentIsReady",value:function waitUntilDocumentIsReady(n){var r=this;return new Promise(function(e,t){try{r.onWindowDocumentReady(n,function(){e()})}catch(e){t(e)}})}},{key:"onWindowDocumentReady",value:function onWindowDocumentReady(e,t){var n,r=window.addEventListener?"DOMContentLoaded":"load";"complete"===e.document.readyState||"interactive"===e.document.readyState?t():(n=function onLoadedWindowEvent(){DOMUtils.removeEventListener(e,r,n,!0),t()},DOMUtils.addEventListener(e,r,n,!0))}},{key:"isWindowDocumentReady",value:function isWindowDocumentReady(e){return e&&"complete"===e.document.readyState}},{key:"canAccessIFrame",value:function canAccessIFrame(e){var t=null;try{t=(e.contentDocument||e.contentWindow.document).body.innerHTML}catch(e){}return null!==t}},{key:"matches",value:function matches(e,t){return(e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){var t=this.document||this.ownerDocument;if(!t)return!1;for(var n=t.querySelectorAll(e),r=n.length;0<=--r;)if((n.item?n.item(r):n[r])===this)break;return-1<r}).call(e,t)}},{key:"isWebWorkerFetchSupported",value:function isWebWorkerFetchSupported(){var e="Request"in self,t="fetch"in self;if(!e)return!1;e="keepalive"in Request.prototype;return t&&e}}]),DOMUtils}();function PauseResumeManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function DOMUtils_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Z,"isPassiveSupported",function DOMUtils_isPassiveSupported(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function get(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}());var X={RUNNING:0,PAUSED:1},Y=function(){function PauseResumeManager(e,t,n){!function PauseResumeManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PauseResumeManager),this._featureMgr=e,this._dataQ=n,this._configurationRepository=t,this._pauseResumeEnabled=t.get(T.stateChangeEnabled)||!1,this._sdkState=X.RUNNING}return function PauseResumeManager_createClass(e,t,n){t&&PauseResumeManager_defineProperties(e.prototype,t),n&&PauseResumeManager_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PauseResumeManager,[{key:"onResume",value:function onResume(){this._sdkState===X.PAUSED?(M.info("Resuming JS SDK"),this._featureMgr.updateRunByConfig(this._configurationRepository),this._sdkState=X.RUNNING):M.warn("PauseResumeManager:onResume - resume api called when SDK already running")}},{key:"onPause",value:function onPause(){this._sdkState===X.RUNNING?(M.info("Pausing JS SDK"),this._featureMgr.stopAllFeatures(),this._sdkState=X.PAUSED):M.warn("Pause api called when SDK already paused")}},{key:"onStateChange",value:function onStateChange(e){e.toState&&this._verifyApiAllowed(e.toState)&&("pause"===e.toState?this.onPause():"run"===e.toState?this.onResume():M.warn("stateChange api called with non valid toState: "+e.toState))}},{key:"isCustomerApiEnabled",value:function isCustomerApiEnabled(){return this._sdkState===X.RUNNING}},{key:"_verifyApiAllowed",value:function _verifyApiAllowed(e){return!!this._pauseResumeEnabled||(this._dataQ.addToQueue("forbidden_api_call",[null,e]),!1)}},{key:"onConfigUpdate",value:function onConfigUpdate(){this._pauseResumeEnabled=this._configurationRepository.get(T.stateChangeEnabled)||!1,!1===this._configurationRepository.get("isEnabled")&&this.onPause()}}]),PauseResumeManager}();function ScriptsRepository_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $=function(){function ScriptsRepository(e){!function ScriptsRepository_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ScriptsRepository),this._utils=e,this._scriptList=[]}return function ScriptsRepository_createClass(e,t,n){t&&ScriptsRepository_defineProperties(e.prototype,t),n&&ScriptsRepository_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ScriptsRepository,[{key:"count",value:function count(){return this._scriptList.length}},{key:"exists",value:function exists(e){/\d\d\d/.test(e.src)&&(e.src=this._utils.clearTextFromNumbers(e.src));for(var t=this._utils.getHash(e.text),n=0;n<this._scriptList.length;n++)if(e.src&&e.src===this._scriptList[n].src||t&&t===this._scriptList[n].textHash)return!0;return!1}},{key:"add",value:function add(e){e.textHash=this._utils.getHash(e.text),/\d\d\d/.test(e.src)&&(e.src=this._utils.clearTextFromNumbers(e.src)),this._scriptList.push({src:e.src,textHash:e.textHash})}}]),ScriptsRepository}();function XPathHashProducer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ee=function(){function XPathHashProducer(){!function XPathHashProducer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,XPathHashProducer),this._initialize()}return function XPathHashProducer_createClass(e,t,n){t&&XPathHashProducer_defineProperties(e.prototype,t),n&&XPathHashProducer_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(XPathHashProducer,[{key:"_initialize",value:function _initialize(){this._nodeParentHash=new WeakMap,this._nodeNameOccurencesPerParent=[],this._nodeNameOccurencesPerParent.push({})}},{key:"getUniqueElementName",value:function getUniqueElementName(e){return e.nodeName.toLowerCase()+(e.id||"")+(e.name||"")+(e.href||"")+(e.getAttribute&&e.getAttribute("class")||"")+(e.title||"")}},{key:"produce",value:function produce(e){var t,n=[],r=e,o=(e.id||"")+(e.name||"")+(e.nodeName||"")+(e.className||"")+(e.title||"")+(e.href||"");if(e.parentNode&&this._nodeParentHash.has(e.parentNode)){var i=e.nodeName.toLowerCase(),s=this._nodeParentHash.get(e.parentNode),a=s.occurrencesIndex,c=0;return this._nodeNameOccurencesPerParent[a]&&(void 0!==this._nodeNameOccurencesPerParent[a][i]?(c=++this._nodeNameOccurencesPerParent[a][i],this._nodeNameOccurencesPerParent[a][i]=c):this._nodeNameOccurencesPerParent[a][i]=0),o+=s.hash+","+this.getUniqueElementName(e)+(c||"")}t=e.parentNode||!1;for(var u=0;e&&1===e.nodeType;e=e.parentNode){for(var l=0,f=e.previousSibling;f;f=f.previousSibling)f.nodeType!==Node.DOCUMENT_TYPE_NODE&&f.nodeName===e.nodeName&&(u=++l);var p=this.getUniqueElementName(e),d=l||"";n.splice(0,0,p+d)}o+=n.length?"/"+n.join():"";s=[];return 0<n.length&&(s=n.slice(0,n.length-1)),t&&((c={})[r.nodeName.toLowerCase()]=u,c=this._nodeNameOccurencesPerParent.push(c)-1,this._nodeParentHash.set(t,{hash:"/"+s.join(),occurrencesIndex:c})),o}}]),XPathHashProducer}();function DataCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var te=function(){function DataCollector(){!function DataCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DataCollector)}return function DataCollector_createClass(e,t,n){t&&DataCollector_defineProperties(e.prototype,t),n&&DataCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DataCollector,[{key:"startFeature",value:function startFeature(){}},{key:"stopFeature",value:function stopFeature(){}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){}},{key:"sendToQueue",value:function sendToQueue(){}},{key:"getEventTimestamp",value:function getEventTimestamp(){return f.dateNow()}},{key:"getTimestampFromEvent",value:function getTimestampFromEvent(e){return e.timeStamp?f.cutDecimalPointDigits(e.timeStamp,3):0}}]),DataCollector}();function ElementsCollector_typeof(e){return(ElementsCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ElementsCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ElementsCollector_setPrototypeOf(e,t){return(ElementsCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ElementsCollector_createSuper(n){var r=function ElementsCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ElementsCollector_getPrototypeOf(n);return function ElementsCollector_possibleConstructorReturn(e,t){{if(t&&("object"===ElementsCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function ElementsCollector_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=ElementsCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ElementsCollector_getPrototypeOf(e){return(ElementsCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ne=function(){!function ElementsCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ElementsCollector_setPrototypeOf(e,t)}(ElementsCollector,te);var i=ElementsCollector_createSuper(ElementsCollector);function ElementsCollector(e,t,n,r){var o;return function ElementsCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementsCollector),(o=i.call(this))._configurationRepository=e,o._utils=t,o._dataQueue=n,o._contextMgr=r,o._elementHashWMap=new WeakMap,o._collectPosition=!0,o._collectClassName=!0,o._collectTitle=!0,o._collectHref=!0,o._collectCustomElementAttribute=!0,o._customElementAttribute=o._configurationRepository.get(T.customElementAttribute),o._attributeMaskedList=o._configurationRepository.get(T.maskElementsAttributes),o._maxElemValLength=30,o._XPathHashProducer=new ee,o._allowedUnmaskedValuesList=o._configurationRepository.get(T.allowedUnmaskedValuesList),o._enableUnmaskedValues=o._configurationRepository.get(T.enableUnmaskedValues),o}return function ElementsCollector_createClass(e,t,n){t&&ElementsCollector_defineProperties(e.prototype,t),n&&ElementsCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ElementsCollector,[{key:"getElement",value:function getElement(e){if(this._utils.isUndefinedNull(e)||e===document||e===document.body)return-1;var t,n=-1;return this._elementHashWMap.has(e)?n=this._elementHashWMap.get(e).hash:(n=(t=this._XPathHashProducer.produce(e))?this._utils.getHash(t):-1,this._elementHashWMap.set(e,{hash:n,contextList:[this._contextMgr.contextName]}),this._sendElementToServer(e,n)),n}},{key:"resendElementPerContext",value:function resendElementPerContext(e){var t,n;this._elementHashWMap.has(e)?(n=(t=this._elementHashWMap.get(e)).hash,t.contextList.indexOf(this._contextMgr.contextName)<0&&(t.contextList.push(this._contextMgr.contextName),this._elementHashWMap.set(e,{hash:t.hash,contextList:t.contextList}),this._sendElementToServer(e,n))):M.error("received for resendElementPerContext bad element, not in hash map. id=".concat(e.id))}},{key:"isListed",value:function isListed(e){return this._elementHashWMap.has(e)}},{key:"getElementData",value:function getElementData(e){return this._elementHashWMap.get(e)}},{key:"getElementContextList",value:function getElementContextList(e){return this._elementHashWMap.get(e).contextList}},{key:"_sendElementToServer",value:function _sendElementToServer(e,t){var n=this._collectPosition?e.getBoundingClientRect&&e.getBoundingClientRect():null,r=-1,o=-1,i=-1,s=-1;n&&(r=Math.round(n.left),o=Math.round(n.top),i=Math.round(n.right-n.left),s=Math.round(n.bottom-n.top));var a=this._verifyNoPrivateData(e.id||""),c=this._verifyNoPrivateData(e.name||"");this._attributeMaskedList=this._configurationRepository.get(T.maskElementsAttributes)||{};var u=this._attributeMaskedList&&this._attributeMaskedList[e.id]||"",l=this._attributeMaskedList&&this._attributeMaskedList[e.name]||"",f=this._collectClassName&&e.getAttribute&&this._verifyNoPrivateData(e.getAttribute("class"))||"",p=this._collectTitle&&this._verifyNoPrivateData(e.title)||"",d=this._verifyNoPrivateData(e.nodeName)||"",y=this._collectHref&&this._verifyNoPrivateData(e.href)||"";0<y.length&&(y=this._utils.clearTextFromNumbers(y));var h=this._collectCustomElementAttribute&&e.getAttribute&&this._verifyNoPrivateData(e.getAttribute(this._customElementAttribute))||"",v=this._attributeMaskedList[h]||"",_="";"SELECT"===e.nodeName&&(_=this._utils.getDropDownListValues(e).join(";"));var m=e.value||e.textContent||e.innerHTML||"",g="";this._enableUnmaskedValues&&Array.isArray(this._allowedUnmaskedValuesList)&&0<this._allowedUnmaskedValuesList.length&&this._allowedUnmaskedValuesList.forEach(function(e){"string"!=typeof e?M.error("Unsupported allowedUnmaksedValuesList value was provided: ".concat(e.toString())):e.toLowerCase()===m.trim().toLowerCase()&&(g=e)}),m=m.length>this._maxElemValLength?"":this._utils.maskText(m.toString());var b=this._utils.isUndefinedNull(e.checked)?-1:e.checked?1:0,n=this.getEventTimestamp();this._dataQueue.addToQueue("elements",[this._contextMgr.contextId,t,d||"",u||a||"",l||c||"",e.type||"",r||0,o||0,i||0,s||0,f||"",y||"",p||"",e.alt||"",_||"",m||"",b,n,v||h,g],!1),M.isDebug()&&M.debug("adding element id:"+a+", name:"+c+", type:"+e.type+", width:"+i+", height:"+s+", left:"+r+", top:"+o+", hash: "+t)}},{key:"_verifyNoPrivateData",value:function _verifyNoPrivateData(e){return/\d\d\d/.test(e)?this._utils.clearTextFromNumbers(e):e}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){this._collectPosition="boolean"==typeof this._configurationRepository.get("isElementsPosition")?this._configurationRepository.get("isElementsPosition"):this._collectPosition,this._collectClassName="boolean"==typeof this._configurationRepository.get("isElementsClassName")?this._configurationRepository.get("isElementsClassName"):this._collectClassName,this._collectTitle="boolean"==typeof this._configurationRepository.get("isElementsTitle")?this._configurationRepository.get("isElementsTitle"):this._collectTitle,this._collectHref="boolean"==typeof this._configurationRepository.get("isElementsHref")?this._configurationRepository.get("isElementsHref"):this._collectHref,this._collectCustomElementAttribute="boolean"==typeof this._configurationRepository.get(T.collectCustomElementAttribute)?this._configurationRepository.get(T.collectCustomElementAttribute):this._collectCustomElementAttribute,this._customElementAttribute="string"==typeof this._configurationRepository.get(T.customElementAttribute)?this._configurationRepository.get(T.customElementAttribute):this._customElementAttribute,this._maxElemValLength=this._configurationRepository.get("maxElValLen")?this._configurationRepository.get("maxElValLen"):this._maxElemValLength,this._allowedUnmaskedValuesList=this._configurationRepository.get("allowedUnmaskedValuesList")?this._configurationRepository.get("allowedUnmaskedValuesList"):this._allowedUnmaskedValuesList,this._enableUnmaskedValues=this._configurationRepository.get("enableUnmaskedValues")?this._configurationRepository.get("enableUnmaskedValues"):this._enableUnmaskedValues}}]),ElementsCollector}(),re={false:0,true:1,undefined:2,null:2};function TouchEventCollector_typeof(e){return(TouchEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TouchEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TouchEventCollector_setPrototypeOf(e,t){return(TouchEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function TouchEventCollector_createSuper(n){var r=function TouchEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=TouchEventCollector_getPrototypeOf(n);return function TouchEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===TouchEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return TouchEventCollector_assertThisInitialized(e)}(this,r?(e=TouchEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function TouchEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TouchEventCollector_getPrototypeOf(e){return(TouchEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oe={configKey:"isTouchEvents",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},ie={pointerdown:"touchstart",pointerup:"touchend",pointermove:"touchmove",MSPointerDown:"touchstart",MSPointerUp:"touchend",MSPointerMove:"touchmove"},se={touchstart:0,touchmove:1,touchend:2,touchcancel:3},ae=["eventSequence","timestamp","eventType","isTrusted","elementHash","clientX","clientY","touchIndex","touchSizeMajor","touchSizeMinor","pageX","pageY","screenX","screenY","relativeTime","touchPressure"],ce=function(){!function TouchEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TouchEventCollector_setPrototypeOf(e,t)}(TouchEventCollector,te);var i=TouchEventCollector_createSuper(TouchEventCollector);function TouchEventCollector(e,t,n,r){var o;return function TouchEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TouchEventCollector),(o=i.call(this))._utils=e,o._dataQ=n,o._elements=t,o._msgBus=r,o._onAllBrowsersTouchEventBinded=o._onAllBrowsersTouchEvent.bind(TouchEventCollector_assertThisInitialized(o)),o}return function TouchEventCollector_createClass(e,t,n){t&&TouchEventCollector_defineProperties(e.prototype,t),n&&TouchEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(TouchEventCollector,[{key:"startFeature",value:function startFeature(e){this._bind(e)}},{key:"stopFeature",value:function stopFeature(e){this._unbind(e)}},{key:"_addToCommunicationQueue",value:function _addToCommunicationQueue(e,t,n,r){e!==se.touchstart&&e!==se.touchend||this._msgBus.publish(_.TouchEvent,{action:e});var o=this.getEventTimestamp(r),i=re[r.isTrusted],s=this._elements.getElement(r.target),a=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._utils.isUndefinedNull(e)&&(e=-1),this._utils.isUndefinedNull(t)&&(t=-1);r=this.getTimestampFromEvent(r);this._dataQ.addToQueue("touch_events",this._utils.convertToArrayByMap(ae,{eventSequence:a,timestamp:o,eventType:e,isTrusted:i,elementHash:s,clientX:n.clientX?Math.round(n.clientX):0,clientY:n.clientY?Math.round(n.clientY):0,touchIndex:t,touchSizeMajor:n.radiusX?2*n.radiusX:0,touchSizeMinor:n.radiusY?2*n.radiusY:0,pageX:n.pageX||0,pageY:n.pageY||0,screenX:n.screenX||0,screenY:n.screenY||0,relativeTime:r,touchPressure:n.force||-1}))}},{key:"_bind",value:function _bind(e){var t,n=e.getDocument();if(window.TouchEvent?t=["touchstart","touchmove","touchend","touchcancel"]:window.PointerEvent&&(t=["pointerdown","pointermove","pointerup"]),this._listeningToEvents=t,this._listeningToEvents)for(var r=0;r<this._listeningToEvents.length;r++)this._utils.addEventListener(n,this._listeningToEvents[r],this._onAllBrowsersTouchEventBinded)}},{key:"_unbind",value:function _unbind(e){var t=e.getDocument();if(this._listeningToEvents)for(var n=0;n<this._listeningToEvents.length;n++)this._utils.removeEventListener(t,this._listeningToEvents[n],this._onAllBrowsersTouchEventBinded)}},{key:"_onAllBrowsersTouchEvent",value:function _onAllBrowsersTouchEvent(e){return this._onIeTouchEvent(e),this._onTouchEvent(e),!0}},{key:"_onTouchEvent",value:function _onTouchEvent(e){if((null===e.pointerType||void 0===e.pointerType)&&void 0!==e.changedTouches)for(var t=se[e.type],n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],o=r.identifier%1e4;this._addToCommunicationQueue(t,o,r,e)}}},{key:"_onIeTouchEvent",value:function _onIeTouchEvent(e){var t,n;null!=e.pointerType&&("touch"!==e.pointerType&&"pen"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH&&e.pointerType!==e.MSPOINTER_TYPE_PEN||(n=ie[e.type]||"touchcancel",t=e.pointerId?e.pointerId%1e4:0,n=se[n],this._addToCommunicationQueue(n,t,e,e)))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return oe}}]),TouchEventCollector}();function SameCharService_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ue={true:1,false:0,undefined:-1},le=function(){function SameCharService(){!function SameCharService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SameCharService),this._elementList=new WeakMap}return function SameCharService_createClass(e,t,n){t&&SameCharService_defineProperties(e.prototype,t),n&&SameCharService_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SameCharService,[{key:"update",value:function update(e,t){this._elementList.set(e,t)}},{key:"compare",value:function compare(e,t){return ue[t===this._elementList.get(e)]}}]),SameCharService}(),fe={IntlBackslash:"0",Digit1:"0",Digit2:"0",Digit3:"0",Digit4:"1",Digit5:"1",Digit6:"1",Digit7:"1",Digit8:"2",Digit9:"2",Digit0:"2",KeyQ:"3",KeyW:"3",KeyE:"3",KeyA:"3",KeyS:"3",KeyD:"3",KeyZ:"3",KeyX:"3",KeyC:"3",KeyR:"4",KeyT:"4",KeyF:"4",KeyG:"4",KeyV:"4",KeyB:"4",KeyY:"5",KeyU:"5",KeyH:"5",KeyJ:"5",KeyN:"5",KeyM:"5",KeyI:"6",KeyO:"6",KeyP:"6",KeyK:"6",KeyL:"6",Comma:"6",Period:"6",Semicolon:"7",Minus:"7",Equal:"7",Slash:"7",BracketLeft:"7",Backslash:"7",BracketRight:"7",Quote:"7",NumLock:"8",NumpadDivide:"8",NumpadMultiply:"8",NumpadSubtract:"8",NumpadAdd:"8",NumpadEnter:"8",NumpadDecimal:"8",Numpad0:"8",Numpad1:"8",Numpad2:"8",Numpad3:"8",Numpad4:"8",Numpad5:"8",Numpad6:"8",Numpad7:"8",Numpad8:"8",Numpad9:"8"};function KeyEventCollector_typeof(e){return(KeyEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KeyEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KeyEventCollector_setPrototypeOf(e,t){return(KeyEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function KeyEventCollector_createSuper(n){var r=function KeyEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=KeyEventCollector_getPrototypeOf(n);return function KeyEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===KeyEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return KeyEventCollector_assertThisInitialized(e)}(this,r?(e=KeyEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function KeyEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KeyEventCollector_getPrototypeOf(e){return(KeyEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe={configKey:"isKeyEvents",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},de={keyup:0,keydown:1,keypress:2},ye=["eventSequence","timestamp","eventType","isTrusted","elementHash","charCode","character","keyComboType","isCtrl","isShift","isAlt","isMetaKey","keyLocation","code","key","isRepeat","keyRegion","relativeTime","isSameKey"],he=function(){!function KeyEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KeyEventCollector_setPrototypeOf(e,t)}(KeyEventCollector,te);var c=KeyEventCollector_createSuper(KeyEventCollector);function KeyEventCollector(e,t,n,r,o,i,s){var a;return function KeyEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,KeyEventCollector),(a=c.call(this))._configurationRepository=e,a._utils=t,a._elements=n,a._dataQueue=r,a._msgBus=o,a._sameCharService=i,a._maskingService=s,a.comboCodes=["c","v","a","x","z","p","s"],a._onKeyEvent=a._onKeyEvent.bind(KeyEventCollector_assertThisInitialized(a)),a._useCaptureEvents=a._configurationRepository.get(T.isCaptureKeyEvents),a}return function KeyEventCollector_createClass(e,t,n){t&&KeyEventCollector_defineProperties(e.prototype,t),n&&KeyEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(KeyEventCollector,[{key:"startFeature",value:function startFeature(e){try{var t=e.getDocument();this._bind(t,this._onKeyEvent,this._useCaptureEvents)}catch(e){M.error("KeyEvents:startFeature failed, msg: ".concat(e.message),e)}}},{key:"stopFeature",value:function stopFeature(e){try{var t=e.getDocument();this._unbind(t,this._onKeyEvent,this._useCaptureEvents)}catch(e){M.error("KeyEvents:stopFeature failed, msg: ".concat(e.message),e)}}},{key:"updateFeatureConfig",value:function updateFeatureConfig(e){try{var t,n;this._configurationRepository.get(T.isCaptureKeyEvents)!==this._useCaptureEvents&&(t=e.getDocument(),n=this._configurationRepository.get(T.isCaptureKeyEvents),this._unbind(t,this._onKeyEvent,this._useCaptureEvents),this._bind(t,this._onKeyEvent,n),this._useCaptureEvents=n)}catch(e){M.error("KeyEvents:startFeature failed, msg: ".concat(e.message),e)}}},{key:"_bind",value:function _bind(e,t,n){e.addEventListener("keyup",t,n),e.addEventListener("keydown",t,n),e.addEventListener("keypress",t,n)}},{key:"_unbind",value:function _unbind(e,t,n){e.removeEventListener("keyup",t,n),e.removeEventListener("keydown",t,n),e.removeEventListener("keypress",t,n)}},{key:"_onKeyEvent",value:function _onKeyEvent(e){var t=de[e.type];t!==de.keydown&&t!==de.keyup||this._msgBus.publish(_.KeyEvent,{action:t}),this._handleKeyEvent(e,"key_events")}},{key:"_handleKeyEvent",value:function _handleKeyEvent(e,t){var n=de[e.type];this._utils.isUndefinedNull(n)&&(n=-1);var r=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),o=this.getEventTimestamp(e),i=e.key||this._maskingService.getKeyFromLegacyProperties(e),s=e.code||"",a=this._maskingService.maskKey(i,s),c=1<a.key.length?"":a.key,u=this._elements.getElement(e.target),l=this._getComboType(e,i),f=re[e.isTrusted],p="Meta"===e.key||"OS"===e.key||"Win"===e.key||e.metaKey||91===e.keyCode||92===e.keyCode,d=this._configurationRepository.get(T.collectKeyRegionValue)?this._getKeyRegion(s):"-1",i=this.getTimestampFromEvent(e),s=ue.undefined;"keypress"===e.type&&(s=this._sameCharService.compare(e.target,e.key),this._sameCharService.update(e.target,e.key)),M.isDebug()&&M.trace("onKeyEvent: got event: ".concat(n,", at time:").concat(o,", key: ").concat(a.key,", code:").concat(a.code,", old charCode:").concat(a.charCode)),this._dataQueue.addToQueue(t,this._utils.convertToArrayByMap(ye,{eventType:n,eventSequence:r,timestamp:o,charCode:a.charCode,character:c,elementHash:u,keyComboType:l,isTrusted:f,isCtrl:e.ctrlKey||!1,isShift:e.shiftKey||!1,isAlt:e.altKey||!1,isMetaKey:p||!1,keyLocation:e.location||0,code:a.code||"",key:a.key||"",location:e.location||"",isRepeat:e.repeat||!1,keyRegion:d,relativeTime:i,isSameKey:s}))}},{key:"_getKeyRegion",value:function _getKeyRegion(e){return fe[e]||"-1"}},{key:"_getComboType",value:function _getComboType(e,t){return(e.ctrlKey||e.metaKey)&&void 0!==t?this.comboCodes.indexOf(t):-1}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return pe}}]),KeyEventCollector}();function SensorsDataQueue_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ve=function(){function SensorsDataQueue(e,t,n,r,o){!function SensorsDataQueue_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SensorsDataQueue),this._historyBuffer=[],this._isTouchInProgress=!1,this._touchStartCount=0,this._isPostTouch=!1,this._touchEndTime=0,this._sensorGateKeeper=o,this._dataQueue=t,this._configurationRepository=e,this._msgBus=n,this._utils=r,this._msgBus.subscribe(_.TouchEvent,this._onTouch.bind(this)),this._msgBus.subscribe(_.KeyEvent,this._onTouch.bind(this)),this._isMotionAroundTouchEnabled=this._configurationRepository.get(T.isMotionAroundTouchEnabled),this._aroundTouchInterval=this._configurationRepository.get(T.motionPaddingAroundTouchMSec)}return function SensorsDataQueue_createClass(e,t,n){t&&SensorsDataQueue_defineProperties(e.prototype,t),n&&SensorsDataQueue_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SensorsDataQueue,[{key:"addToQueue",value:function addToQueue(e,t,n,r){var o=this._utils.dateNow();if(this._isPostTouch&&o-this._touchEndTime>this._aroundTouchInterval&&(M.debug("SensorsDataQueue: stopped post touch events, time has passed (".concat(this._aroundTouchInterval," millisec)")),this._isPostTouch=!1),!this._isMotionAroundTouchEnabled||this._isTouchInProgress||this._isPostTouch||this._sensorGateKeeper.isOpen())this._dataQueue.addToQueue(e,t,n,r);else{this._historyBuffer.push({name:e,data:t,addCtxId:n,isImmediateWup:r,timestamp:o});for(var i=0,s=this._historyBuffer.length;i<s;i++){if(!(o-this._historyBuffer[0].timestamp>this._aroundTouchInterval))break;this._historyBuffer.shift()}}}},{key:"onConfigUpdate",value:function onConfigUpdate(){this._aroundTouchInterval=void 0!==this._configurationRepository.get(T.motionPaddingAroundTouchMSec)?this._configurationRepository.get(T.motionPaddingAroundTouchMSec):this._aroundTouchInterval,this._isMotionAroundTouchEnabled=void 0!==this._configurationRepository.get(T.isMotionAroundTouchEnabled)?this._configurationRepository.get(T.isMotionAroundTouchEnabled):this._isMotionAroundTouchEnabled}},{key:"_sendBuffer",value:function _sendBuffer(){var e=this._utils.dateNow();M.debug("sending history sensors buffer ts=".concat(e));for(var t=0,n=this._historyBuffer.length;t<n;t++)e-this._historyBuffer[t].timestamp<=this._aroundTouchInterval&&this._dataQueue.addToQueue(this._historyBuffer[t].name,this._historyBuffer[t].data,this._historyBuffer[t].addCtxId,this._historyBuffer[t].isImmediateWup);this._historyBuffer=[]}},{key:"_onTouch",value:function _onTouch(e){return this._isMotionAroundTouchEnabled&&(this._isTouchInProgress||e.action!==se.touchstart&&e.action!==de.keydown?e.action===se.touchend||e.action===de.keyup?(this._touchStartCount--,this._touchStartCount<=0&&(this._isTouchInProgress=!1,this._isPostTouch=!0,this._touchEndTime=this._utils.dateNow(),M.debug("stopped touch event in sensors data q ts=".concat(this._utils.dateNow())))):e.action!==se.touchstart&&e.action!==de.keydown||this._touchStartCount++:(M.debug("Started touch event in sensors data q ts=".concat(this._utils.dateNow())),this._isTouchInProgress=!0,this._touchStartCount=1,this._sendBuffer())),!1}}]),SensorsDataQueue}();function DataQ_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _e=function(){function DataQ(e,t,n,r,o,i){var s=this;!function DataQ_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DataQ),function DataQ_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_dataOrigin","BC"),this._serverWorkerCommunicator=t,this._contextManager=n,this._passToWorkerInterval=i||0,this._intervalConfigKey=r,this._msgToWorker=o,this._Q=[],this._passToWorkerInterval&&(this._intervalId=setInterval(this._sendQToServerWorker.bind(this),this._passToWorkerInterval)),e.addEventListener(window,"beforeunload",function(){s._onUnload()},!0)}return function DataQ_createClass(e,t,n){t&&DataQ_defineProperties(e.prototype,t),n&&DataQ_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DataQ,[{key:"addToQueue",value:function addToQueue(e,t,n,r){(n=!(null!=n&&!0!==n))&&t.push&&(t[0]=this._contextManager.contextId),0!==this._passToWorkerInterval?(this._Q.push({eventName:e,data:t,shouldFlush:r,origin:this._dataOrigin}),r&&this._sendQToServerWorker()):this._serverWorkerCommunicator.sendAsync(this._msgToWorker,{eventName:e,data:t,shouldFlush:r,origin:this._dataOrigin})}},{key:"updateWithConfig",value:function updateWithConfig(e){e=e.get(this._intervalConfigKey);void 0!==e&&e!==this._passToWorkerInterval&&(this._passToWorkerInterval=e,clearInterval(this._intervalId),this._intervalId=null,0!==this._passToWorkerInterval&&(this._intervalId=setInterval(this._sendQToServerWorker.bind(this),this._passToWorkerInterval)))}},{key:"flushAllMessages",value:function flushAllMessages(){this._Q.push({eventName:"flushData"}),this._sendQToServerWorker()}},{key:"_sendQToServerWorker",value:function _sendQToServerWorker(){try{this._Q.length&&(this._serverWorkerCommunicator.sendAsync(this._msgToWorker,this._Q),this._Q=[])}catch(e){M.error("Failed sending data to worker. ".concat(e)),this._sendQInSingleMessagesToServerWorker()}}},{key:"_sendQInSingleMessagesToServerWorker",value:function _sendQInSingleMessagesToServerWorker(){for(var e=0;e<this._Q.length;e++)try{this._serverWorkerCommunicator.sendAsync(this._msgToWorker,this._Q[e])}catch(e){M.error("Failed sending single message data to worker. ".concat(e))}this._Q=[]}},{key:"_onUnload",value:function _onUnload(){this.flushAllMessages()}},{key:"filterOut",value:function filterOut(e){this._Q=this._Q.filter(e)}}]),DataQ}();function SlaveConfigurationLoadedEventHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me=function(){function SlaveConfigurationLoadedEventHandler(e,t,n,r,o,i,s){!function SlaveConfigurationLoadedEventHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveConfigurationLoadedEventHandler),this._messageBus=e,this._featureService=t,this._dataQ=n,this._pauseResumeMgr=r,this._logger=o,this._contextMgr=i,this._sensorGateKeeper=s,this._messageBus.subscribe(_.ConfigurationLoadedEvent,this._handle.bind(this))}return function SlaveConfigurationLoadedEventHandler_createClass(e,t,n){t&&SlaveConfigurationLoadedEventHandler_defineProperties(e.prototype,t),n&&SlaveConfigurationLoadedEventHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveConfigurationLoadedEventHandler,[{key:"_handle",value:function _handle(e){this._featureService.updateRunByConfig(e),this._dataQ.updateWithConfig(e),this._pauseResumeMgr.onConfigUpdate(e),this._logger.updateLogConfig(e),this._contextMgr.onConfigUpdate(e),this._sensorGateKeeper.configure()}}]),SlaveConfigurationLoadedEventHandler}();function SiteMapper_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=function(){function SiteMapper(e,t,n,r,o){var i=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:200;!function SiteMapper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SiteMapper),this._mutationObserver=e,this._siteMapKey=r,this._keyUrl=r+"_isUrlNonMasked",this._stopOnFirstMappingMatch=i,this._siteMap=null,this._observers=[],this._utils=t,this._domUtils=n,this._onMatchCB=o,this._maxMappings=s,this._maxTriggers=10}return function SiteMapper_createClass(e,t,n){t&&SiteMapper_defineProperties(e.prototype,t),n&&SiteMapper_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SiteMapper,[{key:"updateObserver",value:function updateObserver(e){this._onMatchCB=e}},{key:"_observeChange",value:function _observeChange(e,t){if(e)try{var n,r=window.document.querySelector(e);r?((n=new this._mutationObserver(function(e){0<e.length&&t()})).observe(r,{childList:!0,characterData:!0,attributes:!0,subtree:!0}),this._observers.push(n)):M.error("Selector:".concat(JSON.stringify(e)," not found on page. Check ").concat(this._siteMapKey," configuration"))}catch(e){M.error("SiteMapper._observeChange: ".concat(e.message),e)}}},{key:"initTracking",value:function initTracking(){function gC(){try{for(var e=0;e<r._siteMap.mappings.length;e++){var t=r._siteMap.mappings[e];if(!t.url||-1<r._url.indexOf(t.url))if(t.selector){var n=window.document.querySelector(t.selector);if(n)if(t.byText){if((void 0!==n.innerText&&-1!==n.innerText.indexOf(t.byText)||n.value===t.byText||n.textContent===t.byText)&&(r._onMatchCB(t),r._stopOnFirstMappingMatch))return}else if(r._onMatchCB(t),r._stopOnFirstMappingMatch)return}else if(-1<r._url.indexOf(t.url)&&(r._onMatchCB(t),r._stopOnFirstMappingMatch))return}}catch(e){M.error("SiteMapper:testQuerySelector failed. ex: ".concat(e.message),e)}}var e,r=this;this._siteMap||((e=this._utils.StorageUtils.getFromSessionStorage(this._siteMapKey))&&e.triggers.length<=this._maxTriggers&&e.mappings.length<=this._maxMappings&&(this._siteMap=e),this._isNonMaskedUrl=this._utils.StorageUtils.getFromSessionStorage(this._keyUrl)),this._siteMap&&(this._url=this._isNonMaskedUrl?window.document.location.href:this._utils.getDocUrl(),this._domUtils.onDocumentBody(window,function(){r._mutationObserver&&r._siteMap.triggers.forEach(function(e){(!e.url||-1<r._url.indexOf(e.url))&&r._observeChange(e.selector,gC)}),gC()}))}},{key:"onConfigUpdate",value:function onConfigUpdate(e){try{var t;!this._siteMap&&e.get(this._siteMapKey)&&(this.stopTracking(),t=e.get(this._siteMapKey)&&JSON.parse(e.get(this._siteMapKey)),this._isNonMaskedUrl=e.get("useNonMaskedUrlInMappings"),t&&t.triggers.length<=this._maxTriggers&&t.mappings.length<=this._maxMappings?(this._siteMap=t,this._utils.StorageUtils.saveToSessionStorage(this._siteMapKey,this._siteMap),this._utils.StorageUtils.saveToSessionStorage(this._keyUrl,this._isNonMaskedUrl),this.initTracking()):M.warn("Configuration ".concat(this._siteMapKey," contains an illegal amount of triggers or mappings. Max Allowed Triggers: ").concat(this._maxTriggers,", ")+"Max Allowed Mappings: ".concat(this._maxMappings)))}catch(e){M.error("An error occurred while loading ".concat(this._siteMapKey," configuration. Make sure the configuration value is valid. ").concat(e.message),e)}}},{key:"stopTracking",value:function stopTracking(){for(var e=0;e<this._observers.length;e++)this._observers[e].disconnect();this._observers=[],this._siteMap=null}}]),SiteMapper}();function WorkerCommunicator_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function WorkerCommunicator(){!function WorkerCommunicator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WorkerCommunicator),this._msgListeners=d()}return function WorkerCommunicator_createClass(e,t,n){t&&WorkerCommunicator_defineProperties(e.prototype,t),n&&WorkerCommunicator_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(WorkerCommunicator,[{key:"setMessagingPort",value:function setMessagingPort(e){var o=this;(this._messagePort=e).setonmessage(function(e){var t=e.data,n=[],r=o._msgListeners.get(t.msgType);r&&r.forEach(function(e){e.callback(t.data),e.isOneTime&&n.push(e)}),n.forEach(function(e){r.delete(e)})})}},{key:"sendAsync",value:function sendAsync(e,t,n,r,o){r&&n&&this.addMessageListener(n,r,o),this._messagePort.postMessage({msgType:e,data:t})}},{key:"addMessageListener",value:function addMessageListener(e,t,n){var r=null;this._msgListeners.has(e)?r=this._msgListeners.get(e):(r=h(),this._msgListeners.set(e,r)),r.add({callback:t,isOneTime:n})}}]),WorkerCommunicator}();function ParentCommunicator_typeof(e){return(ParentCommunicator_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ParentCommunicator_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ParentCommunicator_setPrototypeOf(e,t){return(ParentCommunicator_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ParentCommunicator_createSuper(n){var r=function ParentCommunicator_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ParentCommunicator_getPrototypeOf(n);return function ParentCommunicator_possibleConstructorReturn(e,t){{if(t&&("object"===ParentCommunicator_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ParentCommunicator_assertThisInitialized(e)}(this,r?(e=ParentCommunicator_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ParentCommunicator_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ParentCommunicator_getPrototypeOf(e){return(ParentCommunicator_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ce=function(){!function ParentCommunicator_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ParentCommunicator_setPrototypeOf(e,t)}(ParentCommunicator,be);var n=ParentCommunicator_createSuper(ParentCommunicator);function ParentCommunicator(e){var t;return function ParentCommunicator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ParentCommunicator),(t=n.call(this)).setMessagingPort(ParentCommunicator_assertThisInitialized(t)),t._slaves=[],t._msgRouter={dataFromSlave:t._onDataFromSlave,registerSlave:t._onRegisterSlave,updateSlaveConf:t._onUpdateSlaveConf,updateSlaveState:t._onUpdateSlaveState,updateMasterContext:t._onUpdateMasterContext,resetSessionTriggerFromSlave:t._onResetSessionTriggerFromSlave,mouseChallengeTriggerFromSlave:t._onMouseChallengeTriggerFromSlave},t.messageEventHandler=e,t}return function ParentCommunicator_createClass(e,t,n){t&&ParentCommunicator_defineProperties(e.prototype,t),n&&ParentCommunicator_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ParentCommunicator,[{key:"setonmessage",value:function setonmessage(e){this._workerCommCallback=e}},{key:"registerToParent",value:function registerToParent(){M.info("ParentRegisterer:registerToParent - registering to parent from slave. url: ".concat(window.location.href)),this.messageEventHandler.subscribeToMessageEvents(this._getChannelMessageCallback(),this._getWindowMessageCallback()),this.messageEventHandler.sendToParent({msgType:m})}},{key:"sendToParent",value:function sendToParent(e){this.messageEventHandler.sendToParent(e)}},{key:"sendToSlaves",value:function sendToSlaves(t){M.debug("ParentCommunicator:sendToSlaves"),this._slaves.forEach(function(e){e.source.postMessage(t,e.origin)})}},{key:"notifyContextChange",value:function notifyContextChange(e){"slave_cd_auto"!==e.name&&this.sendAsync(C,e)}},{key:"notifyResetSession",value:function notifyResetSession(e){this.sendAsync(E,e)}},{key:"notifyMouseChallenge",value:function notifyMouseChallenge(e){this.sendAsync(P,e)}},{key:"sendAsync",value:function sendAsync(e,t){this.sendToParent({msgType:e,data:t})}},{key:"_onDataFromSlave",value:function _onDataFromSlave(e){this.sendToParent(e.data)}},{key:"_onRegisterSlave",value:function _onRegisterSlave(e){M.debug("ParentCommunicator:_onRegisterSlave - registering a sub slave"),this._slaves.push({source:e.source,origin:e.origin}),this.sendToParent(e.data)}},{key:"_onUpdateSlaveConf",value:function _onUpdateSlaveConf(e){M.debug("ParentCommunicator:_onUpdateSlaveConf - got config"),this.sendToSlaves(e.data),this._workerCommCallback(e)}},{key:"_onUpdateSlaveState",value:function _onUpdateSlaveState(e){M.debug("ParentCommunicator:_onUpdateSlaveState"),this.sendToSlaves(e.data),this._workerCommCallback(e)}},{key:"_onUpdateMasterContext",value:function _onUpdateMasterContext(e){M.debug("ParentCommunicator:_onUpdateMasterContext"),this.sendToParent(e.data)}},{key:"_onResetSessionTriggerFromSlave",value:function _onResetSessionTriggerFromSlave(e){M.debug("ParentCommunicator:_onResetSessionTriggerFromSlave"),this.sendToParent(e.data)}},{key:"_onMouseChallengeTriggerFromSlave",value:function _onMouseChallengeTriggerFromSlave(e){M.debug("ParentCommunicator:_onMouseChallengeTriggerFromSlave"),this.sendToParent(e.data)}},{key:"_getWindowMessageCallback",value:function _getWindowMessageCallback(){var n=this;return function(e,t){t&&n._msgRouter[t]&&n._msgRouter[t].call(n,e)}}},{key:"_getChannelMessageCallback",value:function _getChannelMessageCallback(){var t=this;return function(e){t._msgRouter[e.msgType]&&t._msgRouter[e.msgType].call(t,{data:e})}}}]),ParentCommunicator}();function ConfigurationRepository_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ee={defaultDynamicWupDispatchRateConfiguration:{type:"dynamic"},defaultIncrementalWupDispatchRateConfiguration:{type:"incremental",initialRateValueMs:500,incrementStepMs:500,incrementStopMs:5e3,incrementStartWupSendCount:20}},Pe=function(){function ConfigurationRepository(){!function ConfigurationRepository_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ConfigurationRepository),this._requireParseFields=d(),this._requireParseFields.set(T.dataWupDispatchRateSettings,T.dataWupDispatchRateSettings),this._requireParseFields.set(T.logWupDispatchRateSettings,T.logWupDispatchRateSettings),this._requireParseFields.set(T.crossDomainsList,T.crossDomainsList),this._requireParseFields.set(T.allowedUnmaskedValuesList,T.allowedUnmaskedValuesList),this._requireParseFields.set(T.serverCommunicationSettings,T.serverCommunicationSettings),this._configurationList={},this.configDefault={logLevel:D.INFO,isCrossdomain:!1,crossDomainsList:[],crossDomainsTimeout:5e3,orientationEventsSamplePeriod:300,orientationEventsThreshold:1,stateChangeEnabled:!1,accelerometerEventsSamplePeriod:0,dataQPassWorkerInterval:500,gyroEventsSamplePeriod:0,gyroEventsThreshold:.3,isContextPropsFeature:!0,isEnabled:!0,isResetEveryLoad:!1,isScrollCollect:!0,isVMDetection:!0,isAudioDetection:!1,wupStatisticsLogIntervalMs:3e4,heartBeatMessageInterval:5e3,resetSessionApiThreshold:2e4,wupMessageRequestTimeout:5e3,logMessageRequestTimeout:5e3,slaveChannelHandshakeTimeout:6e4,slaveAliveMessageInterval:100,forceDynamicDataWupDispatchSettings:!0,dataWupDispatchRateSettings:Ee.defaultDynamicWupDispatchRateConfiguration,logWupDispatchRateSettings:{type:"constant",initialRateValueMs:2500},serverCommunicationSettings:{queueLoadThreshold:100},collectKeyRegionValue:!1,isMutationObserver:!0,collectCustomElementAttribute:!0,shouldMaskClickEventValueField:!0,isCaptureKeyEvents:!1,locationEventsTimeoutMsec:1e4,isMotionAroundTouchEnabled:!0,motionPaddingAroundTouchMSec:3e3,isMotionOnSessionStart:!0,motionPaddingOnSessionStartMSec:2e4,keyEventsMaskSpecialChars:!1,collectSelectElementBlurAndFocusEvents:!1,enableUnmaskedValues:!1,allowedUnmaskedValuesList:[],wupMessageNumToRetry:5,wupMessageRetryInterval:1e3,wupIncrementalGrowthBetweenFailures:3500,wupMaxIntervalBetweenFailures:16e3,logMessageNumToRetry:5,logMessageRetryInterval:1e3,logIncrementalGrowthBetweenFailures:3500,logMaxIntervalBetweenFailures:16e3,cdsNumExpirationTime:60,enableCoordinatesMasking:!1,acknowledgeDataDispatchingRate:3e3},this.loadConfigurations(this.configDefault)}return function ConfigurationRepository_createClass(e,t,n){t&&ConfigurationRepository_defineProperties(e.prototype,t),n&&ConfigurationRepository_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ConfigurationRepository,[{key:"isConfigurationUpdatedFromServer",value:function isConfigurationUpdatedFromServer(){return!this._isDefaultConfiguration}},{key:"loadConfigurations",value:function loadConfigurations(r){var o=this;r&&(this._isDefaultConfiguration=r===this.configDefault,Object.keys(r).forEach(function(e){var t,n=r[e];!o._requireParseFields.has(e)||(t=o._tryParseConfigurationValue(n))&&(n=t),o._configurationList[e]=n}))}},{key:"get",value:function get(e){return this._configurationList[e]}},{key:"set",value:function set(e,t){this._configurationList[e]=t}},{key:"getAll",value:function getAll(){return this._configurationList}},{key:"_tryParseConfigurationValue",value:function _tryParseConfigurationValue(e){if("string"!=typeof e)return null;try{return JSON.parse(e)}catch(e){}return null}}]),ConfigurationRepository}(),we="changeContextCommand";function ContextMgr_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oe=function(){function ContextMgr(e,t,n,r){!function ContextMgr_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ContextMgr),this._utils=e,this._storageUtilsWrapper=r,this._contextSiteMapper=t,this.contextName="",this.referrer="",this.historyLen=-1,this.onContextChange=new L,this._contextSiteMapper.updateObserver(this.onSiteMapperMatch.bind(this)),this._workerComm=n,this._contextIdKey="cdContextId"}return function ContextMgr_createClass(e,t,n){t&&ContextMgr_defineProperties(e.prototype,t),n&&ContextMgr_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ContextMgr,[{key:"contextData",value:function contextData(){return{contextId:this.contextId,url:this.url,name:this.contextName,referrer:this.referrer,hLength:this.historyLen,timestamp:this.timestamp}}},{key:"setContext",value:function setContext(e){this.contextName=e.name,this._genContext(),this.url=e.url,this.referrer=e.referrer,this.historyLen=e.hLength,this.timestamp=e.timestamp,this._publishContext()}},{key:"changeContext",value:function changeContext(e){e?e!==this.contextName?(this.contextName=e,this._updateContext(),this._publishContext(),M.info("Context changed to ".concat(e))):M.warn("Received context ".concat(e," but this is already the current context. Aborting operation.")):M.error("Received an invalid context name ".concat(e,". Aborting context change operation"))}},{key:"onSiteMapperMatch",value:function onSiteMapperMatch(e){e.contextName!==this.contextName&&this.changeContext(e.contextName)}},{key:"_updateContext",value:function _updateContext(){this._genContext(),this.url=this._utils.getDocUrl(),this.referrer=this._utils.clearTextFromNumbers(document.referrer),this.historyLen=window.history.length,this.timestamp=this._utils.dateNow()}},{key:"_genContext",value:function _genContext(){this.contextId=this._storageUtilsWrapper.getCookie(this._contextIdKey),this.contextId&&!isNaN(this.contextId)||(this.contextId=this._storageUtilsWrapper.getFromLocalStorage(this._contextIdKey),this.contextId&&!isNaN(this.contextId)||(this.contextId=0)),this.contextId=parseInt(this.contextId);var e=this.contextId+1;this._storageUtilsWrapper.saveToLocalStorage(this._contextIdKey,e)||M.error("Failed saving contextId ".concat(this.contextId," to local storage.")),this._storageUtilsWrapper.setCookie(this._contextIdKey,e.toString())||M.error("Failed saving contextId ".concat(this.contextId," to cookie."))}},{key:"_publishContext",value:function _publishContext(){var e={contextName:this.contextName};this._workerComm.sendAsync(we,e),this.onContextChange.publish(this.contextData())}},{key:"initContextHandling",value:function initContextHandling(){this._contextSiteMapper.initTracking()}},{key:"clearContextHandling",value:function clearContextHandling(){this._contextSiteMapper.stopTracking()}},{key:"onConfigUpdate",value:function onConfigUpdate(e){this._contextSiteMapper.onConfigUpdate(e)}},{key:"onSessionReset",value:function onSessionReset(){this._publishContext()}}]),ContextMgr}();function MessageEventHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Se=function(){function MessageEventHandler(e,t,n,r){!function MessageEventHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MessageEventHandler),this._channelPort=null,this._slaveBuffer=t,this._configurationRepository=e,this._eventAggregator=n,this._keepAliveIntervalID=null,this._acknowledgeMessageEventsHandler=r,this._isRecivedIsChannelSupportsAckMessage=!1,this._isHandshakeCompleted=!1}return function MessageEventHandler_createClass(e,t,n){t&&MessageEventHandler_defineProperties(e.prototype,t),n&&MessageEventHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MessageEventHandler,[{key:"subscribeToMessageEvents",value:function subscribeToMessageEvents(t,n){var r=this;setTimeout(function(){r._isRecivedIsChannelSupportsAckMessage||r._slaveBuffer.clearBuffer.call(r._slaveBuffer)},this._configurationRepository.get(T.slaveChannelHandshakeTimeout)),this._eventAggregator.addEventListener(window,"message",function(e){r._isChannelMessage(e)?r._handleChannelMessage(e,t):r._handleWindowPostMessage(e,n)}),this._eventAggregator.addEventListener(window,"beforeunload",function(){r._sendToChannel({msgType:w}),r._acknowledgeMessageEventsHandler.handleBeforeUnloadEvent(r._postMessageToChannel.bind(r),r.portIsOpen.bind(r))})}},{key:"sendToParent",value:function sendToParent(e){window.parent.postMessage(e,"*"),this._sendToChannel(e)}},{key:"_handleWindowPostMessage",value:function _handleWindowPostMessage(e,t){e.data&&e.data.isNative&&e.data.msgType&&e.data.msgType===g&&this._slaveBuffer.postBufferedMessagesToParent(),(e.source!==window||e.data&&e.data.isNative)&&t(e,e.data.msgType)}},{key:"_handleChannelMessage",value:function _handleChannelMessage(e,t){this._channelPort&&this._channelPort.close(),this._keepAliveIntervalID&&clearInterval(this._keepAliveIntervalID),this._channelPort=e.ports[0],this._setPortEventHandlers(t),this._postMessageToChannel({msgType:O}),this._postMessageToChannel({msgType:m}),this._postMessageToChannel({msgType:k}),this._keepAliveIntervalID=setInterval(this._postSlaveAliveMessage,this._configurationRepository.get(T.slaveAliveMessageInterval),this)}},{key:"_postSlaveAliveMessage",value:function _postSlaveAliveMessage(e){e._postMessageToChannel({msgType:k})}},{key:"_setPortEventHandlers",value:function _setPortEventHandlers(e){this._channelPort.onmessage=this._portMessageHandler(e),this._channelPort.onmessageerror=function(e){log.error("port error",e.toString())}}},{key:"_isChannelMessage",value:function _isChannelMessage(e){return void 0!==e.ports&&Array.isArray(e.ports)&&0<e.ports.length&&e.data===S}},{key:"_portMessageHandler",value:function _portMessageHandler(r){var o=this;return function(e){var t,n;void 0!==e.ports&&Array.isArray(e.ports)&&((t=JSON.parse(e.data)).msgType===F&&(o._isRecivedIsChannelSupportsAckMessage=!0,o._configurationRepository.set(T.isChannelSupportsAckMessageLogic,!0)),t.msgType===g&&(n=o._isEnableAckMessageLogic.call(o),r(t),e=o._postMessageToChannel.bind(o),n?o._acknowledgeMessageEventsHandler.enableAcknowledgeMessageEvents(o._postMessageToChannel.bind(o),o.portIsOpen.bind(o)):(o._configurationRepository.set(T.enableAcknowledgeMessageEvents,!1),o._slaveBuffer.sendBufferedMessagesToChannel(e)),o._isHandshakeCompleted=!0),t.msgType===B&&o._acknowledgeMessageEventsHandler.removeAcknowledgedMessage(t.msgId))}}},{key:"_isEnableAckMessageLogic",value:function _isEnableAckMessageLogic(){return!!this._isRecivedIsChannelSupportsAckMessage&&!!this._configurationRepository.get(T.enableAcknowledgeMessageEvents)}},{key:"_sendToChannel",value:function _sendToChannel(e){!this.portIsOpen()||!this._isHandshakeCompleted||this._isEnableAckMessageLogic()?this._slaveBuffer.addToBuffer(e):this._postMessageToChannel(e)}},{key:"portIsOpen",value:function portIsOpen(){return null!==this._channelPort&&void 0!==this._channelPort}},{key:"_postMessageToChannel",value:function _postMessageToChannel(e){void 0===e.data&&(e.data={}),this._channelPort.postMessage(JSON.stringify(e))}}]),MessageEventHandler}();function EventAggregator_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=!1;!function(){try{var e=Object.defineProperty({},"passive",{get:function get(){ke=!0}});window.addEventListener("test",null,e)}catch(e){}}();var Be=function(){function EventAggregator(){!function EventAggregator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventAggregator)}return function EventAggregator_createClass(e,t,n){t&&EventAggregator_defineProperties(e.prototype,t),n&&EventAggregator_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(EventAggregator,null,[{key:"addEventListener",value:function addEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=5<arguments.length&&void 0!==arguments[5]&&arguments[5];ke?e.addEventListener(t,n,{capture:r,passive:o,once:i}):e.addEventListener?e.addEventListener(t,n,r):e.attachEvent("on"+t,n)}},{key:"removeEventListener",value:function removeEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent("on"+t,n)}}]),EventAggregator}();function SessionInfoService_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fe=function(){function SessionInfoService(){!function SessionInfoService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SessionInfoService),this.markStartTime()}return function SessionInfoService_createClass(e,t,n){t&&SessionInfoService_defineProperties(e.prototype,t),n&&SessionInfoService_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SessionInfoService,[{key:"markStartTime",value:function markStartTime(){this.startTime=f.dateNow()}},{key:"getStartTime",value:function getStartTime(){return this.startTime}}]),SessionInfoService}();function SensorGateKeeper_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var De=function(){function SensorGateKeeper(e,t){!function SensorGateKeeper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SensorGateKeeper),this.configurationRepository=t,this.sessionInfoService=e,this.isMotionOnSessionStart=this.configurationRepository.get(T.isMotionOnSessionStart),this.motionPaddingOnSessionStartMSec=this.configurationRepository.get(T.motionPaddingOnSessionStartMSec)}return function SensorGateKeeper_createClass(e,t,n){t&&SensorGateKeeper_defineProperties(e.prototype,t),n&&SensorGateKeeper_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SensorGateKeeper,[{key:"configure",value:function configure(){this.isMotionOnSessionStart=this.configurationRepository.get(T.isMotionOnSessionStart),this.motionPaddingOnSessionStartMSec=this.configurationRepository.get(T.motionPaddingOnSessionStartMSec),this.isMotionOnSessionStart&&M.info("Motion on session start is enabled, collecting motion events for ".concat(this.motionPaddingOnSessionStartMSec/1e3," seconds."))}},{key:"isOpen",value:function isOpen(){return this.isMotionOnSessionStart&&f.dateNow()-this.motionPaddingOnSessionStartMSec<this.sessionInfoService.getStartTime()}}]),SensorGateKeeper}();function CustomElementsOpenContext_typeof(e){return(CustomElementsOpenContext_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CustomElementsOpenContext_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CustomElementsOpenContext_setPrototypeOf(e,t){return(CustomElementsOpenContext_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function CustomElementsOpenContext_createSuper(n){var r=function CustomElementsOpenContext_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=CustomElementsOpenContext_getPrototypeOf(n);return function CustomElementsOpenContext_possibleConstructorReturn(e,t){{if(t&&("object"===CustomElementsOpenContext_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function CustomElementsOpenContext_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=CustomElementsOpenContext_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function CustomElementsOpenContext_getPrototypeOf(e){return(CustomElementsOpenContext_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te=function(){!function CustomElementsOpenContext_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CustomElementsOpenContext_setPrototypeOf(e,t)}(CustomElementsOpenContext,j);var e=CustomElementsOpenContext_createSuper(CustomElementsOpenContext);function CustomElementsOpenContext(){return function CustomElementsOpenContext_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomElementsOpenContext),e.apply(this,arguments)}return function CustomElementsOpenContext_createClass(e,t,n){t&&CustomElementsOpenContext_defineProperties(e.prototype,t),n&&CustomElementsOpenContext_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CustomElementsOpenContext,[{key:"getDocument",value:function getDocument(){return this.context.shadowRoot}}]),CustomElementsOpenContext}();function CustomElementsClosedContext_typeof(e){return(CustomElementsClosedContext_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CustomElementsClosedContext_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CustomElementsClosedContext_setPrototypeOf(e,t){return(CustomElementsClosedContext_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function CustomElementsClosedContext_createSuper(n){var r=function CustomElementsClosedContext_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=CustomElementsClosedContext_getPrototypeOf(n);return function CustomElementsClosedContext_possibleConstructorReturn(e,t){{if(t&&("object"===CustomElementsClosedContext_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function CustomElementsClosedContext_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=CustomElementsClosedContext_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function CustomElementsClosedContext_getPrototypeOf(e){return(CustomElementsClosedContext_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Me=function(){!function CustomElementsClosedContext_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CustomElementsClosedContext_setPrototypeOf(e,t)}(CustomElementsClosedContext,j);var e=CustomElementsClosedContext_createSuper(CustomElementsClosedContext);function CustomElementsClosedContext(){return function CustomElementsClosedContext_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomElementsClosedContext),e.apply(this,arguments)}return function CustomElementsClosedContext_createClass(e,t,n){t&&CustomElementsClosedContext_defineProperties(e.prototype,t),n&&CustomElementsClosedContext_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CustomElementsClosedContext,[{key:"getDocument",value:function getDocument(){return this.context}}]),CustomElementsClosedContext}();function BrowserContextMutationObserver_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var je=function(){function BrowserContextMutationObserver(e,t,n){!function BrowserContextMutationObserver_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserContextMutationObserver),this._elementsMutationObserverFactory=e,this._windowMutationObservers=t,this._messageBus=n,this._messageBus.subscribe(_.BrowserContextAdded,this._processNewContext.bind(this))}return function BrowserContextMutationObserver_createClass(e,t,n){t&&BrowserContextMutationObserver_defineProperties(e.prototype,t),n&&BrowserContextMutationObserver_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserContextMutationObserver,[{key:"_processNewContext",value:function _processNewContext(e){this.monitorWindow(e)}},{key:"monitorWindow",value:function monitorWindow(e){var t;this._windowMutationObservers.has(e)||((t=new this._elementsMutationObserverFactory(e,self.MutationObserver)).observe(e.getDocument()),t.nodesAdded.subscribe(this._nodesAddedMutationObserved.bind(this)),t.nodesRemoved.subscribe(this._nodesRemovedMutationObserved.bind(this)),this._windowMutationObservers.set(e,t))}},{key:"unMonitorWindow",value:function unMonitorWindow(e){var t=this._windowMutationObservers.get(e);t&&(t.nodesAdded.unsubscribe(this._nodesAddedMutationObserved.bind(this)),t.nodesRemoved.unsubscribe(this._nodesRemovedMutationObserved.bind(this)),t.disconnect()),this._windowMutationObservers.delete(e)}},{key:"_nodesAddedMutationObserved",value:function _nodesAddedMutationObserved(e){this._messageBus.publish(_.MutationAddedNodes,e)}},{key:"_nodesRemovedMutationObserved",value:function _nodesRemovedMutationObserved(e){this._messageBus.publish(_.MutationRemovedNodes,e)}}]),BrowserContextMutationObserver}();function CustomElementEventMessage_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CustomElementEventMessage_createClass(e,t,n){return t&&CustomElementEventMessage_defineProperties(e.prototype,t),n&&CustomElementEventMessage_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ie="added",xe="removed",Le=CustomElementEventMessage_createClass(function CustomElementEventMessage(e,t){!function CustomElementEventMessage_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomElementEventMessage),this.browserContext=e,this.message=t});function CustomElementsDetector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ae=function(){function CustomElementsDetector(e,t,n){!function CustomElementsDetector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomElementsDetector),this._domUtils=t,this._messageBus=n,this._loadedCustomElements=d(),this._windowMutationObservers=d(),this._messageBus.subscribe(_.MutationAddedNodes,this._processAddedNodes.bind(this)),this._messageBus.subscribe(_.MutationRemovedNodes,this._processRemovedNodes.bind(this)),this._messageBus.subscribe(_.CustomElementSubmitted,this._processSubmittedCustomElement.bind(this)),this._browserContextMutationObserver=new je(e,this._windowMutationObservers,this._messageBus)}return function CustomElementsDetector_createClass(e,t,n){t&&CustomElementsDetector_defineProperties(e.prototype,t),n&&CustomElementsDetector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CustomElementsDetector,[{key:"customElements",get:function get(){var n=[];return this._loadedCustomElements.forEach(function(e,t){n.push(t)}),n}},{key:"hasCustomElement",value:function hasCustomElement(e){return!!this._loadedCustomElements.has(e)}},{key:"addCustomElementToLoadedList",value:function addCustomElementToLoadedList(e,t){this._loadedCustomElements.set(e,t)}},{key:"start",value:function start(e){var t=this;this._browserContextMutationObserver.monitorWindow(e),this._findCustomElementsInBrowserContext(e.getDocument()).forEach(function(e){t._processNewElement(e)})}},{key:"stop",value:function stop(){this._windowMutationObservers.forEach(function(e){e.disconnect()})}},{key:"_processSubmittedCustomElement",value:function _processSubmittedCustomElement(e){this._loadedCustomElements.has(e)||this._addCustomElement(e,new Me(e),"closed")}},{key:"_processNewElement",value:function _processNewElement(e){this._loadedCustomElements.has(e)||(null!=e.shadowRoot?this._addCustomElement(e,new Te(e)):this._messageBus.publish(_.CustomElementInaccessible,e))}},{key:"_addCustomElement",value:function _addCustomElement(e,t){"open"===(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"open")&&this._browserContextMutationObserver.monitorWindow(t),this._loadedCustomElements.set(e,t),this._messageBus.publish(_.CustomElementDetectedEvent,new Le(t,Ie))}},{key:"_removeCustomElement",value:function _removeCustomElement(e){var t=this._loadedCustomElements.get(e);this._browserContextMutationObserver.unMonitorWindow(e.shadowRoot),this._loadedCustomElements.delete(e)&&this._messageBus.publish(_.CustomElementDetectedEvent,new Le(t,xe))}},{key:"_processAddedNodes",value:function _processAddedNodes(e){var t=this;this._findCustomElementsInBrowserContext(e.browserContext.getDocument()).forEach(function(e){t._processNewElement(e)})}},{key:"_processRemovedNodes",value:function _processRemovedNodes(e){for(var t=this,n=e.removedNodes,r=[],o=0;o<n.length;o++){var i,s=n[o];s.hasChildNodes()?0<(i=this._findCustomElementsInBrowserContext(s)).length&&(r=r.concat(i)):this._isCustomElement(s)&&s.shadowRoot&&r.push(s)}0!==r.length&&r.forEach(function(e){t._removeCustomElement(e)})}},{key:"_isCustomElement",value:function _isCustomElement(e){return"string"==typeof e.localName&&0<e.localName.indexOf("-")}},{key:"_findCustomElementsInBrowserContext",value:function _findCustomElementsInBrowserContext(e){var t=[],n=e.querySelectorAll("*");if(0===n.length)return t;for(var r=0;r<n.length;r++){var o,i=n[r];this._isCustomElement(i)&&(t.push(i),i.shadowRoot?(o=this._findCustomElementsInBrowserContext(i.shadowRoot),t=t.concat(o)):this._messageBus.publish(_.CustomElementInaccessible,i))}return t}}]),CustomElementsDetector}();function CustomElementDetectedEventHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ne=function(){function CustomElementDetectedEventHandler(e,t,n){!function CustomElementDetectedEventHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomElementDetectedEventHandler),this._browserContextsCache=e,this._messageBus=n,this._featureService=t,this._messageBus.subscribe(_.CustomElementDetectedEvent,this._handle.bind(this))}return function CustomElementDetectedEventHandler_createClass(e,t,n){t&&CustomElementDetectedEventHandler_defineProperties(e.prototype,t),n&&CustomElementDetectedEventHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CustomElementDetectedEventHandler,[{key:"_handle",value:function _handle(e){var t=e.browserContext,e=e.message;e===Ie?this._handleCustomElementAdded(t):e===xe&&this._handleCustomElementRemoved(t)}},{key:"_handleCustomElementAdded",value:function _handleCustomElementAdded(e){this._browserContextsCache.exists(e.Context)||this._browserContextsCache.addBrowserContext(e),this._featureService.runFeaturesOnBrowserContext(e)}},{key:"_handleCustomElementRemoved",value:function _handleCustomElementRemoved(e){this._featureService.stopFeaturesOnBrowserContextRemove(e),this._browserContextsCache.remove(e.Context)}}]),CustomElementDetectedEventHandler}(),Ue={Enter:13,ArrowUp:38,ArrowDown:40,ArrowLeft:37,ArrowRight:39,Escape:27," ":32,Control:17,Alt:18,Tab:9,Shift:16,CapsLock:20,Meta:91,Backspace:8,Home:36,End:35,Insert:45,Delete:46,PageUp:33,PageDown:34,PrintScreen:44,NumLock:144,Clear:144,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,10:121,F11:122,F12:123};function MaskingService_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var He=function(){function MaskingService(e){!function MaskingService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MaskingService),this._configurationRepository=e,this._attributesToMask=!!this._configurationRepository.get(T.maskElementsAttributes)&&this._maskArrayValues(this._configurationRepository.get(T.maskElementsAttributes)),this._attributesToMask&&this._configurationRepository.set(T.maskElementsAttributes,this._attributesToMask),this.specailConfigurationChars=h([",","."," ","@",";",":","-","+","$"]),this.specailChars=h(["_","!","%","^","&","*","#","(",")","=","{","}","[","]","","\\","|","/","?",">","<","~",'"',"",""]),this.kanjiNumbers=h(["","","","","","","","","","","","","","",""]),this.chineseCapitalNumbers=h(["","","","","","","","","","","","","","","","",""]),this.suzhouNumbers=h(["","","","","","","","","","","","",""]),this.maskedCodeMapping={original:function original(e,t,n){return{code:e,charCode:t,key:n}},numpadKey:function numpadKey(e){return{code:"Numpad",charCode:96,key:e}},letter:function letter(){return{code:"Key",charCode:65,key:"A"}},digit:function digit(){return{code:"Digit",charCode:49,key:"1"}},specialChar:function specialChar(){return{code:"SpecialChar",charCode:42,key:"*"}},other:function other(){return{code:"Other",charCode:66,key:"B"}}}}return function MaskingService_createClass(e,t,n){t&&MaskingService_defineProperties(e.prototype,t),n&&MaskingService_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MaskingService,[{key:"maskKey",value:function maskKey(e,t){if(Ue[e]){var n=Ue[e];return this.maskedCodeMapping.original(t,n,e)}return this._isANumberOrDigit(e)?t.includes("Numpad")?this.maskedCodeMapping.numpadKey("1"):this.maskedCodeMapping.digit():this._isALetter(e)?this.maskedCodeMapping.letter():!this._configurationRepository.get(T.keyEventsMaskSpecialChars)&&this.specailConfigurationChars.has(e)?this.maskedCodeMapping.original(t,e.charCodeAt(0),e):this.specailChars.has(e)||this.specailConfigurationChars.has(e)?t.includes("Numpad")?this.maskedCodeMapping.numpadKey("*"):this.maskedCodeMapping.specialChar():this.maskedCodeMapping.other()}},{key:"getKeyFromLegacyProperties",value:function getKeyFromLegacyProperties(e){e=e.keyCode||e.which;return 0===e||void 0===e?"":String.fromCharCode(e)}},{key:"_isALetter",value:function _isALetter(e){return/^[a-zA-Z]$/.test(e)||this._isJapaneseOrChineseLetter(e)||this._isHebrewLetter(e)}},{key:"_isANumberOrDigit",value:function _isANumberOrDigit(e){return/[0-9]/.test(e)||this.kanjiNumbers.has(e)||this.chineseCapitalNumbers.has(e)||this.suzhouNumbers.has(e)}},{key:"_isJapaneseOrChineseLetter",value:function _isJapaneseOrChineseLetter(e){return this._isCJKUnifiedIdeographs(e)||this._isCJKUnifiedIdeographsExtenA(e)||this._isCJKUnifiedIdeographsExtenB(e)||this._isSmallKatakanaLetter(e)}},{key:"_isCJKUnifiedIdeographsExtenB",value:function _isCJKUnifiedIdeographsExtenB(e){return/[\u3041-\u309F]/.test(e)}},{key:"_isSmallKatakanaLetter",value:function _isSmallKatakanaLetter(e){return/[\u30A1-\u30FF]/.test(e)}},{key:"_isCJKUnifiedIdeographsExtenA",value:function _isCJKUnifiedIdeographsExtenA(e){return/[\u3400-\u4DB5]/.test(e)}},{key:"_isCJKUnifiedIdeographs",value:function _isCJKUnifiedIdeographs(e){return/[\u4E00-\u9FCC]/.test(e)}},{key:"_isHebrewLetter",value:function _isHebrewLetter(e){return/[\u05D0-\u05EA]/.test(e)}},{key:"maskText",value:function maskText(e){if(f.isUndefinedNull(e))return"";e=e.replace(/[\d]/g,"1").replace(/[\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D\u5341\u767E\u5343\u4E07]/g,"1").replace(/[\u96F6\u58F9\u8CB3\u8D30\u53C3\u53C1\u8086\u4F0D\u9678\u9646\u67D2\u634C\u7396\u62FE\u4F70\u4EDF\u842C\u3021-\u3029\u3038\u3039\u303A]/g,"1").replace(/[a-zA-Z]/g,"a").replace(/[\u05D0-\u05EA]/g,"a").replace(/[\u4E00-\u9FCC\u3400-\u4DB5\u3041-\u309F\u30A1-\u30FF]/g,"a").replace(/[\\_!%^&*#()={}\[\]|/?><~"`']/g,"*");return this._configurationRepository.get(T.keyEventsMaskSpecialChars)?e.replace(/[,.@;:+$ -]/g,"*").replace(/[^a1*]/g,"B"):e.replace(/[^a1*,.@;:+$ -]/g,"B")}},{key:"_maskArrayValues",value:function _maskArrayValues(e){var t=this;if(!Array.isArray(e))return this._configurationRepository.set(T.maskElementsAttributes,[]),M.warn("collectionSetting- Invalid array of attributes to mask"),!1;var n={};return e.forEach(function(e){n[e]=t.maskText(e)}),n}}]),MaskingService}();function SlaveBuffer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(){function SlaveBuffer(e,t){!function SlaveBuffer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveBuffer),this._enableBuffering=!0,this._preHandshakeBuffer=[],this._configurationRepository=e,this._cdUtils=t}return function SlaveBuffer_createClass(e,t,n){t&&SlaveBuffer_defineProperties(e.prototype,t),n&&SlaveBuffer_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveBuffer,[{key:"addToBuffer",value:function addToBuffer(e){this._configurationRepository.get(T.enableAcknowledgeMessageEvents)&&(e=this._addAckIdToEvent(e)),this._enableBuffering&&this._preHandshakeBuffer.push(e)}},{key:"_addAckIdToEvent",value:function _addAckIdToEvent(e){var t=this._cdUtils.generateUUID();return e.msgId=JSON.stringify(t),{msgId:t,msg:e}}},{key:"sendBufferedMessagesToChannel",value:function sendBufferedMessagesToChannel(t){this._preHandshakeBuffer.forEach(function(e){t(e)}),this.clearBuffer()}},{key:"sendBufferedAckMessagesToChannel",value:function sendBufferedAckMessagesToChannel(t){this._preHandshakeBuffer.length&&this._preHandshakeBuffer.forEach(function(e){t(e.msg)})}},{key:"postBufferedMessagesToParent",value:function postBufferedMessagesToParent(){this._preHandshakeBuffer.forEach(function(e){window.parent.postMessage(e,"*")}),this.clearBuffer()}},{key:"clearBuffer",value:function clearBuffer(){this._preHandshakeBuffer&&0<this._preHandshakeBuffer.length&&(this._preHandshakeBuffer=[],this._enableBuffering=!1)}},{key:"removeAcknowledgedMessage",value:function removeAcknowledgedMessage(e){this._preHandshakeBuffer.length?this._removeMessageIdFromBuffer(e):M.info("received ack message request but pre handshake queue is empty")}},{key:"_removeMessageIdFromBuffer",value:function _removeMessageIdFromBuffer(t){this._preHandshakeBuffer=this._preHandshakeBuffer.filter(function(e){return e.msgId!==t})}},{key:"isEmpty",value:function isEmpty(){return 0===this._preHandshakeBuffer.length}}]),SlaveBuffer}();function LogDataQ_typeof(e){return(LogDataQ_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LogDataQ_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LogDataQ_setPrototypeOf(e,t){return(LogDataQ_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LogDataQ_createSuper(n){var r=function LogDataQ_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LogDataQ_getPrototypeOf(n);return function LogDataQ_possibleConstructorReturn(e,t){{if(t&&("object"===LogDataQ_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function LogDataQ_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=LogDataQ_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LogDataQ_getPrototypeOf(e){return(LogDataQ_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=function(){!function LogDataQ_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LogDataQ_setPrototypeOf(e,t)}(LogDataQ,_e);var e=LogDataQ_createSuper(LogDataQ);function LogDataQ(){return function LogDataQ_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LogDataQ),e.apply(this,arguments)}return function LogDataQ_createClass(e,t,n){t&&LogDataQ_defineProperties(e.prototype,t),n&&LogDataQ_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LogDataQ,[{key:"add",value:function add(e){this.addToQueue(e.eventName,e.data)}},{key:"filterOutByLogLevel",value:function filterOutByLogLevel(t){this.filterOut(function(e){return e.data.level>=t})}}]),LogDataQ}();function LogAggregator_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=function(){function LogAggregator(){!function LogAggregator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LogAggregator),this.reset()}return function LogAggregator_createClass(e,t,n){t&&LogAggregator_defineProperties(e.prototype,t),n&&LogAggregator_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LogAggregator,[{key:"setLogLevel",value:function setLogLevel(e){this._logLevel=e}},{key:"add",value:function add(e){e=e.data;if(!e)throw new Error("Unable to add log message. Missing data field");(!e.level||e.level>=this._logLevel)&&this._Q.push(e)}},{key:"take",value:function take(){var e=this._Q;return this.reset(),e}},{key:"reset",value:function reset(){this._Q=[],this.setLogLevel(D.INFO)}},{key:"isEmpty",value:function isEmpty(){return 0===this._Q.length}},{key:"filterOutByLogLevel",value:function filterOutByLogLevel(r){this._Q=this._Q.filter(function(e,t,n){return e.level>=r})}}]),LogAggregator}();function LogBridge_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(){function LogBridge(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";!function LogBridge_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LogBridge),this.sn=0,this.url=t,this.logAggregator=e,this.msgPrefix=n}return function LogBridge_createClass(e,t,n){t&&LogBridge_defineProperties(e.prototype,t),n&&LogBridge_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LogBridge,[{key:"log",value:function log(e,t){this.logAggregator.add({eventName:"log",data:{msg:this.msgPrefix+e,url:this.url,level:t,sn:this.sn++}})}},{key:"setLogLevel",value:function setLogLevel(e){this.logAggregator instanceof Ke&&this.logAggregator.setLogLevel(e)}},{key:"clearLogEntriesByLogLevel",value:function clearLogEntriesByLogLevel(e){this.logAggregator.filterOutByLogLevel(e)}}]),LogBridge}();function StorageUtilsWrapper_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function StorageUtilsWrapper(e,t){!function StorageUtilsWrapper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StorageUtilsWrapper),this.isSecureSameSite=t.get(T.enableSameSiteNoneAndSecureCookies),this._utils=e}return function StorageUtilsWrapper_createClass(e,t,n){t&&StorageUtilsWrapper_defineProperties(e.prototype,t),n&&StorageUtilsWrapper_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StorageUtilsWrapper,[{key:"getCookie",value:function getCookie(e){return this._utils.StorageUtils.getCookie(e)}},{key:"setCookie",value:function setCookie(e,t,n){return this._utils.StorageUtils.setCookie(e,t,n,this.isSecureSameSite)}},{key:"setExpirationInCookie",value:function setExpirationInCookie(e,t){return this._utils.StorageUtils.setExpirationInCookie(e,t)}},{key:"getFromLocalStorage",value:function getFromLocalStorage(e){return this._utils.StorageUtils.getFromLocalStorage(e)}},{key:"saveToLocalStorage",value:function saveToLocalStorage(e,t,n){return this._utils.StorageUtils.saveToLocalStorage(e,t,n)}},{key:"setExpirationInLocalStorage",value:function setExpirationInLocalStorage(e,t){return this._utils.StorageUtils.setExpirationInLocalStorage(e,t)}},{key:"removeFromLocalStorage",value:function removeFromLocalStorage(e){return this._utils.StorageUtils.removeFromLocalStorage(e)}},{key:"removeCookie",value:function removeCookie(e){return this._utils.StorageUtils.removeCookie(e)}}]),StorageUtilsWrapper}();function StaticContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qe=function(){function StaticContract(){!function StaticContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StaticContract)}return function StaticContract_createClass(e,t,n){t&&StaticContract_defineProperties(e.prototype,t),n&&StaticContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StaticContract,[{key:"validateParams",value:function validateParams(){throw new Error("_validateParams should be overridden")}},{key:"buildQueueMessage",value:function buildQueueMessage(){throw new Error("buildQueueMessage should be overridden")}},{key:"validateMessage",value:function validateMessage(){throw new Error("_validateMessage should be overridden")}},{key:"getName",value:function getName(){throw new Error("_getName should be overridden")}}]),StaticContract}();function VersionClientBrowserPropsContract_typeof(e){return(VersionClientBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VersionClientBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VersionClientBrowserPropsContract_setPrototypeOf(e,t){return(VersionClientBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function VersionClientBrowserPropsContract_createSuper(n){var r=function VersionClientBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=VersionClientBrowserPropsContract_getPrototypeOf(n);return function VersionClientBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===VersionClientBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function VersionClientBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=VersionClientBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function VersionClientBrowserPropsContract_getPrototypeOf(e){return(VersionClientBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Je=function(){!function VersionClientBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VersionClientBrowserPropsContract_setPrototypeOf(e,t)}(VersionClientBrowserPropsContract,qe);var n=VersionClientBrowserPropsContract_createSuper(VersionClientBrowserPropsContract);function VersionClientBrowserPropsContract(e){var t;return function VersionClientBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VersionClientBrowserPropsContract),(t=n.call(this)).validateParams(e),t.scriptVersion=e,t}return function VersionClientBrowserPropsContract_createClass(e,t,n){t&&VersionClientBrowserPropsContract_defineProperties(e.prototype,t),n&&VersionClientBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(VersionClientBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in VersionClient, BrowserProps parameters. scriptVersion : {expected: string, received: ".concat(VersionClientBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.scriptVersion];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("version_client, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"version_client"}}]),VersionClientBrowserPropsContract}();function DeviceSourceBrowserPropsContract_typeof(e){return(DeviceSourceBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DeviceSourceBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DeviceSourceBrowserPropsContract_setPrototypeOf(e,t){return(DeviceSourceBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DeviceSourceBrowserPropsContract_createSuper(n){var r=function DeviceSourceBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=DeviceSourceBrowserPropsContract_getPrototypeOf(n);return function DeviceSourceBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===DeviceSourceBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function DeviceSourceBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=DeviceSourceBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function DeviceSourceBrowserPropsContract_getPrototypeOf(e){return(DeviceSourceBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ze=function(){!function DeviceSourceBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DeviceSourceBrowserPropsContract_setPrototypeOf(e,t)}(DeviceSourceBrowserPropsContract,qe);var n=DeviceSourceBrowserPropsContract_createSuper(DeviceSourceBrowserPropsContract);function DeviceSourceBrowserPropsContract(e){var t;return function DeviceSourceBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceSourceBrowserPropsContract),(t=n.call(this)).validateParams(e),t.source=e,t}return function DeviceSourceBrowserPropsContract_createClass(e,t,n){t&&DeviceSourceBrowserPropsContract_defineProperties(e.prototype,t),n&&DeviceSourceBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DeviceSourceBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in DeviceSource, BrowserProps parameters. source : {expected: string, received: ".concat(DeviceSourceBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.source];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("device_source, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"device_source"}}]),DeviceSourceBrowserPropsContract}();function SlaveBrowserProps_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe=function(){function SlaveBrowserProps(e,t){!function SlaveBrowserProps_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveBrowserProps),this._dataQ=e,this._utils=t}return function SlaveBrowserProps_createClass(e,t,n){t&&SlaveBrowserProps_defineProperties(e.prototype,t),n&&SlaveBrowserProps_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveBrowserProps,[{key:"startFeature",value:function startFeature(){var e=new Je(this._utils.scriptVersion).buildQueueMessage();e[0]="slave_".concat(e[0]),this._dataQ.addToQueue("static_fields",e,!1);e=new Ze("js").buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1),M.info("Slave version is ".concat(this._utils.scriptVersion))}}]),SlaveBrowserProps}();function AcknowledgeMessageEventsHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ye=function(){function AcknowledgeMessageEventsHandler(e,t,n){!function AcknowledgeMessageEventsHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AcknowledgeMessageEventsHandler),this._slaveBuffer=e,this._configurationRepository=t,this._acknowledgeDataDispatcher=n}return function AcknowledgeMessageEventsHandler_createClass(e,t,n){t&&AcknowledgeMessageEventsHandler_defineProperties(e.prototype,t),n&&AcknowledgeMessageEventsHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(AcknowledgeMessageEventsHandler,[{key:"enableAcknowledgeMessageEvents",value:function enableAcknowledgeMessageEvents(e,t){this._acknowledgeDataDispatcher.start(e,t)}},{key:"removeAcknowledgedMessage",value:function removeAcknowledgedMessage(e){this._slaveBuffer.removeAcknowledgedMessage(e)}},{key:"handleBeforeUnloadEvent",value:function handleBeforeUnloadEvent(e,t){this._configurationRepository.get(T.enableAcknowledgeMessageEvents)&&this._acknowledgeDataDispatcher.beforeUnloadEvent(e,t)}}]),AcknowledgeMessageEventsHandler}();function AcknowledgeDataDispatcher_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=function(){function AcknowledgeDataDispatcher(e,t){!function AcknowledgeDataDispatcher_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AcknowledgeDataDispatcher),this._configurationRepository=e,this._slaveBuffer=t,this._ackDispatcherIntervalId=null}return function AcknowledgeDataDispatcher_createClass(e,t,n){t&&AcknowledgeDataDispatcher_defineProperties(e.prototype,t),n&&AcknowledgeDataDispatcher_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(AcknowledgeDataDispatcher,[{key:"start",value:function start(e,t){var n=this._configurationRepository.get(T.acknowledgeDataDispatchingRate);this._ackDispatcherIntervalId||0===n||(this._ackDispatcherIntervalId=setInterval(this._dataToChannelManager.bind(this,e,t),n))}},{key:"_dataToChannelManager",value:function _dataToChannelManager(e,t){this._configurationRepository.get(T.isChannelSupportsAckMessageLogic)&&t()&&this._sendToChannel(e)}},{key:"_sendToChannel",value:function _sendToChannel(e){this._slaveBuffer.sendBufferedAckMessagesToChannel(e)}},{key:"clearInterval",value:function(e){function clearInterval(){return e.apply(this,arguments)}return clearInterval.toString=function(){return e.toString()},clearInterval}(function(){this._ackDispatcherIntervalId&&clearInterval(this._ackDispatcherIntervalId)})},{key:"beforeUnloadEvent",value:function beforeUnloadEvent(e,t){this.clearInterval(),!this._slaveBuffer.isEmpty()&&t()&&this._sendToChannel(e)}}]),AcknowledgeDataDispatcher}();function SlaveStartupConfigurationLoader_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var et=function(){function SlaveStartupConfigurationLoader(e,t){!function SlaveStartupConfigurationLoader_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveStartupConfigurationLoader),this._configurationRepository=e,this._startUpConfigurations=t}return function SlaveStartupConfigurationLoader_createClass(e,t,n){t&&SlaveStartupConfigurationLoader_defineProperties(e.prototype,t),n&&SlaveStartupConfigurationLoader_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveStartupConfigurationLoader,[{key:"loadStartUpConfigurations",value:function loadStartUpConfigurations(){this._setConfigurationOrDefault(T.enableAcknowledgeMessageEvents,this._startUpConfigurations.getEnableBufferAckMessage(),!1)}},{key:"_setConfigurationOrDefault",value:function _setConfigurationOrDefault(e,t,n){f.isUndefinedNull(t)?this._configurationRepository.set(e,n):this._configurationRepository.set(e,t)}}]),SlaveStartupConfigurationLoader}();function SlaveSystemLoader_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tt=function(){function SlaveSystemLoader(){!function SlaveSystemLoader_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveSystemLoader),this._eventHandlers=[]}return function SlaveSystemLoader_createClass(e,t,n){t&&SlaveSystemLoader_defineProperties(e.prototype,t),n&&SlaveSystemLoader_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveSystemLoader,[{key:"loadSystem",value:function loadSystem(e,t){var n=this;!function clearFeaturesInList(t){t&&Object.keys(t).forEach(function(e){t[e].runInSlave||delete t[e]})}(e.list);var r=t.getEnableCustomElementDetector();this._configurationRepository=new Pe,new et(this._configurationRepository,t).loadStartUpConfigurations();var o=new We(this._configurationRepository,f),i=new $e(this._configurationRepository,o),t=new Ye(o,this._configurationRepository,i),i=new Se(this._configurationRepository,o,Be,t);this._parentCommunicator=new Ce(i);o=new ze(Z,this._parentCommunicator,null,null,"logPerfSlave"),t=new Ge(f,this._configurationRepository),i=new ge(self.MutationObserver,f,Z,"contextConfiguration",null,!0,400);this._contextMgr=new Oe(f,i,this._parentCommunicator,t);i=new Ve(o,this._contextMgr.url,"SLAVE: "),t=new R(i);M.setLogger(t),this._msgBus=new v,this._parentCommunicator.addMessageListener(g,function(e){n._configurationRepository.loadConfigurations(e),n._msgBus.publish(_.ConfigurationLoadedEvent,n._configurationRepository)}),this._sessionInfoService=new Fe,this._sensorGateKeeper=new De(this._sessionInfoService,this._configurationRepository),this._dataQ=new _e(Z,this._parentCommunicator,this._contextMgr,null,"dataFromSlave"),this._sensorDataQ=new ve(this._configurationRepository,this._dataQ,this._msgBus,f,this._sensorGateKeeper),this._elementsUtils=new ne(this._configurationRepository,f,this._dataQ,this._contextMgr);o=new z,i=new J(this._configurationRepository,Z,f);this._frameHandler=i.create(),this._featureService=new I(e,this._frameHandler,this._configurationRepository,Z,f,o),this._slaveBrowserProps=new Xe(this._dataQ,f),this._pauseResumeMgr=new Y(this._featureService,this._configurationRepository,this._dataQ),this._parentCommunicator.addMessageListener(b,this._pauseResumeMgr.onStateChange.bind(this._pauseResumeMgr)),this._scriptsRepository=new $(f),this._sameChar=new le,this._maskingService=new He(this._configurationRepository),this._featureBuilder=new x(e,this._configurationRepository,f,this._elementsUtils,self.MutationObserver,this._dataQ,null,null,null,this._sensorDataQ,this._msgBus,this._scriptsRepository,this._sameChar,this._maskingService),this._contextMgr.onContextChange.subscribe(this._featureService.runPerContextFeatures.bind(this._featureService)),this._contextMgr.onContextChange.subscribe(this._parentCommunicator.notifyContextChange.bind(this._parentCommunicator)),this._eventHandlers.push(new me(this._msgBus,this._featureService,this._dataQ,this._pauseResumeMgr,t,this._contextMgr,this._sensorGateKeeper)),this._contextMgr.changeContext("slave_cd_auto"),r&&new Ae(G,f,this._msgBus).start(new j(window.self)),this._eventHandlers.push(new Ne(o,this._featureService,this._msgBus))}},{key:"getConfigurationRepository",value:function getConfigurationRepository(){return this._configurationRepository}},{key:"getFeatureBuilder",value:function getFeatureBuilder(){return this._featureBuilder}},{key:"getFeatureService",value:function getFeatureService(){return this._featureService}},{key:"getContextMgr",value:function getContextMgr(){return this._contextMgr}},{key:"getParentCommunicator",value:function getParentCommunicator(){return this._parentCommunicator}},{key:"getSlaveBrowserProps",value:function getSlaveBrowserProps(){return this._slaveBrowserProps}}]),SlaveSystemLoader}();function ElementEventCollector_typeof(e){return(ElementEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){ElementEventCollector_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ElementEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ElementEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ElementEventCollector_createClass(e,t,n){return t&&ElementEventCollector_defineProperties(e.prototype,t),n&&ElementEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ElementEventCollector_setPrototypeOf(e,t){return(ElementEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ElementEventCollector_createSuper(n){var r=function ElementEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ElementEventCollector_getPrototypeOf(n);return function ElementEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===ElementEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ElementEventCollector_assertThisInitialized(e)}(this,r?(e=ElementEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ElementEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ElementEventCollector_getPrototypeOf(e){return(ElementEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ElementEventCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt={configKey:"isElementsEvent",isDefault:!0,shouldRunPerContext:!0,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInUns:!1,runInSlave:!0,isRunning:!1,instance:null},rt={input:0,initial:1,focus:2,blur:3,change:4,click:5,submit:6},ot=["eventSequence","timestamp","eventType","isTrusted","elementHash","length","elementValues","selected","hashedValue","relativeTime"],it=function(){!function ElementEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ElementEventCollector_setPrototypeOf(e,t)}(ElementEventCollector,te);var t=ElementEventCollector_createSuper(ElementEventCollector);function ElementEventCollector(e){var r;return ElementEventCollector_classCallCheck(this,ElementEventCollector),ElementEventCollector_defineProperty(ElementEventCollector_assertThisInitialized(r=t.call(this)),"mutationMessageHandler",function(e){e.browserContext&&(r._inputEvents.addOnLoadInputData(e.browserContext,!0),r._inputEvents.bind(e.browserContext),r._clickEvents.bind(e.browserContext),r._selectElementEvents.bind(e.browserContext),r._formEvents.bind(e.browserContext))}),ElementEventCollector_defineProperty(ElementEventCollector_assertThisInitialized(r),"startFeature",function(e){r._inputEvents.addOnLoadInputData(e,!1),r._inputEvents.bind(e),r._clickEvents.bind(e),r._selectElementEvents.bind(e),r._formEvents.bind(e),r._configurationRepository.get(T.isMutationObserver)&&r._mutationEmitter&&(r._mutationEmitter.startObserver(e),r._jQueryElementListenerSiteMapper.initTracking())}),ElementEventCollector_defineProperty(ElementEventCollector_assertThisInitialized(r),"_onSiteMapperMatch",function(e){var t=e.selector;if(t)try{var n=window.document.querySelector(t);if(!n)return void M.error("ElementEvents._onSiteMapperMatch - selector:".concat(JSON.stringify(t)," not found on page"));r._domUtils.matches(n,r._inputSelectors)?r._jqueryEventHandler.bindInputEvents(n):r._domUtils.matches(n,r._onClickSelectors)?r._jqueryEventHandler.bindOnClickEvents(n):r._domUtils.matches(n,r._onSelectSelectors)?r._jqueryEventHandler.bindOnChangeEvents(n):r._domUtils.matches(n,r._onFormSelectors)?r._jqueryEventHandler.bindOnFormsEvents(n):M.error("ElementEvents._onSiteMapperMatch - Unable to match the element with selector:\n                ".concat(JSON.stringify(t)," to any selectors group. Aborting jQuery element listening process."))}catch(e){M.error("ElementEvents._onSiteMapperMatch - ".concat(e.message),e)}else M.warn("ElementEvents._onSiteMapperMatch - No selector defined for match. Aborting jQuery element listening process.")}),r._configurationRepository=e.configurationRepository,r._utils=e.utils,r._domUtils=e.domUtils,r._dataQ=e.dataQ,r._elements=e.elements,r._jQueryElementListenerSiteMapper=e.jQueryElementListenerSiteMapper,r._jQueryElementListenerSiteMapper.updateObserver(r._onSiteMapperMatch),r._messageBus=e.messageBus,r._mutationEmitter=e.mutationEmitter,r._messageBus.subscribe(_.MutationSingleEvent,r.mutationMessageHandler),r._StandardInputEventsEmitter=e.StandardInputEventsEmitter,r._SyntheticMaskInputEventsHandler=e.SyntheticMaskInputEventsHandler,r._SyntheticAutotabInputEventsHandler=e.SyntheticAutotabInputEventsHandler,r._maskingService=e.maskingService,r._inputEvents=new e.InputEvents(r._elements,r.sendToQueue.bind(ElementEventCollector_assertThisInitialized(r)),r._utils,r._messageBus,r._StandardInputEventsEmitter,r._SyntheticMaskInputEventsHandler,r._SyntheticAutotabInputEventsHandler,r._maskingService),r._inputSelectors=e.inputSelectors,r._StandardOnClickEventsEmitter=e.StandardOnClickEventsEmitter,r._clickEvents=new e.ClickEvents(r.sendToQueue.bind(ElementEventCollector_assertThisInitialized(r)),r._utils,r._messageBus,r._configurationRepository,r._StandardOnClickEventsEmitter),r._onClickSelectors=e.onClickSelectors,r._StandardOnChangeEventsEmitter=e.StandardOnChangeEventsEmitter,r._elementFocusEventEmitter=e.ElementFocusEventsEmitter,r._elementBlurEventEmitter=e.ElementBlurEventsEmitter,r._selectElementEvents=new e.SelectElementEvents(r.sendToQueue.bind(ElementEventCollector_assertThisInitialized(r)),r._utils,r._messageBus,r._StandardOnChangeEventsEmitter,r._elementFocusEventEmitter,r._elementBlurEventEmitter,r._configurationRepository),r._onSelectSelectors=e.onSelectSelectors,r._StandardOnFormEventsEmitter=e.StandardOnFormEventsEmitter,r._formEvents=new e.FormEvents(r.sendToQueue.bind(ElementEventCollector_assertThisInitialized(r)),r._messageBus,r._StandardOnFormEventsEmitter),r._onFormSelectors=e.onFormSelectors,r._jqueryEventHandler=e.JqueryElementsHandler,r._maxElemValLength=200,r._isHashedValue=r._configurationRepository.get("isElementHashedValue")||!1,r._hashTruncationLength=r._configurationRepository.get("elementHashTruncationLength")||2,r}return ElementEventCollector_createClass(ElementEventCollector,[{key:"stopFeature",value:function stopFeature(e){this._inputEvents.unbind(e),this._clickEvents.unbind(e),this._selectElementEvents.unbind(e),this._formEvents.unbind(e),this._jQueryElementListenerSiteMapper.stopTracking(),this._mutationEmitter.stopObserver(e)}},{key:"updateFeatureConfig",value:function updateFeatureConfig(e){this._configurationRepository.get("isMutationObserver")&&this._mutationEmitter&&(this._mutationEmitter.startObserver(e),this._jQueryElementListenerSiteMapper.onConfigUpdate(this._configurationRepository)),this._isHashedValue=void 0!==this._configurationRepository.get("isElementHashedValue")?this._configurationRepository.get("isElementHashedValue"):this._isHashedValue,this._hashTruncationLength=void 0!==this._configurationRepository.get("elementHashTruncationLength")?this._configurationRepository.get("elementHashTruncationLength"):this._hashTruncationLength,this._elements.updateFeatureConfig(),this._clickEvents.updateSettings(),this._selectElementEvents.updateSettings(e)}},{key:"sendToQueue",value:function sendToQueue(e,t){var n=re[e.isTrusted],r=this.getEventTimestamp(e),o=this.getTimestampFromEvent(e),i=rt[e.type];this._utils.isUndefinedNull(i)&&(i=-1);var s=this._elements.getElement(e.target),a=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();(t=t||{}).elementValues&&t.elementValues.length>this._maxElemValLength&&(t.elementValues="");e=(this._isHashedValue?e.target.value||e.target.innerHTML:"")?this._utils.getTruncatedHash(e.target.value,this._hashTruncationLength):"",o=_objectSpread(_objectSpread({},t),{eventType:i,eventSequence:a,timestamp:r,elementHash:s,isTrusted:n,hashedValue:e,relativeTime:o});this._dataQ.addToQueue("element_events",this._utils.convertToArrayByMap(ot,o),!0)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return nt}},{key:"Builder",get:function get(){return function(){function Builder(e,t,n,r,o){ElementEventCollector_classCallCheck(this,Builder),this.configurationRepository=e,this.utils=t,this.domUtils=n,this.elements=r,this.dataQ=o}return ElementEventCollector_createClass(Builder,[{key:"withMessageBus",value:function withMessageBus(e){return this.messageBus=e,this}},{key:"withMutationEmitter",value:function withMutationEmitter(e){return this.mutationEmitter=e,this}},{key:"withjQueryElementListenerSiteMapper",value:function withjQueryElementListenerSiteMapper(e){return this.jQueryElementListenerSiteMapper=e,this}},{key:"withjQueryElementsHandler",value:function withjQueryElementsHandler(e){return this.JqueryElementsHandler=e,this}},{key:"withInputEvents",value:function withInputEvents(e,t,n){return this.InputEvents=e,this.inputSelectors=t,this.maskingService=n,this}},{key:"withStandardInputEventsEmitter",value:function withStandardInputEventsEmitter(e){return this.StandardInputEventsEmitter=e,this}},{key:"withSyntheticMaskInputEventsHandler",value:function withSyntheticMaskInputEventsHandler(e){return this.SyntheticMaskInputEventsHandler=e,this}},{key:"withSyntheticAutotabInputEventsHandler",value:function withSyntheticAutotabInputEventsHandler(e){return this.SyntheticAutotabInputEventsHandler=e,this}},{key:"withClickEvents",value:function withClickEvents(e,t){return this.ClickEvents=e,this.onClickSelectors=t,this}},{key:"withStandardOnClickEventsEmitter",value:function withStandardOnClickEventsEmitter(e){return this.StandardOnClickEventsEmitter=e,this}},{key:"withSelectElementEvents",value:function withSelectElementEvents(e,t){return this.SelectElementEvents=e,this.onSelectSelectors=t,this}},{key:"withStandardOnChangeEventsEmitter",value:function withStandardOnChangeEventsEmitter(e){return this.StandardOnChangeEventsEmitter=e,this}},{key:"withElementFocusEventsEmitter",value:function withElementFocusEventsEmitter(e){return this.ElementFocusEventsEmitter=e,this}},{key:"withElementBlurEventsEmitter",value:function withElementBlurEventsEmitter(e){return this.ElementBlurEventsEmitter=e,this}},{key:"withFormEvents",value:function withFormEvents(e,t){return this.FormEvents=e,this.onFormSelectors=t,this}},{key:"withStandardOnFormEventsEmitter",value:function withStandardOnFormEventsEmitter(e){return this.StandardOnFormEventsEmitter=e,this}},{key:"build",value:function build(){return new ElementEventCollector(this)}}]),Builder}()}}]),ElementEventCollector}();function ClipboardEventCollector_typeof(e){return(ClipboardEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ClipboardEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ClipboardEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ClipboardEventCollector_createClass(e,t,n){return t&&ClipboardEventCollector_defineProperties(e.prototype,t),n&&ClipboardEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ClipboardEventCollector_setPrototypeOf(e,t){return(ClipboardEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ClipboardEventCollector_createSuper(n){var r=function ClipboardEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ClipboardEventCollector_getPrototypeOf(n);return function ClipboardEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===ClipboardEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ClipboardEventCollector_assertThisInitialized(e)}(this,r?(e=ClipboardEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ClipboardEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ClipboardEventCollector_getPrototypeOf(e){return(ClipboardEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ClipboardEventCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st={configKey:"isClipboardEvent",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInUns:!1,runInSlave:!0,isRunning:!1,instance:null},at={copy:0,paste:1,cut:2},ct=["eventSequence","timestamp","clipboardEventType","elementHash","copiedText"],ut=function(){!function ClipboardEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ClipboardEventCollector_setPrototypeOf(e,t)}(ClipboardEventCollector,te);var t=ClipboardEventCollector_createSuper(ClipboardEventCollector);function ClipboardEventCollector(e){var s;return ClipboardEventCollector_classCallCheck(this,ClipboardEventCollector),ClipboardEventCollector_defineProperty(ClipboardEventCollector_assertThisInitialized(s=t.call(this)),"startFeature",function(e){try{var t=e.getDocument();s._cutEventEmitter.start(t),s._messageBus.subscribe(_.CutEvent,s._handleClipboardEvent),s._copyEventEmitter.start(t),s._messageBus.subscribe(_.CopyEvent,s._handleClipboardEvent),s._pasteEventEmitter.start(t),s._messageBus.subscribe(_.PasteEvent,s._handleClipboardEvent)}catch(e){M.error("Failed starting the ClipboardEvents feature. msg: ".concat(e.message),e)}}),ClipboardEventCollector_defineProperty(ClipboardEventCollector_assertThisInitialized(s),"_handleClipboardEvent",function(e){s._sendToQueue(e)}),ClipboardEventCollector_defineProperty(ClipboardEventCollector_assertThisInitialized(s),"_sendToQueue",function(e){try{var t=s.getEventTimestamp(e),n=s._elements.getElement(e.target),r=s._utils.StorageUtils.getAndUpdateEventSequenceNumber(),o=e.clipboardData?e.clipboardData.getData("text"):window.clipboardData?window.clipboardData.getData("text"):"";""!==(o=o||"")&&(o=o.replace(/[\d]/g,"1").replace(/[a-zA-Z]/g,"a").replace(/[^a-zA-Z\d]/g,"*"));var i=at[e.type];s._utils.isUndefinedNull(i)&&(i=-1),s._dataQueue.addToQueue("clipboard_events",s._utils.convertToArrayByMap(ct,{eventSequence:r,timestamp:t,elementHash:n,copiedText:o,clipboardEventType:i}))}catch(e){M.error("Failed handling ClipboardEvent. msg: ".concat(e.message),e)}}),s._utils=e.utils,s._dataQueue=e.dataQueue,s._elements=e.elements,s._messageBus=e.messageBus,s._cutEventEmitter=e.cutEventEmitter,s._copyEventEmitter=e.copyEventEmitter,s._pasteEventEmitter=e.pasteEventEmitter,s}return ClipboardEventCollector_createClass(ClipboardEventCollector,[{key:"stopFeature",value:function stopFeature(e){try{var t=e.getDocument();this._cutEventEmitter.stop(t),this._messageBus.unsubscribe(_.CutEvent,this._handleClipboardEvent),this._copyEventEmitter.stop(t),this._messageBus.unsubscribe(_.CopyEvent,this._handleClipboardEvent),this._pasteEventEmitter.stop(t),this._messageBus.unsubscribe(_.PasteEvent,this._handleClipboardEvent)}catch(e){M.error("Failed stopping the ClipboardEvents feature. msg: ".concat(e.message),e)}}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return st}},{key:"Builder",get:function get(){return function(){function Builder(e,t,n){ClipboardEventCollector_classCallCheck(this,Builder),this.utils=e,this.dataQueue=n,this.elements=t}return ClipboardEventCollector_createClass(Builder,[{key:"withMessageBus",value:function withMessageBus(e){return this.messageBus=e,this}},{key:"withCutEventEmitter",value:function withCutEventEmitter(e){return this.cutEventEmitter=e,this}},{key:"withCopyEventEmitter",value:function withCopyEventEmitter(e){return this.copyEventEmitter=e,this}},{key:"withPasteEventEmitter",value:function withPasteEventEmitter(e){return this.pasteEventEmitter=e,this}},{key:"build",value:function build(){return new ClipboardEventCollector(this)}}]),Builder}()}}]),ClipboardEventCollector}();function OrientationEventCollector_typeof(e){return(OrientationEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OrientationEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OrientationEventCollector_setPrototypeOf(e,t){return(OrientationEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function OrientationEventCollector_createSuper(n){var r=function OrientationEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=OrientationEventCollector_getPrototypeOf(n);return function OrientationEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===OrientationEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return OrientationEventCollector_assertThisInitialized(e)}(this,r?(e=OrientationEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function OrientationEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OrientationEventCollector_getPrototypeOf(e){return(OrientationEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lt={configKey:"isOrientationEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},ft=function(){!function OrientationEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OrientationEventCollector_setPrototypeOf(e,t)}(OrientationEventCollector,te);var i=OrientationEventCollector_createSuper(OrientationEventCollector);function OrientationEventCollector(e,t,n,r,o){var s;return function OrientationEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OrientationEventCollector),function OrientationEventCollector_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(OrientationEventCollector_assertThisInitialized(s=i.call(this)),"_handleDeviceOrientationEvent",function(e){var t,n,r,o,i=s._utils.dateNow();e&&i-s._lastTime>s._samplePeriod&&(t=e.absolute||!1,n=s._utils.isUndefinedNull(e.alpha)?0:s._utils.cutDecimalPointDigits(e.alpha,4),r=s._utils.isUndefinedNull(e.beta)?0:s._utils.cutDecimalPointDigits(e.beta,4),o=s._utils.isUndefinedNull(e.gamma)?0:s._utils.cutDecimalPointDigits(e.gamma,4),n===s._lastAlpha&&r===s._lastBeta&&o===s._lastGamma||(M.isDebug()&&M.debug("OrientationEvents:_onOrientationEvent, sending data: timestamp: ".concat(i,"\n                alpha,betta,gamma: ").concat(n,",").concat(r,",").concat(o,",prevTime:").concat(s._lastTime)),s._lastTime=i,s._lastAlpha=n,s._lastBeta=r,s._lastGamma=o,e=s._utils.StorageUtils.getAndUpdateEventSequenceNumber(),s._dataQ.addToQueue("orientation_events",[null,e,i,t,n,r,o])))}),s._dataQ=n,s._configurationRepository=e,s._utils=t,s._samplePeriod=s._configurationRepository.get(T.orientationEventsSamplePeriod)||0,s._lastAlpha=0,s._lastBeta=0,s._lastGamma=0,s._lastTime=0,s._messageBus=r,s._deviceOrientationEventEmitter=o,s}return function OrientationEventCollector_createClass(e,t,n){t&&OrientationEventCollector_defineProperties(e.prototype,t),n&&OrientationEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(OrientationEventCollector,[{key:"startFeature",value:function startFeature(){window.DeviceOrientationEvent&&(this._deviceOrientationEventEmitter.start(),this._messageBus.subscribe(_.DeviceOrientationEvent,this._handleDeviceOrientationEvent))}},{key:"stopFeature",value:function stopFeature(){window.DeviceOrientationEvent&&(this._deviceOrientationEventEmitter.stop(),this._messageBus.unsubscribe(_.DeviceOrientationEvent,this._handleDeviceOrientationEvent))}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){var e=this._configurationRepository.get(T.orientationEventsSamplePeriod);this._samplePeriod=void 0!==e?e:this._samplePeriod}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return lt}}]),OrientationEventCollector}();function BeforeInstallPromptEventCollector_typeof(e){return(BeforeInstallPromptEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BeforeInstallPromptEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BeforeInstallPromptEventCollector_setPrototypeOf(e,t){return(BeforeInstallPromptEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BeforeInstallPromptEventCollector_createSuper(n){var r=function BeforeInstallPromptEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=BeforeInstallPromptEventCollector_getPrototypeOf(n);return function BeforeInstallPromptEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===BeforeInstallPromptEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return BeforeInstallPromptEventCollector_assertThisInitialized(e)}(this,r?(e=BeforeInstallPromptEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function BeforeInstallPromptEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BeforeInstallPromptEventCollector_getPrototypeOf(e){return(BeforeInstallPromptEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pt={configKey:"isBeforeInstallPrompt",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!1,isFrameRelated:!1,runInUns:!1,isRunning:!1,instance:null},dt=["eventSequence","timestamp","platforms","relativeTime"],yt=function(){!function BeforeInstallPromptEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BeforeInstallPromptEventCollector_setPrototypeOf(e,t)}(BeforeInstallPromptEventCollector,te);var i=BeforeInstallPromptEventCollector_createSuper(BeforeInstallPromptEventCollector);function BeforeInstallPromptEventCollector(e,t,n,r){var o;return function BeforeInstallPromptEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BeforeInstallPromptEventCollector),function BeforeInstallPromptEventCollector_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(BeforeInstallPromptEventCollector_assertThisInitialized(o=i.call(this)),"_onBeforeInstallPrompt",function(e){var t=o._utils.StorageUtils.getAndUpdateEventSequenceNumber(),n=o.getEventTimestamp(),r=o.getTimestampFromEvent(e),e=e.platforms?e.platforms.join(","):"";o._dataQueue.addToQueue("before_install_prompt",o._utils.convertToArrayByMap(dt,{eventSequence:t,timestamp:n,platforms:e,relativeTime:r}))}),o._messageBus=n,o._eventEmitter=r,o._dataQueue=e,o._utils=t,o}return function BeforeInstallPromptEventCollector_createClass(e,t,n){t&&BeforeInstallPromptEventCollector_defineProperties(e.prototype,t),n&&BeforeInstallPromptEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BeforeInstallPromptEventCollector,[{key:"startFeature",value:function startFeature(){this._eventEmitter.start(window),this._messageBus.subscribe(_.BeforeInstallPromptEvent,this._onBeforeInstallPrompt)}},{key:"stopFeature",value:function stopFeature(){this._eventEmitter.stop(window),this._messageBus.unsubscribe(_.BeforeInstallPromptEvent,this._onBeforeInstallPrompt)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return pt}}]),BeforeInstallPromptEventCollector}();function WindowEventCollector_typeof(e){return(WindowEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WindowEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WindowEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WindowEventCollector_createClass(e,t,n){return t&&WindowEventCollector_defineProperties(e.prototype,t),n&&WindowEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function WindowEventCollector_setPrototypeOf(e,t){return(WindowEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function WindowEventCollector_createSuper(n){var r=function WindowEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=WindowEventCollector_getPrototypeOf(n);return function WindowEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===WindowEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return WindowEventCollector_assertThisInitialized(e)}(this,r?(e=WindowEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function WindowEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WindowEventCollector_getPrototypeOf(e){return(WindowEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WindowEventCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ht={configKey:"isWindowEvents",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},vt={DOMContentLoaded:0,scroll:1,resize:2,focus:3,blur:4,tabFocus:5,tabBlur:6},_t=["eventSequence","timestamp","eventType","isTrusted","screenWidth","screenHeight","clientWidth","clientHeight","documentWidth","documentHeight","scrollTop","scrollLeft","windowInnerWidth","windowInnerHeight","windowOuterWidth","windowOuterHeight"],mt=function(){!function WindowEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WindowEventCollector_setPrototypeOf(e,t)}(WindowEventCollector,te);var t=WindowEventCollector_createSuper(WindowEventCollector);function WindowEventCollector(e){var o;return WindowEventCollector_classCallCheck(this,WindowEventCollector),WindowEventCollector_defineProperty(WindowEventCollector_assertThisInitialized(o=t.call(this)),"startFeature",function(e){try{o._resizeEventEmitter.start(e.Context),o._messageBus.subscribe(_.ResizeEvent,o._onWindowEvent),o._focusEventEmitter.start(e.Context),o._messageBus.subscribe(_.FocusEvent,o._onWindowEvent),o._blurEventEmitter.start(e.Context),o._messageBus.subscribe(_.BlurEvent,o._onWindowEvent),o._domContentLoadedEventEmitter.start(e.getDocument()),o._messageBus.subscribe(_.DOMContentLoadedEvent,o._onWindowEvent),o._visibilityChangeEventEmitter.start(e.getDocument()),o._messageBus.subscribe(_.VisibilityChangeEvent,o._onWindowEvent),o._configurationRepository.get(T.isScrollCollect)&&(o._scrollEventEmitter.start(e.Context),o._messageBus.subscribe(_.ScrollEvent,o._onWindowEvent))}catch(e){M.error("Failed starting the WindowEventCollector. msg: ".concat(e.message),e)}}),WindowEventCollector_defineProperty(WindowEventCollector_assertThisInitialized(o),"stopFeature",function(e){try{o._resizeEventEmitter.stop(e.Context),o._messageBus.unsubscribe(_.ResizeEvent,o._onWindowEvent),o._focusEventEmitter.stop(e.Context),o._messageBus.unsubscribe(_.FocusEvent,o._onWindowEvent),o._blurEventEmitter.stop(e.Context),o._messageBus.unsubscribe(_.BlurEvent,o._onWindowEvent),o._domContentLoadedEventEmitter.stop(e.getDocument()),o._messageBus.unsubscribe(_.DOMContentLoadedEvent,o._onWindowEvent),o._visibilityChangeEventEmitter.stop(e.getDocument()),o._messageBus.unsubscribe(_.VisibilityChangeEvent,o._onWindowEvent),o._configurationRepository.get(T.isScrollCollect)&&(o._scrollEventEmitter.stop(e.Context),o._messageBus.unsubscribe(_.ScrollEvent,o._onWindowEvent))}catch(e){M.error("Failed stopping the ClipboardEvents feature. msg: ".concat(e.message),e)}}),WindowEventCollector_defineProperty(WindowEventCollector_assertThisInitialized(o),"updateFeatureConfig",function(e){o._configurationRepository.get(T.isScrollCollect)?o._configurationRepository.get(T.isScrollCollect)&&(o._scrollEventEmitter.start(e.Context),o._messageBus.subscribe(_.ScrollEvent,o._onWindowEvent)):(o._scrollEventEmitter.stop(e.Context),o._messageBus.unsubscribe(_.ScrollEvent,o._onWindowEvent))}),WindowEventCollector_defineProperty(WindowEventCollector_assertThisInitialized(o),"_onWindowEvent",function(e){try{o._sendToQueue(e)}catch(e){M.error("An error has occurred while sending window event. ".concat(e.message),e)}}),WindowEventCollector_defineProperty(WindowEventCollector_assertThisInitialized(o),"_sendToQueue",function(e){if(!e)throw new Error("Invalid window event received.");var t,n=re[void 0];"DOMContentLoaded"===e.type?t=(new Date).getTime():(t=o.getEventTimestamp(e),n=re[e.isTrusted]),M.isDebug()&&(M.trace("got event "+e.type+" at time "+t),M.trace("adding to queue - screen(width,height): "+screen.width+","+screen.height+" window(width,height): "+window.innerWidth+","+window.innerHeight));var r=o._utils.StorageUtils.getAndUpdateEventSequenceNumber(),e="visibilitychange"!==e.type?e.type:"hidden"===document.visibilityState?"tabBlur":"tabFocus",e=vt[e];null!=e&&void 0!==e||(e=-1),o._dataQueue.addToQueue("window_events",o._utils.convertToArrayByMap(_t,{eventType:e,eventSequence:r,timestamp:t,screenWidth:screen.width?Math.round(screen.width):-1,screenHeight:screen.height?Math.round(screen.height):-1,clientWidth:window.innerWidth?Math.round(window.innerWidth):-1,clientHeight:window.innerHeight?Math.round(window.innerHeight):-1,documentWidth:document.body&&document.body.clientWidth?Math.round(document.body.clientWidth):-1,documentHeight:document.body&&document.body.clientHeight?Math.round(document.body.clientHeight):-1,scrollTop:document.body&&document.body.scrollTop?Math.round(document.body.scrollTop):0,scrollLeft:document.body&&document.body.scrollLeft?Math.round(document.body.scrollLeft):0,windowInnerWidth:window.innerWidth?Math.round(window.innerWidth):-1,windowInnerHeight:window.innerHeight?Math.round(window.innerHeight):-1,windowOuterWidth:window.outerWidth?Math.round(window.outerWidth):-1,windowOuterHeight:window.outerHeight?Math.round(window.outerHeight):-1,isTrusted:n}))}),o._configurationRepository=e.configurationRepository,o._utils=e.utils,o._dataQueue=e.dataQueue,o._messageBus=e.messageBus,o._focusEventEmitter=e.focusEventEmitter,o._blurEventEmitter=e.blurEventEmitter,o._resizeEventEmitter=e.resizeEventEmitter,o._domContentLoadedEventEmitter=e.domContentLoadedEventEmitter,o._visibilityChangeEventEmitter=e.visibilityChangeEventEmitter,o._scrollEventEmitter=e.scrollEventEmitter,o}return WindowEventCollector_createClass(WindowEventCollector,null,[{key:"getDefaultSettings",value:function getDefaultSettings(){return ht}},{key:"Builder",get:function get(){return function(){function Builder(e,t,n){WindowEventCollector_classCallCheck(this,Builder),this.configurationRepository=e,this.utils=t,this.dataQueue=n}return WindowEventCollector_createClass(Builder,[{key:"withMessageBus",value:function withMessageBus(e){return this.messageBus=e,this}},{key:"withFocusEventEmitter",value:function withFocusEventEmitter(e){return this.focusEventEmitter=e,this}},{key:"withBlurEventEmitter",value:function withBlurEventEmitter(e){return this.blurEventEmitter=e,this}},{key:"withResizeEventEmitter",value:function withResizeEventEmitter(e){return this.resizeEventEmitter=e,this}},{key:"withDOMContentLoadedEventEmitter",value:function withDOMContentLoadedEventEmitter(e){return this.domContentLoadedEventEmitter=e,this}},{key:"withVisibilityChangeEventEmitter",value:function withVisibilityChangeEventEmitter(e){return this.visibilityChangeEventEmitter=e,this}},{key:"withScrollEventEmitter",value:function withScrollEventEmitter(e){return this.scrollEventEmitter=e,this}},{key:"build",value:function build(){return new WindowEventCollector(this)}}]),Builder}()}}]),WindowEventCollector}();function AccelerometerEventCollector_typeof(e){return(AccelerometerEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AccelerometerEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AccelerometerEventCollector_setPrototypeOf(e,t){return(AccelerometerEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function AccelerometerEventCollector_createSuper(n){var r=function AccelerometerEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=AccelerometerEventCollector_getPrototypeOf(n);return function AccelerometerEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===AccelerometerEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return AccelerometerEventCollector_assertThisInitialized(e)}(this,r?(e=AccelerometerEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function AccelerometerEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AccelerometerEventCollector_getPrototypeOf(e){return(AccelerometerEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gt={configKey:"isAccelerometerEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},bt=function(){!function AccelerometerEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AccelerometerEventCollector_setPrototypeOf(e,t)}(AccelerometerEventCollector,te);var o=AccelerometerEventCollector_createSuper(AccelerometerEventCollector);function AccelerometerEventCollector(e,t,n){var r;return function AccelerometerEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AccelerometerEventCollector),(r=o.call(this))._configurationRepository=e,r._utils=t,r._dataQueue=n,r._storageUtils=r._utils.StorageUtils,r._samplePeriod=r._configurationRepository.get(T.accelerometerEventsSamplePeriod)||0,r._samplePeriodGyro=r._configurationRepository.get(T.gyroEventsSamplePeriod)||0,r._lastX=0,r._lastY=0,r._lastZ=0,r._lastTime=0,r._lastAlpha=0,r._lastBeta=0,r._lastGamma=0,r._lastTimeGyro=0,r._onAccelerometerventFunc=r._onAccelerometerEvent.bind(AccelerometerEventCollector_assertThisInitialized(r)),r}return function AccelerometerEventCollector_createClass(e,t,n){t&&AccelerometerEventCollector_defineProperties(e.prototype,t),n&&AccelerometerEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(AccelerometerEventCollector,[{key:"_onAccelerometerEvent",value:function _onAccelerometerEvent(e){var t,n,r,o,i=this._utils.dateNow();return e&&e.accelerationIncludingGravity&&i-this._lastTime>this._samplePeriod&&(r=e.accelerationIncludingGravity.x,o=e.accelerationIncludingGravity.y,t=e.accelerationIncludingGravity.z,this._utils.isUndefinedNull(r)&&this._utils.isUndefinedNull(o)&&this._utils.isUndefinedNull(t)||(r=this._utils.isUndefinedNull(r)?-1:this._utils.cutDecimalPointDigits(r,4),o=this._utils.isUndefinedNull(o)?-1:this._utils.cutDecimalPointDigits(o,4),t=this._utils.isUndefinedNull(t)?-1:this._utils.cutDecimalPointDigits(t,4),r===this._lastX&&o===this._lastY&&t===this._lastZ||(n=this._storageUtils.getAndUpdateEventSequenceNumber(),this._lastTime=i,this._lastX=r,this._lastY=o,this._lastZ=t,this._dataQueue.addToQueue("accelerometer_events",[null,n,i,r,o,t]),M.isDebug()&&M.debug("AccelerometerEvents:_onAccelerometerEvent, sending data: timestamp:".concat(i," x,y,z:").concat(r,",").concat(o,",").concat(t,", prevTime:").concat(this._lastTime))))),e&&e.rotationRate&&i-this._lastTimeGyro>this._samplePeriodGyro&&(n=e.rotationRate.alpha,r=e.rotationRate.beta,o=e.rotationRate.gamma,this._utils.isUndefinedNull(n)&&this._utils.isUndefinedNull(r)&&this._utils.isUndefinedNull(o)||(t=e.absolute||!1,n=this._utils.isUndefinedNull(n)?0:this._utils.cutDecimalPointDigits(n,4),r=this._utils.isUndefinedNull(r)?0:this._utils.cutDecimalPointDigits(r,4),o=this._utils.isUndefinedNull(o)?0:this._utils.cutDecimalPointDigits(o,4),n===this._lastAlpha&&r===this._lastBeta&&o===this._lastGamma||(this._lastTimeGyro=i,this._lastAlpha=n,this._lastBeta=r,this._lastGamma=o,e=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),this._dataQueue.addToQueue("gyro_events",[null,e,i,t,n,r,o]),M.isDebug()&&M.debug("GyroEvents:_onGyroEvent, sending data: timestamp:".concat(i," alpha,betta,gamma:").concat(n,",").concat(r,",").concat(o,", prevTime: ").concat(this._lastTimeGyro))))),!0}},{key:"startFeature",value:function startFeature(){window.DeviceMotionEvent&&this._utils.addEventListener(window,"devicemotion",this._onAccelerometerventFunc)}},{key:"stopFeature",value:function stopFeature(){window.DeviceMotionEvent&&this._utils.removeEventListener(window,"devicemotion",this._onAccelerometerventFunc)}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){this._samplePeriod=void 0!==this._configurationRepository.get(T.accelerometerEventsSamplePeriod)?this._configurationRepository.get(T.accelerometerEventsSamplePeriod):this._samplePeriod,this._samplePeriodGyro=void 0!==this._configurationRepository.get(T.gyroEventsSamplePeriod)?this._configurationRepository.get(T.gyroEventsSamplePeriod):this._samplePeriodGyro}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return gt}}]),AccelerometerEventCollector}();function PinchZoomEventCollector_typeof(e){return(PinchZoomEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PinchZoomEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PinchZoomEventCollector_setPrototypeOf(e,t){return(PinchZoomEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PinchZoomEventCollector_createSuper(n){var r=function PinchZoomEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PinchZoomEventCollector_getPrototypeOf(n);return function PinchZoomEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===PinchZoomEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return PinchZoomEventCollector_assertThisInitialized(e)}(this,r?(e=PinchZoomEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PinchZoomEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PinchZoomEventCollector_getPrototypeOf(e){return(PinchZoomEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yb(e,t,r){function getDistance(e,t){var n=t[r[0]]-e[r[0]],e=t[r[1]]-e[r[1]];return Math.sqrt(n*n+e*e)}return{getScale:function _getScale(){return getDistance(e[0],e[1])/getDistance(t[0],t[1])},getFocusPoint:function getFocusPoint(){return function _getFocusPoint(e,t){return{x:(e[r[0]]+t[r[0]])/2,y:(e[r[1]]+t[r[1]])/2}}(e[1],e[0])}}}var Ct=["clientX","clientY"],Et=["screenX","screenY"],Pt={pointerdown:0,pointermove:1,pointerup:2},wt={configKey:"isPinchZoomEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},Ot=["eventSequence","timestamp","focusX","focusY","scaleFactor"],St=function(){!function PinchZoomEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PinchZoomEventCollector_setPrototypeOf(e,t)}(PinchZoomEventCollector,te);var i=PinchZoomEventCollector_createSuper(PinchZoomEventCollector);function PinchZoomEventCollector(e,t,n,r){var o;return function PinchZoomEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PinchZoomEventCollector),(o=i.call(this))._utils=e,o._dataQ=n,o._elements=t,o._msgBus=r,o._evGesturesCache=[],o._prevEventDiff=-1,o._prevEvGestureSet=[],o._prevTouchEvents=[],o._onAllBrowsersPinchZoomEventBinded=o._onAllBrowsersPinchZoomEvent.bind(PinchZoomEventCollector_assertThisInitialized(o)),o}return function PinchZoomEventCollector_createClass(e,t,n){t&&PinchZoomEventCollector_defineProperties(e.prototype,t),n&&PinchZoomEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PinchZoomEventCollector,[{key:"startFeature",value:function startFeature(e){this._bind(e)}},{key:"stopFeature",value:function stopFeature(e){this._unbind(e)}},{key:"_addToCommunicationQueue",value:function _addToCommunicationQueue(e,t,n,r){e!==Pt.pointerdown&&e!==Pt.pointerup||this._msgBus.publish("pinchEvent",{action:e});e=this.getEventTimestamp(r),r=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._dataQ.addToQueue("pinch_events",this._utils.convertToArrayByMap(Ot,{eventSequence:r,timestamp:e,focusX:n.x,focusY:n.y,scaleFactor:t}))}},{key:"_bind",value:function _bind(e){var t,n=e.getDocument();if(window.PointerEvent?t=["pointerdown","pointermove","pointerup"]:window.TouchEvent&&(t=["touchstart","touchend","touchcancel","touchmove"]),this._listeningToEvents=t,this._listeningToEvents)for(var r=0;r<this._listeningToEvents.length;r++)this._utils.addEventListener(n,this._listeningToEvents[r],this._onAllBrowsersPinchZoomEventBinded)}},{key:"_unbind",value:function _unbind(e){var t=e.getDocument();if(this._listeningToEvents)for(var n=0;n<this._listeningToEvents.length;n++)this._utils.removeEventListener(t,this._listeningToEvents[n],this._onAllBrowsersPinchZoomEventBinded);this._evGesturesCache=[],this._prevEventDiff=-1}},{key:"_onAllBrowsersPinchZoomEvent",value:function _onAllBrowsersPinchZoomEvent(e){switch(e.type){case"pointerdown":this._onPointerDownEvent(e);break;case"pointermove":this._onPointerMoveEvent(e);break;case"pointerup":this._onPointerUpEvent(e);break;case"touchstart":this._onTouchStartEvent(e);break;case"touchend":this._onTouchEndEvent();break;case"touchmove":this._onTouchMoveEvent(e)}return!0}},{key:"_onPointerDownEvent",value:function _onPointerDownEvent(e){this._evGesturesCache.push(e)}},{key:"_onPointerMoveEvent",value:function _onPointerMoveEvent(e){for(var t,n,r,o=0;o<this._evGesturesCache.length;o++)if(e.pointerId===this._evGesturesCache[o].pointerId){this._evGesturesCache[o]=e;break}2===this._evGesturesCache.length&&this._evGesturesCache[0].pointerId!==this._evGesturesCache[1].pointerId?(t=Math.abs(this._evGesturesCache[0].clientX-this._evGesturesCache[1].clientX),0<this._prevEventDiff&&(this._prevEventDiff,this._prevEventDiff,2===this._prevEvGestureSet.length&&(r=(n=yb(this._evGesturesCache,this._prevEvGestureSet,Ct)).getScale(),this._addToCommunicationQueue(Pt[e.type],r,n.getFocusPoint(),e))),this._prevEventDiff=t,this._prevEvGestureSet=this._evGesturesCache.slice(0)):2<this._evGesturesCache.length&&(this._evGesturesCache=[],this._prevEvGestureSet=[])}},{key:"_onPointerUpEvent",value:function _onPointerUpEvent(e){for(var t=0;t<this._evGesturesCache.length;t++)if(this._evGesturesCache[t].pointerId===e.pointerId){this._evGesturesCache.splice(t,1);break}this._evGesturesCache.length<2&&(this._prevEventDiff=-1,this._prevEvGestureSet=[])}},{key:"_onTouchStartEvent",value:function _onTouchStartEvent(e){this._prevTouchEvents[0]=e.touches.item(0),this._prevTouchEvents[1]=e.touches.item(1)}},{key:"_onTouchEndEvent",value:function _onTouchEndEvent(){this._prevTouchEvents=[]}},{key:"_onTouchMoveEvent",value:function _onTouchMoveEvent(e){var t,n;2===e.touches.length&&(2===this._prevTouchEvents.length&&(n=[e.touches.item(0),e.touches.item(1)],n=(t=yb(n,this._prevTouchEvents.splice(0),Et)).getScale(),this._addToCommunicationQueue(Pt[e.type],n,t.getFocusPoint(),e)),this._prevTouchEvents[0]=e.touches.item(0),this._prevTouchEvents[1]=e.touches.item(1))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return wt}}]),PinchZoomEventCollector}();function ScriptEventCollector_typeof(e){return(ScriptEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ScriptEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ScriptEventCollector_setPrototypeOf(e,t){return(ScriptEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ScriptEventCollector_createSuper(n){var r=function ScriptEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ScriptEventCollector_getPrototypeOf(n);return function ScriptEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===ScriptEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ScriptEventCollector_assertThisInitialized(e)}(this,r?(e=ScriptEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ScriptEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ScriptEventCollector_getPrototypeOf(e){return(ScriptEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kt={load:0},Bt={configKey:"isScriptExecuteEve",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},Ft=["eventSequence","timestamp","eventType","scriptId","namespaceURI","outerHTML","scriptSource","scriptType"],Dt=function(){!function ScriptEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ScriptEventCollector_setPrototypeOf(e,t)}(ScriptEventCollector,te);var r=ScriptEventCollector_createSuper(ScriptEventCollector);function ScriptEventCollector(e,t){var n;return function ScriptEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ScriptEventCollector),(n=r.call(this))._onScriptExecuteEventFunc=n._onScriptExecuteEvent.bind(ScriptEventCollector_assertThisInitialized(n)),n._dataQueue=t,n._utils=e,n}return function ScriptEventCollector_createClass(e,t,n){t&&ScriptEventCollector_defineProperties(e.prototype,t),n&&ScriptEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ScriptEventCollector,[{key:"_onScriptExecuteEvent",value:function _onScriptExecuteEvent(e){if(e&&e.target&&("load"!==e.type||"script"===e.target.nodeName.toLowerCase()))try{var t=this.getEventTimestamp(e),n=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),r=kt[e.type];this._utils.isUndefinedNull(r)&&(r=-1),M.isDebug()&&M.trace("got event "+e.type+", "+r+", scriptSrc: "+e.target.src+" at time "+t),this._dataQueue.addToQueue("script_events",this._utils.convertToArrayByMap(Ft,{eventSequence:n,timestamp:t,eventType:r,scriptId:e.target.id||"",namespaceURI:e.target.namespaceURI||"",outerHTML:e.target.outerHTML||"",scriptSource:e.target.src||"",scriptType:e.target.type||""}))}catch(e){M.error("error on getScriptExecuteEvent ".concat(e.toString()))}}},{key:"startFeature",value:function startFeature(){this._utils.addEventListener(document,"load",this._onScriptExecuteEventFunc,!0)}},{key:"stopFeature",value:function stopFeature(){this._utils.removeEventListener(document,"load",this._onScriptExecuteEventFunc,!0)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Bt}}]),ScriptEventCollector}();function NetInfoEventCollector_typeof(e){return(NetInfoEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NetInfoEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NetInfoEventCollector_setPrototypeOf(e,t){return(NetInfoEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function NetInfoEventCollector_createSuper(n){var r=function NetInfoEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=NetInfoEventCollector_getPrototypeOf(n);return function NetInfoEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===NetInfoEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function NetInfoEventCollector_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=NetInfoEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function NetInfoEventCollector_getPrototypeOf(e){return(NetInfoEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tt={configKey:"isNetInfoEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},Mt=["eventSequence","timestamp","connectionType","effectiveType","downlinkMax","downlink","rtt","isSaveData"],Rt=function(){!function NetInfoEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NetInfoEventCollector_setPrototypeOf(e,t)}(NetInfoEventCollector,te);var r=NetInfoEventCollector_createSuper(NetInfoEventCollector);function NetInfoEventCollector(e,t){var n;return function NetInfoEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NetInfoEventCollector),(n=r.call(this))._dataQueue=t,n._utils=e,n._connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection,n}return function NetInfoEventCollector_createClass(e,t,n){t&&NetInfoEventCollector_defineProperties(e.prototype,t),n&&NetInfoEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(NetInfoEventCollector,[{key:"onChangeNetworkInfo",value:function onChangeNetworkInfo(){M.debug("NetInfoEvents:onChangeNetworkInfo");var e=this._utils.isUndefinedNull(this._connection.saveData)?"":this._connection.saveData.toString(),t=this.getEventTimestamp(),n=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._dataQueue.addToQueue("net_info_events",this._utils.convertToArrayByMap(Mt,{eventSequence:n,timestamp:t,connectionType:this._connection.type||"",effectiveType:this._connection.effectiveType||"",downlinkMax:this._connection.downlinkMax?this._connection.downlinkMax.toString():"",downlink:this._connection.downlink?this._connection.downlink.toString():"",rtt:this._connection.rtt?this._connection.rtt.toString():"",isSaveData:e}))}},{key:"startFeature",value:function startFeature(){this._connection&&(this._connection.addEventListener("change",this.onChangeNetworkInfo.bind(this),!0),this.onChangeNetworkInfo())}},{key:"stopFeature",value:function stopFeature(){this._connection&&this._connection.removeEventListener("change",this.onChangeNetworkInfo.bind(this))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Tt}}]),NetInfoEventCollector}();function DeviceOrientationCollector_typeof(e){return(DeviceOrientationCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DeviceOrientationCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DeviceOrientationCollector_setPrototypeOf(e,t){return(DeviceOrientationCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DeviceOrientationCollector_createSuper(n){var r=function DeviceOrientationCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=DeviceOrientationCollector_getPrototypeOf(n);return function DeviceOrientationCollector_possibleConstructorReturn(e,t){{if(t&&("object"===DeviceOrientationCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return DeviceOrientationCollector_assertThisInitialized(e)}(this,r?(e=DeviceOrientationCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function DeviceOrientationCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DeviceOrientationCollector_getPrototypeOf(e){return(DeviceOrientationCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jt={configKey:"isDeviceOrientationEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},It={undefined:0,"portrait-primary":1,"landscape-primary":2,"portrait-secondary":3,"landscape-secondary":4},xt=["eventSequence","timestamp","orientation"],Lt=function(){!function DeviceOrientationCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DeviceOrientationCollector_setPrototypeOf(e,t)}(DeviceOrientationCollector,te);var r=DeviceOrientationCollector_createSuper(DeviceOrientationCollector);function DeviceOrientationCollector(e,t){var n;return function DeviceOrientationCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceOrientationCollector),(n=r.call(this))._dataQ=t,n._utils=e,n._onDeviceOrientationEventFunc=n._onDeviceOrientationEvent.bind(DeviceOrientationCollector_assertThisInitialized(n)),screen.mozOrientation&&screen.addEventListener?(n._eventTarget=screen,n._eventName="mozorientationchange"):screen.msOrientation&&screen.addEventListener?(n._eventTarget=screen,n._eventName="msorientationchange"):(n._eventTarget=window,n._eventName="orientationchange"),n}return function DeviceOrientationCollector_createClass(e,t,n){t&&DeviceOrientationCollector_defineProperties(e.prototype,t),n&&DeviceOrientationCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DeviceOrientationCollector,[{key:"startFeature",value:function startFeature(){this._utils.addEventListener(this._eventTarget,this._eventName,this._onDeviceOrientationEventFunc),this._handleDeviceOrientationEvent(screen)}},{key:"stopFeature",value:function stopFeature(){this._utils.removeEventListener(this._eventTarget,this._eventName,this._onDeviceOrientationEventFunc)}},{key:"_onDeviceOrientationEvent",value:function _onDeviceOrientationEvent(e){e=e&&e.target?e.target.screen||e.target:screen;this._handleDeviceOrientationEvent(e)}},{key:"_handleDeviceOrientationEvent",value:function _handleDeviceOrientationEvent(e){var t,n,r=e.mozOrientation||e.msOrientation||e.orientation;void 0!==r?(t=r.type||r,void 0!==(n=It[t])?this._lastDeviceOrientationType!==n&&(e=this.getEventTimestamp(),r=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),this._lastDeviceOrientationType=n,M.trace("onDeviceOrientationEvent: Orientation changed to ".concat(n," at time ").concat(e)),this._dataQ.addToQueue("screen_orientation",this._utils.convertToArrayByMap(xt,{eventSequence:r,timestamp:e,orientation:n}))):M.error("onDeviceOrientationEvent: Unknown orientation ".concat(t," value."))):M.debug("onDeviceOrientationEvent: Unable to find orientation data.")}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return jt}}]),DeviceOrientationCollector}();function TapEventCollector_typeof(e){return(TapEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TapEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TapEventCollector_setPrototypeOf(e,t){return(TapEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function TapEventCollector_createSuper(n){var r=function TapEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=TapEventCollector_getPrototypeOf(n);return function TapEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===TapEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return TapEventCollector_assertThisInitialized(e)}(this,r?(e=TapEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function TapEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TapEventCollector_getPrototypeOf(e){return(TapEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var At={configKey:"isTapEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},Nt=20,Ut=500,Qt=["eventSequence","timestamp","screenX","screenY","pageX","pageY","clientX","clientY","isTrusted","elementHash","touchIndex","touchSizeMajor","touchSizeMinor"],Ht=["eventSequence","timestamp","screenX","screenY","pageX","pageY","clientX","clientY","isTrusted","elementHash","touchIndex","touchSizeMajor","touchSizeMinor"],Wt=function(){!function TapEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TapEventCollector_setPrototypeOf(e,t)}(TapEventCollector,te);var i=TapEventCollector_createSuper(TapEventCollector);function TapEventCollector(e,t,n,r){var o;return function TapEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TapEventCollector),(o=i.call(this))._configurationRepository=e,o._utils=t,o._dataQ=r,o._elements=n,o._activeTouchActions={},o._tapMaxSlop=o._configurationRepository.get("tapEventsTapMaxSlop")||Nt,o._longPressTimeout=o._configurationRepository.get("tapEventsLongPressTimeout")||Ut,o._handleStartEventBind=o._handleStartEvent.bind(TapEventCollector_assertThisInitialized(o)),o._handleMoveEventBind=o._handleMoveEvent.bind(TapEventCollector_assertThisInitialized(o)),o._handleEndEventBind=o._handleEndEvent.bind(TapEventCollector_assertThisInitialized(o)),o._handleCancelEventBind=o._handleCancelEvent.bind(TapEventCollector_assertThisInitialized(o)),o._eventDefinitions=TapEventCollector.getSupportedTouchEvents(),o}return function TapEventCollector_createClass(e,t,n){t&&TapEventCollector_defineProperties(e.prototype,t),n&&TapEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(TapEventCollector,[{key:"startFeature",value:function startFeature(e){this._bind(e)}},{key:"stopFeature",value:function stopFeature(e){this._unbind(e)}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){this._tapMaxSlop=void 0!==this._configurationRepository.get("tapEventsTapMaxSlop")?this._configurationRepository.get("tapEventsTapMaxSlop"):this._tapMaxSlop,this._longPressTimeout=void 0!==this._configurationRepository.get("tapEventsLongPressTimeout")?this._configurationRepository.get("tapEventsLongPressTimeout"):this._longPressTimeout}},{key:"_bind",value:function _bind(e){this._eventDefinitions?(e=e.getDocument(),this._utils.addEventListener(e,this._eventDefinitions.startEvent,this._handleStartEventBind),this._utils.addEventListener(e,this._eventDefinitions.moveEvent,this._handleMoveEventBind),this._utils.addEventListener(e,this._eventDefinitions.endEvent,this._handleEndEventBind),this._utils.addEventListener(e,this._eventDefinitions.cancelEvent,this._handleCancelEventBind)):M.debug("TapEvents:_bind - No event definitions. Might be a legacy browser. Aborting bind operation.")}},{key:"_unbind",value:function _unbind(e){this._eventDefinitions&&(e=e.getDocument(),this._utils.removeEventListener(e,this._eventDefinitions.startEvent,this._handleStartEventBind),this._utils.removeEventListener(e,this._eventDefinitions.moveEvent,this._handleMoveEventBind),this._utils.removeEventListener(e,this._eventDefinitions.endEvent,this._handleEndEventBind),this._utils.removeEventListener(e,this._eventDefinitions.cancelEvent,this._handleCancelEventBind))}},{key:"_handleStartEvent",value:function _handleStartEvent(e){for(var t=this._getEventData(e),n=0;n<t.length;n++)this._activeTouchActions[t[n].identifier]={startTime:this.getEventTimestamp(),startX:t[n].touchData.pageX,startY:t[n].touchData.pageY,offsetX:0,offsetY:0}}},{key:"_handleMoveEvent",value:function _handleMoveEvent(e){for(var t=this._getEventData(e),n=0;n<t.length;n++){var r=this._activeTouchActions[t[n].identifier];r&&(r.offsetX=Math.abs(t[n].touchData.pageX-r.startX),r.offsetY=Math.abs(t[n].touchData.pageY-r.startY))}}},{key:"_handleEndEvent",value:function _handleEndEvent(e){for(var t=this._getEventData(e),n=0;n<t.length;n++){var r=this._activeTouchActions[t[n].identifier];r&&(r.offsetX<this._tapMaxSlop&&r.offsetY<this._tapMaxSlop&&(this.getEventTimestamp()-r.startTime<this._longPressTimeout?this._sendEvent("tap_events",Qt,t[n].identifier,t[n].touchData,t[n].eventArgs):this._sendEvent("longpress_events",Ht,t[n].identifier,t[n].touchData,t[n].eventArgs)),delete this._activeTouchActions[t[n].identifier])}}},{key:"_handleCancelEvent",value:function _handleCancelEvent(e){for(var t=this._getEventData(e),n=0;n<t.length;n++)delete this._activeTouchActions[t[n].identifier]}},{key:"_getEventData",value:function _getEventData(e){if(void 0!==e.changedTouches){for(var t=[],n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],o=r.identifier;t.push({identifier:o,touchData:r,eventArgs:e})}return t}if(null!=e.pointerType&&("touch"===e.pointerType||"pen"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_TOUCH||e.pointerType===e.MSPOINTER_TYPE_PEN))return[{identifier:e.pointerId||0,touchData:e,eventArgs:e}];return[]}},{key:"_sendEvent",value:function _sendEvent(e,t,n,r,o){var i=this.getEventTimestamp(),s=re[o.isTrusted],a=this._elements.getElement(o.target),o=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._utils.isUndefinedNull(n)&&(n=0),this._dataQ.addToQueue(e,this._utils.convertToArrayByMap(t,{eventSequence:o,timestamp:i,screenX:r.screenX?Math.round(r.screenX):0,screenY:r.screenY?Math.round(r.screenY):0,pageX:r.pageX||0,pageY:r.pageY||0,clientX:r.clientX||0,clientY:r.clientY||0,isTrusted:s,elementHash:a,touchIndex:n%1e4,touchSizeMajor:r.radiusX?2*r.radiusX:0,touchSizeMinor:r.radiusY?2*r.radiusY:0}))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return At}},{key:"getSupportedTouchEvents",value:function getSupportedTouchEvents(){return window.TouchEvent?{startEvent:"touchstart",moveEvent:"touchmove",endEvent:"touchend",cancelEvent:"touchcancel"}:window.PointerEvent?{startEvent:"pointerdown",moveEvent:"pointermove",endEvent:"pointerup",cancelEvent:"pointercancel"}:void M.debug("TapEvents:_createEventsToListenList - No touch support for browser.")}}]),TapEventCollector}();function StorageEventCollector_typeof(e){return(StorageEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function StorageEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function StorageEventCollector_setPrototypeOf(e,t){return(StorageEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function StorageEventCollector_createSuper(n){var r=function StorageEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=StorageEventCollector_getPrototypeOf(n);return function StorageEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===StorageEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return StorageEventCollector_assertThisInitialized(e)}(this,r?(e=StorageEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function StorageEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function StorageEventCollector_getPrototypeOf(e){return(StorageEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zt={configKey:"isStorageEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!1,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},Kt=0,Vt=["eventSequence","timestamp","keys","action","tabsOpened"],Gt=function(){!function StorageEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&StorageEventCollector_setPrototypeOf(e,t)}(StorageEventCollector,te);var i=StorageEventCollector_createSuper(StorageEventCollector);function StorageEventCollector(e,t,n,r){var o;return function StorageEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StorageEventCollector),(o=i.call(this))._utils=e,o._dataQ=n,o._elements=t,o._msgBus=r,o._onAllStorageEventBinded=o._onAllStorageEvent.bind(StorageEventCollector_assertThisInitialized(o)),o}return function StorageEventCollector_createClass(e,t,n){t&&StorageEventCollector_defineProperties(e.prototype,t),n&&StorageEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StorageEventCollector,[{key:"startFeature",value:function startFeature(e){this._bind(e)}},{key:"stopFeature",value:function stopFeature(e){this._unbind(e)}},{key:"_addToCommunicationQueue",value:function _addToCommunicationQueue(e,t,n,r,o){e===Kt&&this._msgBus.publish("storageEvent",{action:e});e=this.getEventTimestamp(o),o=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._dataQ.addToQueue("storage_events",this._utils.convertToArrayByMap(Vt,{eventSequence:o,timestamp:e,keys:t,action:n,tabsOpened:r}))}},{key:"_bind",value:function _bind(e){var t,n=e.Context;if((n.localStorage||n.sessionStorage)&&(t=["storage"]),this._listeningToEvents=t,0<this._listeningToEvents.length)for(var r=0;r<this._listeningToEvents.length;r++)this._utils.addEventListener(n,this._listeningToEvents[r],this._onAllStorageEventBinded,!0)}},{key:"_unbind",value:function _unbind(e){if(this._listeningToEvents)for(var t=0;t<this._listeningToEvents.length;t++)this._utils.removeEventListener(e.Context,this._listeningToEvents[t],this._onAllStorageEventBinded,!0)}},{key:"_onAllStorageEvent",value:function _onAllStorageEvent(e){return"storage"===e.type&&this._onStorageEvent(e),!0}},{key:"_onStorageEvent",value:function _onStorageEvent(e){var t=!1,n=null,r=null;null===e.key&&(n=null),r="string"==typeof e.key&&null===e.newValue?(n=e.key,"delete"):(n=e.key,"update");var o=this._utils.StorageUtils.getFromLocalStorage("cdTabList");o&&"object"===StorageEventCollector_typeof(o[0])&&(t=!0),t=t?1:0,this._addToCommunicationQueue(e.type,n,r,t,e)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return zt}}]),StorageEventCollector}();function PrintEventCollector_typeof(e){return(PrintEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PrintEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PrintEventCollector_setPrototypeOf(e,t){return(PrintEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PrintEventCollector_createSuper(n){var r=function PrintEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PrintEventCollector_getPrototypeOf(n);return function PrintEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===PrintEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return PrintEventCollector_assertThisInitialized(e)}(this,r?(e=PrintEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PrintEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PrintEventCollector_getPrototypeOf(e){return(PrintEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qt={configKey:"isPrintEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!1,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},Jt=1,Zt=0,Xt=["eventSequence","timestamp","printDialogState"],Yt=function(){!function PrintEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PrintEventCollector_setPrototypeOf(e,t)}(PrintEventCollector,te);var r=PrintEventCollector_createSuper(PrintEventCollector);function PrintEventCollector(e,t){var n;return function PrintEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PrintEventCollector),(n=r.call(this))._utils=e,n._dataQueue=t,n._addToEventQueueFunc=n._addToEventQueue.bind(PrintEventCollector_assertThisInitialized(n)),n._myAfterPrintFunc=n._myAfterPrint.bind(PrintEventCollector_assertThisInitialized(n)),n}return function PrintEventCollector_createClass(e,t,n){t&&PrintEventCollector_defineProperties(e.prototype,t),n&&PrintEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PrintEventCollector,[{key:"_myAfterPrint",value:function _myAfterPrint(){this._addToEventQueueFunc(Zt),window.removeEventListener("focus",this._myAfterPrintFunc)}},{key:"_onBeforePrintEvent",value:function _onBeforePrintEvent(){this._addToEventQueueFunc(Jt),this._utils.addEventListener(window,"focus",this._myAfterPrintFunc.bind(this))}},{key:"_addToEventQueue",value:function _addToEventQueue(e){var t=this.getEventTimestamp(),n=this._utils.StorageUtils.getAndUpdateEventSequenceNumber();this._dataQueue.addToQueue("print_events",this._utils.convertToArrayByMap(Xt,{eventSequence:n,timestamp:t,printDialogState:e}))}},{key:"startFeature",value:function startFeature(){this._utils.addEventListener(window,"beforeprint",this._onBeforePrintEvent.bind(this))}},{key:"stopFeature",value:function stopFeature(){this._utils.removeEventListener(window,"beforeprint",this._onBeforePrintEvent.bind(this),!0)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return qt}}]),PrintEventCollector}();function LightSensorEventCollector_typeof(e){return(LightSensorEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LightSensorEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LightSensorEventCollector_setPrototypeOf(e,t){return(LightSensorEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LightSensorEventCollector_createSuper(n){var r=function LightSensorEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LightSensorEventCollector_getPrototypeOf(n);return function LightSensorEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===LightSensorEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function LightSensorEventCollector_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=LightSensorEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LightSensorEventCollector_getPrototypeOf(e){return(LightSensorEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $t={configKey:"isLightSensor",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!1,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},en=5e3,tn=["eventSequence","timestamp","illuminance"],nn=function(){!function LightSensorEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LightSensorEventCollector_setPrototypeOf(e,t)}(LightSensorEvents,te);var o=LightSensorEventCollector_createSuper(LightSensorEvents);function LightSensorEvents(e,t,n){var r;return function LightSensorEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LightSensorEvents),(r=o.call(this))._dataQueue=e,r._utils=t,r._configurationRepository=n,r._eventThreshold=r._configurationRepository.get("lightSensorEventThreshold")||en,r._lastTime=0,r}return function LightSensorEventCollector_createClass(e,t,n){t&&LightSensorEventCollector_defineProperties(e.prototype,t),n&&LightSensorEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LightSensorEvents,[{key:"_onReadingSensor",value:function _onReadingSensor(){var e,t=this.getEventTimestamp();t-this._lastTime>this._eventThreshold&&(e=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),this._lastTime=t,this._dataQueue.addToQueue("ambient_light_level",this._utils.convertToArrayByMap(tn,{eventSequence:e,timestamp:t,illuminance:this._sensor.illuminance})))}},{key:"startFeature",value:function startFeature(){window.AmbientLightSensor?(M.info("AmbientLightSensor exists and collected"),this._sensor=new AmbientLightSensor,this._utils.addEventListener(this._sensor,"reading",this._onReadingSensor.bind(this)),this._utils.addEventListener(this._sensor,"error",LightSensorEvents._onSensorError),this._sensor.start()):M.debug("LightSensor does not exist, not collecting")}},{key:"stopFeature",value:function stopFeature(){this._sensor&&(this._utils.removeEventListener(this._sensor,"reading",this._onReadingSensor.bind(this)),this._utils.removeEventListener(this._sensor,"error",LightSensorEvents._onSensorError),this._sensor=null)}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){this._eventThreshold=this._configurationRepository.get("lightSensorEventThreshold")?this._configurationRepository.get("lightSensorEventThreshold"):this._eventThreshold}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return $t}},{key:"_onSensorError",value:function _onSensorError(e){M.debug("Error connecting LightSensor ".concat(e.error))}}]),LightSensorEvents}();function MouseEventCollector_typeof(e){return(MouseEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MouseEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MouseEventCollector_setPrototypeOf(e,t){return(MouseEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MouseEventCollector_createSuper(n){var r=function MouseEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=MouseEventCollector_getPrototypeOf(n);return function MouseEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===MouseEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return MouseEventCollector_assertThisInitialized(e)}(this,r?(e=MouseEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function MouseEventCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MouseEventCollector_getPrototypeOf(e){return(MouseEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MouseEventCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rn={configKey:"isMouseEvents",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!0,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},on={mousemove:0,mousedown:1,mouseup:2,click:3,dblclick:4,mouseleave:5,mouseenter:6,wheel:7,mouseout:8,mouseover:9},sn=function(){!function MouseEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MouseEventCollector_setPrototypeOf(e,t)}(MouseEventCollector,te);var s=MouseEventCollector_createSuper(MouseEventCollector);function MouseEventCollector(e,t,n,r,o){var i;return function MouseEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MouseEventCollector),MouseEventCollector_defineProperty(MouseEventCollector_assertThisInitialized(i=s.call(this)),"_lastButton",void 0),MouseEventCollector_defineProperty(MouseEventCollector_assertThisInitialized(i),"_getMouseEvent",function(e){var t=e.which;"mouseup"===e.type?i._lastButton=t:"click"===e.type&&0===t&&(t=i._lastButton);var n=on[e.type];i._utils.isUndefinedNull(n)&&(n=-1);var r=e.deltaY||e.deltaX||e.deltaZ||e.wheelDelta||0,o=i.getTimestampFromEvent(e);i._dataQueue.addToQueue("mouse_events",[null,i._utils.StorageUtils.getAndUpdateEventSequenceNumber(),i.getEventTimestamp(e),n,re[e.isTrusted],"mousemove"===e.type?0:i._elements.getElement(e.target),i._getMouseCoordinates(e.pageX),i._getMouseCoordinates(e.pageY),i._getMouseCoordinates(e.screenX),i._getMouseCoordinates(e.screenY),null==t?-1:t,Math.round(r),e.clientX?Math.round(e.clientX):-1,e.clientY?Math.round(e.clientY):-1,e.detail||0,null===e.button||void 0===e.button?-1:e.button,o])}),i._utils=e,i._domUtils=t,i._elements=n,i._dataQueue=r,i._configurationRepository=o,i}return function MouseEventCollector_createClass(e,t,n){t&&MouseEventCollector_defineProperties(e.prototype,t),n&&MouseEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MouseEventCollector,[{key:"startFeature",value:function startFeature(e){var t=this;try{var n=e.getDocument();this._domUtils.addEventListener(n,"mousemove",this._getMouseEvent,!0),this._domUtils.addEventListener(n,"mousedown",this._getMouseEvent,!0),this._domUtils.addEventListener(n,"mouseup",this._getMouseEvent,!0),this._domUtils.addEventListener(n,"click",this._getMouseEvent,!0),this._domUtils.addEventListener(n,"dblclick",this._getMouseEvent,!0),this._isIE=!!n.documentMode||/edge/.test(window.navigator.userAgent.toLowerCase()),this._isIE?this._domUtils.onDocumentBody(e.Context,function(){t._domUtils.addEventListener(n.body,"mouseleave",t._getMouseEvent),t._domUtils.addEventListener(n.body,"mouseenter",t._getMouseEvent)}):(this._domUtils.addEventListener(n,"mouseleave",this._getMouseEvent),this._domUtils.addEventListener(n,"mouseenter",this._getMouseEvent)),this._domUtils.addEventListener(n,"wheel",this._getMouseEvent,!0)}catch(e){M.error("MouseEvents:startFeature failed. msg: ".concat(e.message),e)}}},{key:"stopFeature",value:function stopFeature(e){try{var t=e.getDocument();this._domUtils.removeEventListener(t,"mousemove",this._getMouseEvent,!0),this._domUtils.removeEventListener(t,"mousedown",this._getMouseEvent,!0),this._domUtils.removeEventListener(t,"mouseup",this._getMouseEvent,!0),this._domUtils.removeEventListener(t,"click",this._getMouseEvent,!0),this._domUtils.removeEventListener(t,"dblclick",this._getMouseEvent,!0),this._isIE?(this._domUtils.removeEventListener(t.body,"mouseleave",this._getMouseEvent),this._domUtils.removeEventListener(t.body,"mouseenter",this._getMouseEvent)):(this._domUtils.removeEventListener(t,"mouseleave",this._getMouseEvent),this._domUtils.removeEventListener(t,"mouseenter",this._getMouseEvent)),this._domUtils.removeEventListener(t,"wheel",this._getMouseEvent,!0)}catch(e){M.error("MouseEvents:stopFeature failed. msg: ".concat(e.message),e)}}},{key:"_getMouseCoordinates",value:function _getMouseCoordinates(e){return this._getConfigurationKey()?-1e3:e?Math.round(e):-1}},{key:"_getConfigurationKey",value:function _getConfigurationKey(){return this._configurationRepository.get(T.enableCoordinatesMasking)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return rn}}]),MouseEventCollector}();function TabEventCollector_typeof(e){return(TabEventCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TabEventCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TabEventCollector_setPrototypeOf(e,t){return(TabEventCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function TabEventCollector_createSuper(n){var r=function TabEventCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=TabEventCollector_getPrototypeOf(n);return function TabEventCollector_possibleConstructorReturn(e,t){{if(t&&("object"===TabEventCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function TabEventCollector_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=TabEventCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function TabEventCollector_getPrototypeOf(e){return(TabEventCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var an={configKey:"isTabsEvents",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},cn=0,un=1,ln=2,fn=["eventSequence","timestamp","type","id","href","referrer","currentTabsList"],pn=function(){!function TabEventCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TabEventCollector_setPrototypeOf(e,t)}(TabEventCollector,te);var r=TabEventCollector_createSuper(TabEventCollector);function TabEventCollector(e,t){var n;return function TabEventCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TabEventCollector),(n=r.call(this))._utils=e,n._currState=null,n._dataQueue=t,n._tabData={id:"",openTabTS:0},n}return function TabEventCollector_createClass(e,t,n){t&&TabEventCollector_defineProperties(e.prototype,t),n&&TabEventCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(TabEventCollector,[{key:"startFeature",value:function startFeature(){M.info("Starting tab events feature"),this._initTabInfo(),this._utils.addEventListener(window,"beforeunload",this._onUnloadTab.bind(this))}},{key:"stopFeature",value:function stopFeature(){M.info("Stopping tab events feature"),this._utils.removeEventListener(window,"beforeunload",this._onUnloadTab.bind(this))}},{key:"_initTabInfo",value:function _initTabInfo(){var e=(e=this._utils.StorageUtils.getFromLocalStorage("cdTabList"))||[],t=cn;this._tabData=this._utils.StorageUtils.getFromSessionStorage("cdTabData")||this._tabData.id,this._tabData||(this._updateTabData(),t=un);for(var n=-1,r=0,o=e.length;r<o;r++)if(e[r][0]===this._tabData.id){n=r;break}-1!==n&&n!==e.length||(e.push([this._tabData.id,this._tabData.openTabTS]),this._utils.StorageUtils.saveToLocalStorage("cdTabList",e),M.debug("added tab to list. "+this._tabData.id+", tab index="+e.length));var i=this._utils.getDocUrl(),s=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),a=JSON.stringify(e);this._dataQueue.addToQueue("tab_events",this._utils.convertToArrayByMap(fn,{eventSequence:s,timestamp:this._tabData.openTabTS,type:t,id:this._tabData.id||"",href:i||"",referrer:this._utils.clearTextFromNumbers(document.referrer),currentTabsList:a||""}))}},{key:"_onUnloadTab",value:function _onUnloadTab(){var e=(e=this._utils.StorageUtils.getFromLocalStorage("cdTabList"))||[],t=this.getEventTimestamp(),n=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),r=this._utils.getDocUrl(),o=ln,i=JSON.stringify(e);M.debug("removing tab from list. id:".concat(this._tabData.id,", timestamp:").concat(t)),this._dataQueue.addToQueue("tab_events",this._utils.convertToArrayByMap(fn,{eventSequence:n,timestamp:t,type:o,id:this._tabData.id||"",href:r||"",referrer:this._utils.clearTextFromNumbers(document.referrer),currentTabsList:i||""}),!0,!0);for(var s=0,a=e.length;s<a;s++)if(e[s][0]===this._tabData.id){e.splice(s,1);break}this._utils.StorageUtils.saveToLocalStorage("cdTabList",e)}},{key:"_updateTabData",value:function _updateTabData(){this._tabData={},this._tabData={id:this._utils.generateUUID(),openTabTS:this.getEventTimestamp()},M.debug("initialize tab data: id:".concat(this._tabData.id,", timestamp:").concat(this._tabData.openTabTS)),this._utils.StorageUtils.saveToSessionStorage("cdTabData",this._tabData)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return an}}]),TabEventCollector}();function LocationCollector_typeof(e){return(LocationCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LocationCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LocationCollector_setPrototypeOf(e,t){return(LocationCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LocationCollector_createSuper(n){var r=function LocationCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LocationCollector_getPrototypeOf(n);return function LocationCollector_possibleConstructorReturn(e,t){{if(t&&("object"===LocationCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return LocationCollector_assertThisInitialized(e)}(this,r?(e=LocationCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LocationCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LocationCollector_getPrototypeOf(e){return(LocationCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LocationCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dn={configKey:"isLocationEvents",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!1,isFrameRelated:!1,runInSlave:!1,runInUns:!1,isRunning:!1,instance:null},yn=["eventSequence","timestamp","longitude","latitude","accuracy","speed","provider"],hn=function(){!function LocationCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LocationCollector_setPrototypeOf(e,t)}(LocationCollector,te);var i=LocationCollector_createSuper(LocationCollector);function LocationCollector(e,t,n){var r,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:window.navigator;return function LocationCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LocationCollector),LocationCollector_defineProperty(LocationCollector_assertThisInitialized(r=i.call(this)),"_subscribeForLocationEvents",function(){r._unsubscribeFromLocationEvents(),r._watcherID=r._navigator.geolocation.watchPosition(r._onGeoLocationPositionEvent,r._onGeoLocationPositionError),r._clearLocationEventsTimeout(),r._locationEventsTimeoutID=setTimeout(function(){r._unsubscribeFromLocationEvents()})}),LocationCollector_defineProperty(LocationCollector_assertThisInitialized(r),"_unsubscribeFromLocationEvents",function(){r._clearLocationEventsTimeout(),r._watcherID&&(r._navigator.geolocation.clearWatch(r._watcherID),r._watcherID=null)}),LocationCollector_defineProperty(LocationCollector_assertThisInitialized(r),"_onGeoLocationPositionEvent",function(e){r._sendData(e)}),LocationCollector_defineProperty(LocationCollector_assertThisInitialized(r),"_onGeoLocationPositionError",function(e){M.warn("Failed getting geolocation with code ".concat(e.code,". ").concat(e.message))}),r._configurationRepository=n,r._locationEventsTimeoutMsec=r._configurationRepository.get(T.locationEventsTimeoutMsec),r._utils=t,r._dataQ=e,r._navigator=o,r._watcherID=null,r._locationEventsTimeoutID=null,r}return function LocationCollector_createClass(e,t,n){t&&LocationCollector_defineProperties(e.prototype,t),n&&LocationCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LocationCollector,[{key:"startFeature",value:function startFeature(){this._subscribeForLocationIfPermissionGranted()}},{key:"stopFeature",value:function stopFeature(){this._unsubscribeFromLocationEvents()}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){try{this._configurationRepository.get(T.locationEventsTimeoutMsec)!==this._locationEventsTimeoutMsec&&(this._locationEventsTimeoutMsec=this._configurationRepository.get(T.locationEventsTimeoutMsec))}catch(e){M.error("LocationEvents: updateFeatureConfig failed, msg: ".concat(e.message),e)}}},{key:"_subscribeForLocationIfPermissionGranted",value:function _subscribeForLocationIfPermissionGranted(){var t=this;this._navigator.permissions&&this._navigator.permissions.query&&this._navigator.permissions.query({name:"geolocation"}).then(function(e){"granted"===e.state?t._subscribeForLocationEvents():M.info("location permission is denied. Location data will not be collected")}).catch(function(e){M.error("Failed querying for geolocation permission. ".concat(e.message))})}},{key:"_clearLocationEventsTimeout",value:function _clearLocationEventsTimeout(){this._locationEventsTimeoutID&&clearTimeout(this._locationEventsTimeoutID),this._locationEventsTimeoutID=null}},{key:"_sendData",value:function _sendData(e){var t=e.coords,n=this._utils.StorageUtils.getAndUpdateEventSequenceNumber(),e=this.getEventTimestamp();this._dataQ.addToQueue("location_events",this._utils.convertToArrayByMap(yn,{eventSequence:n,timestamp:e,longitude:t.longitude||-1,latitude:t.latitude||-1,accuracy:t.accuracy||-1,speed:t.speed||-1,provider:""}))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return dn}}]),LocationCollector}();function BrowserDetectContract_typeof(e){return(BrowserDetectContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BrowserDetectContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BrowserDetectContract_setPrototypeOf(e,t){return(BrowserDetectContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BrowserDetectContract_createSuper(n){var r=function BrowserDetectContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=BrowserDetectContract_getPrototypeOf(n);return function BrowserDetectContract_possibleConstructorReturn(e,t){{if(t&&("object"===BrowserDetectContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function BrowserDetectContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=BrowserDetectContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function BrowserDetectContract_getPrototypeOf(e){return(BrowserDetectContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vn=function(){!function BrowserDetectContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BrowserDetectContract_setPrototypeOf(e,t)}(BrowserDetectContract,qe);var c=BrowserDetectContract_createSuper(BrowserDetectContract);function BrowserDetectContract(e,t,n,r,o,i,s){var a;return function BrowserDetectContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserDetectContract),(a=c.call(this)).validateParams(e,t,n,r,o,i,s),a.isChrome=e,a.isFirefox=t,a.isEdge=n,a.isIE=r,a.isSafari=o,a.isOpera=i,a.isBlink=s,a}return function BrowserDetectContract_createClass(e,t,n){t&&BrowserDetectContract_defineProperties(e.prototype,t),n&&BrowserDetectContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserDetectContract,[{key:"validateParams",value:function validateParams(e,t,n,r,o,i,s){"boolean"==typeof e&&"boolean"==typeof t&&"boolean"==typeof n&&"boolean"==typeof r&&"boolean"==typeof o&&"boolean"==typeof i&&"boolean"==typeof s||M.warn("wrong type in Per, BrowserDetectContract, parameters. isChrome : {expected: boolean, received: ".concat(BrowserDetectContract_typeof(e),"},\n            isFirefox : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(t),"},isEdge : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(n),"},isIE : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(r),"},\n            isSafari : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(o),"},isOpera : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(i),"} ,isBlink : {expected: boolean, received: ").concat(BrowserDetectContract_typeof(s),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),[this.isChrome,this.isFirefox,this.isEdge,this.isIE,this.isSafari,this.isOpera,this.isBlink]];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])&&7===e[1].length||M.warn("BrowserDetect - Contract verification failed")}},{key:"getName",value:function getName(){return"browser_spoofing"}}]),BrowserDetectContract}();function BrowserDetect_typeof(e){return(BrowserDetect_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BrowserDetect_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BrowserDetect_setPrototypeOf(e,t){return(BrowserDetect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BrowserDetect_createSuper(n){var r=function BrowserDetect_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=BrowserDetect_getPrototypeOf(n);return function BrowserDetect_possibleConstructorReturn(e,t){{if(t&&("object"===BrowserDetect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function BrowserDetect_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=BrowserDetect_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function BrowserDetect_getPrototypeOf(e){return(BrowserDetect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _n={configKey:"isBrowserDetect",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},mn=function(){!function BrowserDetect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BrowserDetect_setPrototypeOf(e,t)}(BrowserDetect,te);var n=BrowserDetect_createSuper(BrowserDetect);function BrowserDetect(e){var t;return function BrowserDetect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserDetect),(t=n.call(this))._dataQ=e,t}return function BrowserDetect_createClass(e,t,n){t&&BrowserDetect_defineProperties(e.prototype,t),n&&BrowserDetect_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserDetect,[{key:"startFeature",value:function startFeature(){var e=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),t="undefined"!=typeof InstallTrigger,n=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),r=!!document.documentMode,o=!r&&!!window.StyleMedia,i=!!window.chrome&&!!window.chrome.webstore,s=(i||e)&&!!window.CSS,s=new vn(i,t,o,r,n,e,s).buildQueueMessage();this._dataQ.addToQueue("static_fields",s,!1)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return _n}}]),BrowserDetect}();function OSBrowserPropsContract_typeof(e){return(OSBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OSBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OSBrowserPropsContract_setPrototypeOf(e,t){return(OSBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function OSBrowserPropsContract_createSuper(n){var r=function OSBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=OSBrowserPropsContract_getPrototypeOf(n);return function OSBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===OSBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function OSBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=OSBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function OSBrowserPropsContract_getPrototypeOf(e){return(OSBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gn=function(){!function OSBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OSBrowserPropsContract_setPrototypeOf(e,t)}(OSBrowserPropsContract,qe);var n=OSBrowserPropsContract_createSuper(OSBrowserPropsContract);function OSBrowserPropsContract(e){var t;return function OSBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OSBrowserPropsContract),(t=n.call(this)).validateParams(e),t.platform=e,t}return function OSBrowserPropsContract_createClass(e,t,n){t&&OSBrowserPropsContract_defineProperties(e.prototype,t),n&&OSBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(OSBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in OS, BrowserProps parameters. platform : {expected: string, received: ".concat(OSBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.platform];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("os, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"os"}}]),OSBrowserPropsContract}();function OSVersionBrowserPropsContract_typeof(e){return(OSVersionBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OSVersionBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OSVersionBrowserPropsContract_setPrototypeOf(e,t){return(OSVersionBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function OSVersionBrowserPropsContract_createSuper(n){var r=function OSVersionBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=OSVersionBrowserPropsContract_getPrototypeOf(n);return function OSVersionBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===OSVersionBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function OSVersionBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=OSVersionBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function OSVersionBrowserPropsContract_getPrototypeOf(e){return(OSVersionBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bn=function(){!function OSVersionBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OSVersionBrowserPropsContract_setPrototypeOf(e,t)}(OSVersionBrowserPropsContract,qe);var n=OSVersionBrowserPropsContract_createSuper(OSVersionBrowserPropsContract);function OSVersionBrowserPropsContract(e){var t;return function OSVersionBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OSVersionBrowserPropsContract),(t=n.call(this)).validateParams(e),t.version=e,t}return function OSVersionBrowserPropsContract_createClass(e,t,n){t&&OSVersionBrowserPropsContract_defineProperties(e.prototype,t),n&&OSVersionBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(OSVersionBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e||null===e||M.warn(" wrong type in OSVersion, BrowserProps parameters. version : {expected: number, received: ".concat(OSVersionBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.version];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&("number"==typeof e[1]||null===e[1])||M.warn("os_version, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"os_version"}}]),OSVersionBrowserPropsContract}();function OSFamilyBrowserPropsContract_typeof(e){return(OSFamilyBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OSFamilyBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OSFamilyBrowserPropsContract_setPrototypeOf(e,t){return(OSFamilyBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function OSFamilyBrowserPropsContract_createSuper(n){var r=function OSFamilyBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=OSFamilyBrowserPropsContract_getPrototypeOf(n);return function OSFamilyBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===OSFamilyBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function OSFamilyBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=OSFamilyBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function OSFamilyBrowserPropsContract_getPrototypeOf(e){return(OSFamilyBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cn=function(){!function OSFamilyBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OSFamilyBrowserPropsContract_setPrototypeOf(e,t)}(OSFamilyBrowserPropsContract,qe);var n=OSFamilyBrowserPropsContract_createSuper(OSFamilyBrowserPropsContract);function OSFamilyBrowserPropsContract(e){var t;return function OSFamilyBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OSFamilyBrowserPropsContract),(t=n.call(this)).validateParams(e),t.osName=e,t}return function OSFamilyBrowserPropsContract_createClass(e,t,n){t&&OSFamilyBrowserPropsContract_defineProperties(e.prototype,t),n&&OSFamilyBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(OSFamilyBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in OSFamily, BrowserProps parameters. osName : {expected: string, received: ".concat(OSFamilyBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.osName];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("os_family, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"os_family"}}]),OSFamilyBrowserPropsContract}();function InputMechBrowserPropsContract_typeof(e){return(InputMechBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function InputMechBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function InputMechBrowserPropsContract_setPrototypeOf(e,t){return(InputMechBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function InputMechBrowserPropsContract_createSuper(n){var r=function InputMechBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=InputMechBrowserPropsContract_getPrototypeOf(n);return function InputMechBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===InputMechBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function InputMechBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=InputMechBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function InputMechBrowserPropsContract_getPrototypeOf(e){return(InputMechBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var En=function(){!function InputMechBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&InputMechBrowserPropsContract_setPrototypeOf(e,t)}(InputMechBrowserPropsContract,qe);var r=InputMechBrowserPropsContract_createSuper(InputMechBrowserPropsContract);function InputMechBrowserPropsContract(e,t){var n;return function InputMechBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,InputMechBrowserPropsContract),(n=r.call(this)).validateParams(e,t),n.pointer=e,n.hover=t,n}return function InputMechBrowserPropsContract_createClass(e,t,n){t&&InputMechBrowserPropsContract_defineProperties(e.prototype,t),n&&InputMechBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(InputMechBrowserPropsContract,[{key:"validateParams",value:function validateParams(e,t){("number"!=typeof e||1!==e&&2!==e&&3!==e&&4!==e&&5!==e||"number"!=typeof t||1!==t&&2!==t&&3!==t&&4!==t&&5!==t)&&M.warn(" wrong type in InputMech, BrowserProps parameters. pointer : {expected: number, received: ".concat(InputMechBrowserPropsContract_typeof(e),"}, hover : {expected: number, received: ").concat(InputMechBrowserPropsContract_typeof(t),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),[this.pointer,this.hover]];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])&&2===e[1].length||M.warn("input_mech, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"input_mech"}}]),InputMechBrowserPropsContract}();function CoresBrowserPropsContract_typeof(e){return(CoresBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CoresBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CoresBrowserPropsContract_setPrototypeOf(e,t){return(CoresBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function CoresBrowserPropsContract_createSuper(n){var r=function CoresBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=CoresBrowserPropsContract_getPrototypeOf(n);return function CoresBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===CoresBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function CoresBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=CoresBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function CoresBrowserPropsContract_getPrototypeOf(e){return(CoresBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pn=function(){!function CoresBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CoresBrowserPropsContract_setPrototypeOf(e,t)}(CoresBrowserPropsContract,qe);var n=CoresBrowserPropsContract_createSuper(CoresBrowserPropsContract);function CoresBrowserPropsContract(e){var t;return function CoresBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CoresBrowserPropsContract),(t=n.call(this)).validateParams(e),t.hardwareConcurrency=e,t}return function CoresBrowserPropsContract_createClass(e,t,n){t&&CoresBrowserPropsContract_defineProperties(e.prototype,t),n&&CoresBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CoresBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e||M.warn("wrong type in cores, BrowserProps parameters. hardwareConcurrency : {expected: number, received: ".concat(CoresBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.hardwareConcurrency];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("cores,BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"cores"}}]),CoresBrowserPropsContract}();function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(e,t)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,r=function F(){};return{s:r,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var e=o.next();return c=e.done,e},e:function e(t){u=!0,a=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw a}}}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PluginsBrowserPropsContract_typeof(e){return(PluginsBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PluginsBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PluginsBrowserPropsContract_setPrototypeOf(e,t){return(PluginsBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PluginsBrowserPropsContract_createSuper(n){var r=function PluginsBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PluginsBrowserPropsContract_getPrototypeOf(n);return function PluginsBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===PluginsBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function PluginsBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=PluginsBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PluginsBrowserPropsContract_getPrototypeOf(e){return(PluginsBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wn=function(){!function PluginsBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PluginsBrowserPropsContract_setPrototypeOf(e,t)}(PluginsBrowserPropsContract,qe);var n=PluginsBrowserPropsContract_createSuper(PluginsBrowserPropsContract);function PluginsBrowserPropsContract(e){var t;return function PluginsBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PluginsBrowserPropsContract),(t=n.call(this)).validateParams(e),t.plugins=e,t}return function PluginsBrowserPropsContract_createClass(e,t,n){t&&PluginsBrowserPropsContract_defineProperties(e.prototype,t),n&&PluginsBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PluginsBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){Array.isArray(e)&&this._eachPluginIsValid(e)||M.warn(" wrong type in plugins, BrowserProps parameters. plugins : {expected: [[...string]], received: ".concat(PluginsBrowserPropsContract_typeof(e),"}"))}},{key:"_eachPluginIsValid",value:function _eachPluginIsValid(e){var t=!0,n=!0,r=!0,o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var i=i.value;if(Array.isArray(i)){4!==i.length&&(r=!1);var s,a=_createForOfIteratorHelper(i);try{for(a.s();!(s=a.n()).done;)"string"!=typeof s.value&&(n=!1)}catch(e){a.e(e)}finally{a.f()}}else t=!1}}catch(e){o.e(e)}finally{o.f()}return t&&r&&n}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.plugins];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])||M.warn("plugins, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"plugins"}}]),PluginsBrowserPropsContract}();function JsUaBrowserPropsContract_typeof(e){return(JsUaBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JsUaBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JsUaBrowserPropsContract_setPrototypeOf(e,t){return(JsUaBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function JsUaBrowserPropsContract_createSuper(n){var r=function JsUaBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=JsUaBrowserPropsContract_getPrototypeOf(n);return function JsUaBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===JsUaBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function JsUaBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=JsUaBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function JsUaBrowserPropsContract_getPrototypeOf(e){return(JsUaBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var On=function(){!function JsUaBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JsUaBrowserPropsContract_setPrototypeOf(e,t)}(JsUaBrowserPropsContract,qe);var n=JsUaBrowserPropsContract_createSuper(JsUaBrowserPropsContract);function JsUaBrowserPropsContract(e){var t;return function JsUaBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,JsUaBrowserPropsContract),(t=n.call(this)).validateParams(e),t.userAgent=e,t}return function JsUaBrowserPropsContract_createClass(e,t,n){t&&JsUaBrowserPropsContract_defineProperties(e.prototype,t),n&&JsUaBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(JsUaBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn("wrong type in JsUa, BrowserProps parameters. userAgent : {expected: string, received: ".concat(JsUaBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.userAgent];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("js_ua, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"js_ua"}}]),JsUaBrowserPropsContract}();function TimeZoneBrowserPropsContract_typeof(e){return(TimeZoneBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TimeZoneBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TimeZoneBrowserPropsContract_setPrototypeOf(e,t){return(TimeZoneBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function TimeZoneBrowserPropsContract_createSuper(n){var r=function TimeZoneBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=TimeZoneBrowserPropsContract_getPrototypeOf(n);return function TimeZoneBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===TimeZoneBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function TimeZoneBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=TimeZoneBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function TimeZoneBrowserPropsContract_getPrototypeOf(e){return(TimeZoneBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=function(){!function TimeZoneBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TimeZoneBrowserPropsContract_setPrototypeOf(e,t)}(TimeZoneBrowserPropsContract,qe);var n=TimeZoneBrowserPropsContract_createSuper(TimeZoneBrowserPropsContract);function TimeZoneBrowserPropsContract(e){var t;return function TimeZoneBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TimeZoneBrowserPropsContract),(t=n.call(this)).validateParams(e),t.tz=e,t}return function TimeZoneBrowserPropsContract_createClass(e,t,n){t&&TimeZoneBrowserPropsContract_defineProperties(e.prototype,t),n&&TimeZoneBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(TimeZoneBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e||M.warn("wrong type in TimeZone, BrowserProps parameters. tz : {expected: string, received: ".concat(TimeZoneBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.tz];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("time_zone, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"time_zone"}}]),TimeZoneBrowserPropsContract}();function CookieEnabledBrowserPropsContract_typeof(e){return(CookieEnabledBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CookieEnabledBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CookieEnabledBrowserPropsContract_setPrototypeOf(e,t){return(CookieEnabledBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function CookieEnabledBrowserPropsContract_createSuper(n){var r=function CookieEnabledBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=CookieEnabledBrowserPropsContract_getPrototypeOf(n);return function CookieEnabledBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===CookieEnabledBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function CookieEnabledBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=CookieEnabledBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function CookieEnabledBrowserPropsContract_getPrototypeOf(e){return(CookieEnabledBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kn=function(){!function CookieEnabledBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CookieEnabledBrowserPropsContract_setPrototypeOf(e,t)}(CookieEnabledBrowserPropsContract,qe);var n=CookieEnabledBrowserPropsContract_createSuper(CookieEnabledBrowserPropsContract);function CookieEnabledBrowserPropsContract(e){var t;return function CookieEnabledBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CookieEnabledBrowserPropsContract),(t=n.call(this)).validateParams(e),t.isCookie=e,t}return function CookieEnabledBrowserPropsContract_createClass(e,t,n){t&&CookieEnabledBrowserPropsContract_defineProperties(e.prototype,t),n&&CookieEnabledBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CookieEnabledBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"boolean"==typeof e||M.warn("wrong type in CookieEnabled, BrowserProps parameters. isCookie : {expected: boolean, received: ".concat(CookieEnabledBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.isCookie];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"boolean"==typeof e[1]||M.warn("CookieEnabled,BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"cookie_enabled"}}]),CookieEnabledBrowserPropsContract}();function DeviceMemoryBrowserPropsContract_typeof(e){return(DeviceMemoryBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DeviceMemoryBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DeviceMemoryBrowserPropsContract_setPrototypeOf(e,t){return(DeviceMemoryBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DeviceMemoryBrowserPropsContract_createSuper(n){var r=function DeviceMemoryBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=DeviceMemoryBrowserPropsContract_getPrototypeOf(n);return function DeviceMemoryBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===DeviceMemoryBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function DeviceMemoryBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=DeviceMemoryBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function DeviceMemoryBrowserPropsContract_getPrototypeOf(e){return(DeviceMemoryBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bn=function(){!function DeviceMemoryBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DeviceMemoryBrowserPropsContract_setPrototypeOf(e,t)}(DeviceMemoryBrowserPropsContract,qe);var n=DeviceMemoryBrowserPropsContract_createSuper(DeviceMemoryBrowserPropsContract);function DeviceMemoryBrowserPropsContract(e){var t;return function DeviceMemoryBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceMemoryBrowserPropsContract),(t=n.call(this)).validateParams(e),t.memory=e,t}return function DeviceMemoryBrowserPropsContract_createClass(e,t,n){t&&DeviceMemoryBrowserPropsContract_defineProperties(e.prototype,t),n&&DeviceMemoryBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DeviceMemoryBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e&&(.25===e||.5===e||1===e||2===e||4===e||8===e||0===e)||M.warn("wrong type in DeviceMemoryBrowser, BrowserProps parameters. memory : {expected: number in {0.25, 0.5, 1, 2, 4, 8, 0} received: type:".concat(DeviceMemoryBrowserPropsContract_typeof(e)," value:").concat(e,"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.memory];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("device_memory, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"device_memory"}}]),DeviceMemoryBrowserPropsContract}();function LangBrowserPropsContract_typeof(e){return(LangBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LangBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LangBrowserPropsContract_setPrototypeOf(e,t){return(LangBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LangBrowserPropsContract_createSuper(n){var r=function LangBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LangBrowserPropsContract_getPrototypeOf(n);return function LangBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===LangBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function LangBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=LangBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LangBrowserPropsContract_getPrototypeOf(e){return(LangBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fn=function(){!function LangBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LangBrowserPropsContract_setPrototypeOf(e,t)}(LangBrowserPropsContract,qe);var n=LangBrowserPropsContract_createSuper(LangBrowserPropsContract);function LangBrowserPropsContract(e){var t;return function LangBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LangBrowserPropsContract),(t=n.call(this)).validateParams(e),t.language=e,t}return function LangBrowserPropsContract_createClass(e,t,n){t&&LangBrowserPropsContract_defineProperties(e.prototype,t),n&&LangBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LangBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in Lang, BrowserProps parameters. language : {expected: string, received: ".concat(LangBrowserPropsContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.language];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("main_lang, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"main_lang"}}]),LangBrowserPropsContract}();function LanguagesListBrowserPropsContract_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function LanguagesListBrowserPropsContract_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return LanguagesListBrowserPropsContract_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LanguagesListBrowserPropsContract_arrayLikeToArray(e,t)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,r=function F(){};return{s:r,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var e=o.next();return c=e.done,e},e:function e(t){u=!0,a=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw a}}}}function LanguagesListBrowserPropsContract_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LanguagesListBrowserPropsContract_typeof(e){return(LanguagesListBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LanguagesListBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LanguagesListBrowserPropsContract_setPrototypeOf(e,t){return(LanguagesListBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LanguagesListBrowserPropsContract_createSuper(n){var r=function LanguagesListBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LanguagesListBrowserPropsContract_getPrototypeOf(n);return function LanguagesListBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===LanguagesListBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function LanguagesListBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=LanguagesListBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LanguagesListBrowserPropsContract_getPrototypeOf(e){return(LanguagesListBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dn=function(){!function LanguagesListBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LanguagesListBrowserPropsContract_setPrototypeOf(e,t)}(LanguagesListBrowserPropsContract,qe);var n=LanguagesListBrowserPropsContract_createSuper(LanguagesListBrowserPropsContract);function LanguagesListBrowserPropsContract(e){var t;return function LanguagesListBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LanguagesListBrowserPropsContract),(t=n.call(this)).validateParams(e),t.languagesList=e,t}return function LanguagesListBrowserPropsContract_createClass(e,t,n){t&&LanguagesListBrowserPropsContract_defineProperties(e.prototype,t),n&&LanguagesListBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LanguagesListBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){Array.isArray(e)&&this._eachLangIsValid(e)||M.warn(" wrong type in LanguagesList, BrowserProps parameters. languagesList : {expected: [...string], received: ".concat(LanguagesListBrowserPropsContract_typeof(e),"}"))}},{key:"_eachLangIsValid",value:function _eachLangIsValid(e){var t,n=!0,r=LanguagesListBrowserPropsContract_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;)"string"!=typeof t.value&&(n=!1)}catch(e){r.e(e)}finally{r.f()}return n}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.languagesList];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])||M.warn("languages, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"languages"}}]),LanguagesListBrowserPropsContract}();function BuildIDBrowserPropsContract_typeof(e){return(BuildIDBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BuildIDBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BuildIDBrowserPropsContract_setPrototypeOf(e,t){return(BuildIDBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BuildIDBrowserPropsContract_createSuper(n){var r=function BuildIDBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=BuildIDBrowserPropsContract_getPrototypeOf(n);return function BuildIDBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===BuildIDBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function BuildIDBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=BuildIDBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function BuildIDBrowserPropsContract_getPrototypeOf(e){return(BuildIDBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tn=function(){!function BuildIDBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BuildIDBrowserPropsContract_setPrototypeOf(e,t)}(BuildIDBrowserPropsContract,qe);var n=BuildIDBrowserPropsContract_createSuper(BuildIDBrowserPropsContract);function BuildIDBrowserPropsContract(e){var t;return function BuildIDBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BuildIDBrowserPropsContract),(t=n.call(this)).validateParams(e),t.buildID=e,t}return function BuildIDBrowserPropsContract_createClass(e,t,n){t&&BuildIDBrowserPropsContract_defineProperties(e.prototype,t),n&&BuildIDBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BuildIDBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){void 0!==e&&"string"==typeof e||M.warn("The buildID is either undefined or of a wrong type. Expected string, received: ".concat(BuildIDBrowserPropsContract_typeof(e)))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.buildID];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("navigator_build_id, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"navigator_build_id"}}]),BuildIDBrowserPropsContract}();function MaxTouchPointsBrowserPropsContract_typeof(e){return(MaxTouchPointsBrowserPropsContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MaxTouchPointsBrowserPropsContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MaxTouchPointsBrowserPropsContract_setPrototypeOf(e,t){return(MaxTouchPointsBrowserPropsContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MaxTouchPointsBrowserPropsContract_createSuper(n){var r=function MaxTouchPointsBrowserPropsContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=MaxTouchPointsBrowserPropsContract_getPrototypeOf(n);return function MaxTouchPointsBrowserPropsContract_possibleConstructorReturn(e,t){{if(t&&("object"===MaxTouchPointsBrowserPropsContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function MaxTouchPointsBrowserPropsContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=MaxTouchPointsBrowserPropsContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function MaxTouchPointsBrowserPropsContract_getPrototypeOf(e){return(MaxTouchPointsBrowserPropsContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mn=function(){!function MaxTouchPointsBrowserPropsContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MaxTouchPointsBrowserPropsContract_setPrototypeOf(e,t)}(MaxTouchPointsBrowserPropsContract,qe);var n=MaxTouchPointsBrowserPropsContract_createSuper(MaxTouchPointsBrowserPropsContract);function MaxTouchPointsBrowserPropsContract(e){var t;return function MaxTouchPointsBrowserPropsContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MaxTouchPointsBrowserPropsContract),(t=n.call(this)).validateParams(e),t.maxTouchPoints=e,t}return function MaxTouchPointsBrowserPropsContract_createClass(e,t,n){t&&MaxTouchPointsBrowserPropsContract_defineProperties(e.prototype,t),n&&MaxTouchPointsBrowserPropsContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MaxTouchPointsBrowserPropsContract,[{key:"validateParams",value:function validateParams(e){void 0!==e&&"number"==typeof e||M.warn("wrong type in MaxTouchPointsContract parameters. Expected: number, received: ".concat(MaxTouchPointsBrowserPropsContract_typeof(e)))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.maxTouchPoints];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("navigator_max_touch_points, BrowserPropsContract - Contract verification failed")}},{key:"getName",value:function getName(){return"navigator_max_touch_points"}}]),MaxTouchPointsBrowserPropsContract}();function BrowserPropsFeature_typeof(e){return(BrowserPropsFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BrowserPropsFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BrowserPropsFeature_setPrototypeOf(e,t){return(BrowserPropsFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BrowserPropsFeature_createSuper(n){var r=function BrowserPropsFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=BrowserPropsFeature_getPrototypeOf(n);return function BrowserPropsFeature_possibleConstructorReturn(e,t){{if(t&&("object"===BrowserPropsFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function BrowserPropsFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=BrowserPropsFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function BrowserPropsFeature_getPrototypeOf(e){return(BrowserPropsFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rn={configKey:"collectBrowserProps",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},jn=function(){!function BrowserPropsFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BrowserPropsFeature_setPrototypeOf(e,t)}(BrowserPropsFeature,te);var i=BrowserPropsFeature_createSuper(BrowserPropsFeature);function BrowserPropsFeature(e,t,n,r){var o;return function BrowserPropsFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrowserPropsFeature),(o=i.call(this))._dataQ=e,o._pointerHoverDetector=t,o._utils=n,o._configurationRepository=r,o}return function BrowserPropsFeature_createClass(e,t,n){t&&BrowserPropsFeature_defineProperties(e.prototype,t),n&&BrowserPropsFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BrowserPropsFeature,[{key:"startFeature",value:function startFeature(){var t=this;M.info("Collecting Browser Props");var e=new Je(this._utils.scriptVersion).buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1);e=new Ze("js").buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1),M.info("SDK Version is ".concat(this._utils.scriptVersion));e=BrowserPropsFeature.getLanguage();e&&(this._configurationRepository.get("browserPropsShouldHashLanguageField")&&(M.debug("Hashing language field according to configuration"),e=this._utils.getHash(e).toString()),n=new Fn(e).buildQueueMessage(),this._dataQ.addToQueue("static_fields",n,!1));e=new gn(BrowserPropsFeature.getAvailablePlatform(window.navigator)).buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1);var n=BrowserPropsFeature.getOperatingSystem(),e=new bn(n.version).buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1);n=new Cn(n.name).buildQueueMessage();this._dataQ.addToQueue("static_fields",n,!1);n=this._pointerHoverDetector.getPointerHover(),n=new En(n.pointer,n.hover).buildQueueMessage();this._dataQ.addToQueue("static_fields",n,!1);n=new Pn(window.navigator.hardwareConcurrency||0).buildQueueMessage();this._dataQ.addToQueue("static_fields",n,!1),navigator.languages&&(r=navigator.languages,this._configurationRepository.get("browserPropsShouldHashLanguageField")&&(M.debug("Hashing languages field according to configuration"),r=Array.from(r,function(e){return t._utils.getHash(e).toString()})),r=new Dn(r).buildQueueMessage(),this._dataQ.addToQueue("static_fields",r,!1));var r=BrowserPropsFeature.getPlugins();r&&0<r.length&&(o=new wn(r).buildQueueMessage(),this._dataQ.addToQueue("static_fields",o,!1));var o=new On(navigator.userAgent).buildQueueMessage();this._dataQ.addToQueue("static_fields",o,!1);o=-1*(new Date).getTimezoneOffset(),o=new Sn(o).buildQueueMessage();this._dataQ.addToQueue("static_fields",o,!1);o=BrowserPropsFeature.checkCookie(),o=new kn(o).buildQueueMessage();this._dataQ.addToQueue("static_fields",o,!1);o=navigator.deviceMemory||0,o=new Bn(o).buildQueueMessage();this._dataQ.addToQueue("static_fields",o,!1);o=navigator.buildID;o&&(i=new Tn(o).buildQueueMessage(),this._dataQ.addToQueue("static_fields",i,!1));var i=navigator.maxTouchPoints,i=new Mn(i).buildQueueMessage();this._dataQ.addToQueue("static_fields",i,!1),M.info("Browser Props collected")}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Rn}},{key:"getLanguage",value:function getLanguage(){if(navigator){if(navigator.language)return navigator.language;if(navigator.userLanguage)return navigator.userLanguage}}},{key:"getPlugins",value:function getPlugins(){try{var e=[];if(window.navigator.plugins&&0<window.navigator.plugins.length)for(var t=0,n=window.navigator.plugins.length;t<n;t++)e.push([window.navigator.plugins[t].name,window.navigator.plugins[t].filename,window.navigator.plugins[t].description,window.navigator.plugins[t].version||""]);else if(window.navigator.mimeTypes&&0<window.navigator.mimeTypes.length)for(var r=0;r<window.navigator.mimeTypes.length;r++)e.push([window.navigator.mimeTypes[r].type,"",window.navigator.mimeTypes[r].description,""]);var o=BrowserPropsFeature.isActiveXAndFlashEnabled;return BrowserPropsFeature.augmentWithFlashInIE(e,window.navigator.plugins,o),e}catch(e){M.warn("getPlugins error: ".concat(e.message),e)}}},{key:"checkCookie",value:function checkCookie(){var e=navigator.cookieEnabled;return e||(this._utils.StorageUtils.setCookie("testcookie","1",6e4),e=-1!==document.cookie.indexOf("testcookie")),e}},{key:"getOperatingSystem",value:function getOperatingSystem(){for(var e,t,n=[{name:"Windows Phone",value:"Windows Phone",version:"OS"},{name:"Windows",value:"Win",version:"NT"},{name:"iPhone",value:"iPhone",version:"OS"},{name:"iPad",value:"iPad",version:"OS"},{name:"Kindle",value:"Silk",version:"Silk"},{name:"Android",value:"Android",version:"Android"},{name:"PlayBook",value:"PlayBook",version:"OS"},{name:"BlackBerry",value:"BlackBerry",version:"/"},{name:"Macintosh",value:"Mac",version:"OS X"},{name:"Linux",value:"Linux",version:"rv"},{name:"Palm",value:"Palm",version:"PalmOS"}],r=[BrowserPropsFeature.getAvailablePlatform(window.navigator),navigator.userAgent].join(" "),o="",i="Unknown",s=0;s<n.length;s++)if(new RegExp(n[s].value,"i").test(r)){if(e=new RegExp(n[s].version+"[- /:;]([\\d._]+)","i"),t=r.match(e)){t[1]&&(t=t[1]),t=t.split(/[._]+/);for(var a=0;a<t.length;a++)o+=0===a?t[a]+".":t[a]}i=n[s].name;break}return{version:parseFloat(o)||null,name:i}}},{key:"isActiveXAndFlashEnabled",value:function isActiveXAndFlashEnabled(){try{return Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e){return!1}}},{key:"getAvailablePlatform",value:function getAvailablePlatform(e){return"platform"in e?e.platform:"userAgentData"in e?e.userAgentData.platform:null}},{key:"augmentWithFlashInIE",value:function augmentWithFlashInIE(e,t,n){if("[object PluginArray]"===Object.prototype.toString.call(t))return e;return n()&&e.push(["Flash32_32_0_0_238.ocx",2,"Shockwave Flash","32.0.0.238"]),e}}]),BrowserPropsFeature}();function DoNotTrackContract_typeof(e){return(DoNotTrackContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DoNotTrackContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DoNotTrackContract_setPrototypeOf(e,t){return(DoNotTrackContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DoNotTrackContract_createSuper(n){var r=function DoNotTrackContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=DoNotTrackContract_getPrototypeOf(n);return function DoNotTrackContract_possibleConstructorReturn(e,t){{if(t&&("object"===DoNotTrackContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function DoNotTrackContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=DoNotTrackContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function DoNotTrackContract_getPrototypeOf(e){return(DoNotTrackContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var In=function(){!function DoNotTrackContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DoNotTrackContract_setPrototypeOf(e,t)}(DoNotTrackContract,qe);var n=DoNotTrackContract_createSuper(DoNotTrackContract);function DoNotTrackContract(e){var t;return function DoNotTrackContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DoNotTrackContract),(t=n.call(this)).validateParams(e),t.dnt=e,t}return function DoNotTrackContract_createClass(e,t,n){t&&DoNotTrackContract_defineProperties(e.prototype,t),n&&DoNotTrackContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DoNotTrackContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e&&(0===e||1===e||2===e)||M.warn("wrong type in DoNotTrackContract parameters. dnt : {expected: number in {0,1,2}, received: type: ".concat(DoNotTrackContract_typeof(e),", value: ").concat(e))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.dnt];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("DoNotTrack - Contract verification failed")}},{key:"getName",value:function getName(){return"dnt"}}]),DoNotTrackContract}();function DoNotTrackFeature_typeof(e){return(DoNotTrackFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DoNotTrackFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DoNotTrackFeature_setPrototypeOf(e,t){return(DoNotTrackFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DoNotTrackFeature_createSuper(n){var r=function DoNotTrackFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=DoNotTrackFeature_getPrototypeOf(n);return function DoNotTrackFeature_possibleConstructorReturn(e,t){{if(t&&("object"===DoNotTrackFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function DoNotTrackFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=DoNotTrackFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function DoNotTrackFeature_getPrototypeOf(e){return(DoNotTrackFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xn={configKey:"isDoNotTrack",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},Ln=function(){!function DoNotTrackFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DoNotTrackFeature_setPrototypeOf(e,t)}(DoNotTrackFeature,te);var n=DoNotTrackFeature_createSuper(DoNotTrackFeature);function DoNotTrackFeature(e){var t;return function DoNotTrackFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DoNotTrackFeature),(t=n.call(this))._dataQ=e,t}return function DoNotTrackFeature_createClass(e,t,n){t&&DoNotTrackFeature_defineProperties(e.prototype,t),n&&DoNotTrackFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DoNotTrackFeature,[{key:"startFeature",value:function startFeature(){var e=navigator.doNotTrack;void 0===e&&void 0===(e=window.doNotTrack)&&(e=navigator.msDoNotTrack);e=new In(e=null===e||"unspecified"===e||"0"===e?0:"1"===e?1:2).buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return xn}}]),DoNotTrackFeature}();function GraphicDetectContract_typeof(e){return(GraphicDetectContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GraphicDetectContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GraphicDetectContract_setPrototypeOf(e,t){return(GraphicDetectContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function GraphicDetectContract_createSuper(n){var r=function GraphicDetectContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=GraphicDetectContract_getPrototypeOf(n);return function GraphicDetectContract_possibleConstructorReturn(e,t){{if(t&&("object"===GraphicDetectContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function GraphicDetectContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=GraphicDetectContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function GraphicDetectContract_getPrototypeOf(e){return(GraphicDetectContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var An=function(){!function GraphicDetectContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GraphicDetectContract_setPrototypeOf(e,t)}(GraphicDetectContract,qe);var o=GraphicDetectContract_createSuper(GraphicDetectContract);function GraphicDetectContract(e,t,n){var r;return function GraphicDetectContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GraphicDetectContract),(r=o.call(this)).validateParams(e,t,n),r.renderer=e,r.vendor=t,r.version=n,r}return function GraphicDetectContract_createClass(e,t,n){t&&GraphicDetectContract_defineProperties(e.prototype,t),n&&GraphicDetectContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(GraphicDetectContract,[{key:"validateParams",value:function validateParams(e,t,n){"string"==typeof e&&"string"==typeof t&&"string"==typeof n||M.warn("wrong type in GraphicDetectContract parameters. renderer: {expected: string, received: ".concat(GraphicDetectContract_typeof(e),"}, vendor: {expected: string, received: ").concat(GraphicDetectContract_typeof(t),"},\n            version: {expected: string, received: ").concat(GraphicDetectContract_typeof(n),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),[this.renderer,this.vendor,this.version]];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])&&3===e[1].length||M.warn("GraphicDetect - Contract verification failed")}},{key:"getName",value:function getName(){return"grph_card"}}]),GraphicDetectContract}();function GraphicDetectFeature_typeof(e){return(GraphicDetectFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GraphicDetectFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GraphicDetectFeature_setPrototypeOf(e,t){return(GraphicDetectFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function GraphicDetectFeature_createSuper(n){var r=function GraphicDetectFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=GraphicDetectFeature_getPrototypeOf(n);return function GraphicDetectFeature_possibleConstructorReturn(e,t){{if(t&&("object"===GraphicDetectFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function GraphicDetectFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=GraphicDetectFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function GraphicDetectFeature_getPrototypeOf(e){return(GraphicDetectFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nn={configKey:"isVMDetection",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},Un=function(){!function GraphicDetectFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GraphicDetectFeature_setPrototypeOf(e,t)}(GraphicDetectFeature,te);var n=GraphicDetectFeature_createSuper(GraphicDetectFeature);function GraphicDetectFeature(e){var t;return function GraphicDetectFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GraphicDetectFeature),(t=n.call(this))._dataQ=e,t.canvasId="cd_canvas",t}return function GraphicDetectFeature_createClass(e,t,n){t&&GraphicDetectFeature_defineProperties(e.prototype,t),n&&GraphicDetectFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(GraphicDetectFeature,[{key:"startFeature",value:function startFeature(){try{this._getMappedRenderInfo()}catch(e){M.error("Failed collecting Graphic Card information. ".concat(e))}}},{key:"_getMappedRenderInfo",value:function _getMappedRenderInfo(){M.info("Collecting Graphic Card props");var e,t,n={renderer:"unknown",vendor:"",version:"unknown"};(window.WebGLRenderingContext||window.WebGL2RenderingContext)&&((t=document.createElement("canvas")).id=this.canvasId,!(e=t.getContext("experimental-webgl"))||null!=(t=e.getExtension("WEBGL_debug_renderer_info"))&&(n.renderer=e.getParameter(t.UNMASKED_RENDERER_WEBGL),n.vendor=e.getParameter(t.UNMASKED_VENDOR_WEBGL),-1<n.renderer.indexOf("Intel")&&-1<n.renderer.indexOf("HD Graphics")&&((t=n.renderer.match(/\d+/g))&&(500<(t=t[0])&&t<599&&(n.version="SKL (6th gen core)"),5300<t&&t<6999&&(n.version="BDW (5th gen core)")))));n=new An(n.renderer,n.vendor,n.version).buildQueueMessage();this._dataQ.addToQueue("static_fields",n,!1),M.info("Graphic Card props collected")}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Nn}}]),GraphicDetectFeature}();function MediaDevicesContract_typeof(e){return(MediaDevicesContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MediaDevicesContract_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function MediaDevicesContract_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return MediaDevicesContract_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MediaDevicesContract_arrayLikeToArray(e,t)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,r=function F(){};return{s:r,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var e=o.next();return c=e.done,e},e:function e(t){u=!0,a=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw a}}}}function MediaDevicesContract_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function MediaDevicesContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MediaDevicesContract_setPrototypeOf(e,t){return(MediaDevicesContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MediaDevicesContract_createSuper(n){var r=function MediaDevicesContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=MediaDevicesContract_getPrototypeOf(n);return function MediaDevicesContract_possibleConstructorReturn(e,t){{if(t&&("object"===MediaDevicesContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function MediaDevicesContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=MediaDevicesContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function MediaDevicesContract_getPrototypeOf(e){return(MediaDevicesContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qn=function(){!function MediaDevicesContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MediaDevicesContract_setPrototypeOf(e,t)}(MediaDevicesContract,qe);var n=MediaDevicesContract_createSuper(MediaDevicesContract);function MediaDevicesContract(e){var t;return function MediaDevicesContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MediaDevicesContract),(t=n.call(this)).validateParams(e),t.mediaDevices=e,t}return function MediaDevicesContract_createClass(e,t,n){t&&MediaDevicesContract_defineProperties(e.prototype,t),n&&MediaDevicesContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MediaDevicesContract,[{key:"validateParams",value:function validateParams(e){Array.isArray(e)&&this._eachDeviceIsValid(e)||M.warn(" wrong type in MediaDevicesContract parameters. mediaDevices : {expected: [[...string]], received: ".concat(e,"}"))}},{key:"_eachDeviceIsValid",value:function _eachDeviceIsValid(e){var t=!0,n=!0,r=!0,o=MediaDevicesContract_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var i=i.value;if(Array.isArray(i)){4!==i.length&&(r=!1);var s,a=MediaDevicesContract_createForOfIteratorHelper(i);try{for(a.s();!(s=a.n()).done;)"string"!=typeof s.value&&(n=!1)}catch(e){a.e(e)}finally{a.f()}}else t=!1}}catch(e){o.e(e)}finally{o.f()}return t&&r&&n}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.mediaDevices];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])||M.warn("MediaDevices - Contract verification failed")}},{key:"getName",value:function getName(){return"media_devices"}}]),MediaDevicesContract}();function MediaDevicesFeature_typeof(e){return(MediaDevicesFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MediaDevicesFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MediaDevicesFeature_setPrototypeOf(e,t){return(MediaDevicesFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MediaDevicesFeature_createSuper(n){var r=function MediaDevicesFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=MediaDevicesFeature_getPrototypeOf(n);return function MediaDevicesFeature_possibleConstructorReturn(e,t){{if(t&&("object"===MediaDevicesFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function MediaDevicesFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=MediaDevicesFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function MediaDevicesFeature_getPrototypeOf(e){return(MediaDevicesFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hn={configKey:"isMediaDevices",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},Wn=function(){!function MediaDevicesFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MediaDevicesFeature_setPrototypeOf(e,t)}(MediaDevicesFeature,te);var r=MediaDevicesFeature_createSuper(MediaDevicesFeature);function MediaDevicesFeature(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.navigator;return function MediaDevicesFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MediaDevicesFeature),(t=r.call(this))._dataQ=e,t._navigator=n,t._metric="MediaDevicesFeature",t}return function MediaDevicesFeature_createClass(e,t,n){t&&MediaDevicesFeature_defineProperties(e.prototype,t),n&&MediaDevicesFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MediaDevicesFeature,[{key:"startFeature",value:function startFeature(){var n=this;this._navigator.mediaDevices&&this._navigator.mediaDevices.enumerateDevices&&this._navigator.mediaDevices.enumerateDevices().then(function(e){var t=[];e.forEach(function(e){e=[e.kind||"",e.label||"",e.deviceId||"",e.groupId||""];t.push(e)});e=new Qn(t).buildQueueMessage();n._dataQ.addToQueue("static_fields",e,!1)}).catch(function(e){n.cancelMonitor(n._metric),M.error("MediaDevicesFeature:startFeature failed to enumerateDevices: ".concat(e.message))})}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Hn}}]),MediaDevicesFeature}();function PerUserPermissionContract_typeof(e){return(PerUserPermissionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PerUserPermissionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PerUserPermissionContract_setPrototypeOf(e,t){return(PerUserPermissionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PerUserPermissionContract_createSuper(n){var r=function PerUserPermissionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PerUserPermissionContract_getPrototypeOf(n);return function PerUserPermissionContract_possibleConstructorReturn(e,t){{if(t&&("object"===PerUserPermissionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function PerUserPermissionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=PerUserPermissionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PerUserPermissionContract_getPrototypeOf(e){return(PerUserPermissionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zn=function(){!function PerUserPermissionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PerUserPermissionContract_setPrototypeOf(e,t)}(PerUserPermissionContract,qe);var r=PerUserPermissionContract_createSuper(PerUserPermissionContract);function PerUserPermissionContract(e,t){var n;return function PerUserPermissionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PerUserPermissionContract),(n=r.call(this)).validateParams(e,t),n.per=e,n.state=t,n}return function PerUserPermissionContract_createClass(e,t,n){t&&PerUserPermissionContract_defineProperties(e.prototype,t),n&&PerUserPermissionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PerUserPermissionContract,[{key:"validateParams",value:function validateParams(e,t){"string"==typeof e&&"number"==typeof t||M.warn("wrong type in Per, UserPermissionContract, parameters. per : {expected: string, received: ".concat(PerUserPermissionContract_typeof(e),"}, state : {expected: number, received: ").concat(PerUserPermissionContract_typeof(t),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.state];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("per, UserPermissionContract - Contract verification failed")}},{key:"getName",value:function getName(){return"per_".concat(this.per)}}]),PerUserPermissionContract}();function PerStorageUserPermissionContract_typeof(e){return(PerStorageUserPermissionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PerStorageUserPermissionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PerStorageUserPermissionContract_setPrototypeOf(e,t){return(PerStorageUserPermissionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PerStorageUserPermissionContract_createSuper(n){var r=function PerStorageUserPermissionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PerStorageUserPermissionContract_getPrototypeOf(n);return function PerStorageUserPermissionContract_possibleConstructorReturn(e,t){{if(t&&("object"===PerStorageUserPermissionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function PerStorageUserPermissionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=PerStorageUserPermissionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PerStorageUserPermissionContract_getPrototypeOf(e){return(PerStorageUserPermissionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kn=function(){!function PerStorageUserPermissionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PerStorageUserPermissionContract_setPrototypeOf(e,t)}(PerStorageUserPermissionContract,qe);var n=PerStorageUserPermissionContract_createSuper(PerStorageUserPermissionContract);function PerStorageUserPermissionContract(e){var t;return function PerStorageUserPermissionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PerStorageUserPermissionContract),(t=n.call(this)).validateParams(e),t.persistent=e,t}return function PerStorageUserPermissionContract_createClass(e,t,n){t&&PerStorageUserPermissionContract_defineProperties(e.prototype,t),n&&PerStorageUserPermissionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PerStorageUserPermissionContract,[{key:"validateParams",value:function validateParams(e){"number"==typeof e||M.warn("wrong type in PerStorage , UserPermissionContract, parameters. persistent : {expected: number, received: ".concat(PerStorageUserPermissionContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.persistent];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("per_storage, UserPermissionContract - Contract verification failed")}},{key:"getName",value:function getName(){return"per_storage"}}]),PerStorageUserPermissionContract}();function PerKindUserPermissionContract_typeof(e){return(PerKindUserPermissionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PerKindUserPermissionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PerKindUserPermissionContract_setPrototypeOf(e,t){return(PerKindUserPermissionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function PerKindUserPermissionContract_createSuper(n){var r=function PerKindUserPermissionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=PerKindUserPermissionContract_getPrototypeOf(n);return function PerKindUserPermissionContract_possibleConstructorReturn(e,t){{if(t&&("object"===PerKindUserPermissionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function PerKindUserPermissionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=PerKindUserPermissionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function PerKindUserPermissionContract_getPrototypeOf(e){return(PerKindUserPermissionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vn=function(){!function PerKindUserPermissionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PerKindUserPermissionContract_setPrototypeOf(e,t)}(PerKindUserPermissionContract,qe);var r=PerKindUserPermissionContract_createSuper(PerKindUserPermissionContract);function PerKindUserPermissionContract(e,t){var n;return function PerKindUserPermissionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PerKindUserPermissionContract),(n=r.call(this)).validateParams(e,t),n.kind=e,n.perm=t,n}return function PerKindUserPermissionContract_createClass(e,t,n){t&&PerKindUserPermissionContract_defineProperties(e.prototype,t),n&&PerKindUserPermissionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PerKindUserPermissionContract,[{key:"validateParams",value:function validateParams(e,t){"string"==typeof e&&"number"==typeof t||M.warn("wrong type in PerKind , UserPermissionContract, parameters. kind : {expected: string, received: ".concat(PerKindUserPermissionContract_typeof(e),"}, perm : {expected: number, received: ").concat(PerKindUserPermissionContract_typeof(t),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.perm];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"number"==typeof e[1]||M.warn("PerKind, UserPermissionContract - Contract verification failed")}},{key:"getName",value:function getName(){return"per_".concat(this.kind)}}]),PerKindUserPermissionContract}();function UserPermissions_typeof(e){return(UserPermissions_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UserPermissions_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UserPermissions_setPrototypeOf(e,t){return(UserPermissions_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function UserPermissions_createSuper(n){var r=function UserPermissions_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=UserPermissions_getPrototypeOf(n);return function UserPermissions_possibleConstructorReturn(e,t){{if(t&&("object"===UserPermissions_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function UserPermissions_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=UserPermissions_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function UserPermissions_getPrototypeOf(e){return(UserPermissions_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gn={configKey:"isUserPermissions",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},qn=function(){!function UserPermissions_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UserPermissions_setPrototypeOf(e,t)}(UserPermissions,te);var r=UserPermissions_createSuper(UserPermissions);function UserPermissions(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.navigator;return function UserPermissions_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,UserPermissions),(t=r.call(this))._permDefs={granted:1,prompt:2,denied:3,true:1,false:3},t._permissions=["geolocation","midi","notifications","push"],t._dataQ=e,t._navigator=n,t}return function UserPermissions_createClass(e,t,n){t&&UserPermissions_defineProperties(e.prototype,t),n&&UserPermissions_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(UserPermissions,[{key:"startFeature",value:function startFeature(){this._reportQueryPermissions(),this._reportStoragePermission(),this._reportMicCameraPermissions()}},{key:"_reportQueryPermissions",value:function _reportQueryPermissions(){var r=this;this._navigator.permissions&&this._navigator.permissions.query&&function(){for(var n=M,e=function _loop(e){var t=r._permissions[e];r._navigator.permissions.query({name:t}).then(function(e){e=r._permDefs[e.state]||-1,e=new zn(t,e).buildQueueMessage();r._dataQ.addToQueue("static_fields",e,!1)}).catch(function(e){n.debug("Failed querying for ".concat(t," permissions ").concat(e.message))})},t=0;t<r._permissions.length;t++)e(t)}()}},{key:"_reportStoragePermission",value:function _reportStoragePermission(){var t=this;this._navigator.storage&&this._navigator.storage.persisted&&this._navigator.storage.persisted().then(function(e){e=new Kn(t._permDefs[e]||-1).buildQueueMessage();t._dataQ.addToQueue("static_fields",e,!1)}).catch(function(e){M.debug("Failed to check storage persisted: ".concat(e.message))})}},{key:"_reportMicCameraPermissions",value:function _reportMicCameraPermissions(){var n=this,r={audio:!1,video:!1};this._navigator.mediaDevices&&this._navigator.mediaDevices.enumerateDevices&&this._navigator.mediaDevices.enumerateDevices().then(function(e){e.forEach(function(e){var t;!function isAlreadyReported(e){return e.includes("audio")&&r.audio||e.includes("video")&&r.video}(e.kind)&&(t=function updateReported(e){return e.includes("audio")?(r.audio=!0,"audio"):e.includes("video")?(r.video=!0,"video"):void 0}(e.kind),e=""!==e.label?n._permDefs.granted:n._permDefs.denied,e=new Vn(t,e).buildQueueMessage(),n._dataQ.addToQueue("static_fields",e,!1))})}).catch(function(e){M.debug("UserPermissions:startFeature failed to enumerateDevices: ".concat(e.message))})}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Gn}}]),UserPermissions}();function IsPrivateBrowsingContract_typeof(e){return(IsPrivateBrowsingContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IsPrivateBrowsingContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IsPrivateBrowsingContract_setPrototypeOf(e,t){return(IsPrivateBrowsingContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function IsPrivateBrowsingContract_createSuper(n){var r=function IsPrivateBrowsingContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=IsPrivateBrowsingContract_getPrototypeOf(n);return function IsPrivateBrowsingContract_possibleConstructorReturn(e,t){{if(t&&("object"===IsPrivateBrowsingContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function IsPrivateBrowsingContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=IsPrivateBrowsingContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function IsPrivateBrowsingContract_getPrototypeOf(e){return(IsPrivateBrowsingContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jn=function(){!function IsPrivateBrowsingContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IsPrivateBrowsingContract_setPrototypeOf(e,t)}(IsPrivateBrowsingContract,qe);var n=IsPrivateBrowsingContract_createSuper(IsPrivateBrowsingContract);function IsPrivateBrowsingContract(e){var t;return function IsPrivateBrowsingContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,IsPrivateBrowsingContract),(t=n.call(this)).validateParams(e),t.isPrivate=e,t}return function IsPrivateBrowsingContract_createClass(e,t,n){t&&IsPrivateBrowsingContract_defineProperties(e.prototype,t),n&&IsPrivateBrowsingContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(IsPrivateBrowsingContract,[{key:"validateParams",value:function validateParams(e){"boolean"==typeof e||M.warn("wrong type in IsPrivateBrowsingContract parameters. isPrivate : {expected: boolean, received: ".concat(IsPrivateBrowsingContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.isPrivate];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"boolean"==typeof e[1]||M.warn("IsPrivateBrowsing - Contract verification failed")}},{key:"getName",value:function getName(){return"is_private_browsing"}}]),IsPrivateBrowsingContract}();function IsPrivateBrowsingFeature_typeof(e){return(IsPrivateBrowsingFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IsPrivateBrowsingFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IsPrivateBrowsingFeature_setPrototypeOf(e,t){return(IsPrivateBrowsingFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function IsPrivateBrowsingFeature_createSuper(n){var r=function IsPrivateBrowsingFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=IsPrivateBrowsingFeature_getPrototypeOf(n);return function IsPrivateBrowsingFeature_possibleConstructorReturn(e,t){{if(t&&("object"===IsPrivateBrowsingFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function IsPrivateBrowsingFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=IsPrivateBrowsingFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function IsPrivateBrowsingFeature_getPrototypeOf(e){return(IsPrivateBrowsingFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zn={configKey:"isPrivateBrowsing",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},Xn=function(){!function IsPrivateBrowsingFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IsPrivateBrowsingFeature_setPrototypeOf(e,t)}(IsPrivateBrowsingFeature,te);var r=IsPrivateBrowsingFeature_createSuper(IsPrivateBrowsingFeature);function IsPrivateBrowsingFeature(e,t){var n;return function IsPrivateBrowsingFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,IsPrivateBrowsingFeature),(n=r.call(this))._dataQ=e,n._privateBrowsingDetector=t,n}return function IsPrivateBrowsingFeature_createClass(e,t,n){t&&IsPrivateBrowsingFeature_defineProperties(e.prototype,t),n&&IsPrivateBrowsingFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(IsPrivateBrowsingFeature,[{key:"startFeature",value:function startFeature(){var t=this;this._privateBrowsingDetector.detectPrivateMode(function(e){e=new Jn(e).buildQueueMessage();t._dataQ.addToQueue("static_fields",e,!1)})}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return Zn}}]),IsPrivateBrowsingFeature}();function LegacyFontsDetectionContract_typeof(e){return(LegacyFontsDetectionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LegacyFontsDetectionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LegacyFontsDetectionContract_setPrototypeOf(e,t){return(LegacyFontsDetectionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function LegacyFontsDetectionContract_createSuper(n){var r=function LegacyFontsDetectionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=LegacyFontsDetectionContract_getPrototypeOf(n);return function LegacyFontsDetectionContract_possibleConstructorReturn(e,t){{if(t&&("object"===LegacyFontsDetectionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function LegacyFontsDetectionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=LegacyFontsDetectionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function LegacyFontsDetectionContract_getPrototypeOf(e){return(LegacyFontsDetectionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yn=function(){!function LegacyFontsDetectionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LegacyFontsDetectionContract_setPrototypeOf(e,t)}(LegacyFontsDetectionContract,qe);var n=LegacyFontsDetectionContract_createSuper(LegacyFontsDetectionContract);function LegacyFontsDetectionContract(e){var t;return function LegacyFontsDetectionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LegacyFontsDetectionContract),(t=n.call(this)).validateParams(e),t.legacyFonts=e,t}return function LegacyFontsDetectionContract_createClass(e,t,n){t&&LegacyFontsDetectionContract_defineProperties(e.prototype,t),n&&LegacyFontsDetectionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(LegacyFontsDetectionContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in LegacyFontsDetectionContract parameters. legacyFonts : {expected: string, received: ".concat(LegacyFontsDetectionContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.legacyFonts];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("legacy_fonts, FontsDetection - Contract verification failed")}},{key:"getName",value:function getName(){return"legacy_fonts"}}]),LegacyFontsDetectionContract}();function ProblematicFontsDetectionContract_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function ProblematicFontsDetectionContract_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return ProblematicFontsDetectionContract_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ProblematicFontsDetectionContract_arrayLikeToArray(e,t)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,r=function F(){};return{s:r,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var e=o.next();return c=e.done,e},e:function e(t){u=!0,a=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw a}}}}function ProblematicFontsDetectionContract_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ProblematicFontsDetectionContract_typeof(e){return(ProblematicFontsDetectionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ProblematicFontsDetectionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ProblematicFontsDetectionContract_setPrototypeOf(e,t){return(ProblematicFontsDetectionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ProblematicFontsDetectionContract_createSuper(n){var r=function ProblematicFontsDetectionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ProblematicFontsDetectionContract_getPrototypeOf(n);return function ProblematicFontsDetectionContract_possibleConstructorReturn(e,t){{if(t&&("object"===ProblematicFontsDetectionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function ProblematicFontsDetectionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=ProblematicFontsDetectionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ProblematicFontsDetectionContract_getPrototypeOf(e){return(ProblematicFontsDetectionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $n=function(){!function ProblematicFontsDetectionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ProblematicFontsDetectionContract_setPrototypeOf(e,t)}(ProblematicFontsDetectionContract,qe);var n=ProblematicFontsDetectionContract_createSuper(ProblematicFontsDetectionContract);function ProblematicFontsDetectionContract(e){var t;return function ProblematicFontsDetectionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ProblematicFontsDetectionContract),(t=n.call(this)).validateParams(e),t.allFontsDiffs=e,t}return function ProblematicFontsDetectionContract_createClass(e,t,n){t&&ProblematicFontsDetectionContract_defineProperties(e.prototype,t),n&&ProblematicFontsDetectionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ProblematicFontsDetectionContract,[{key:"validateParams",value:function validateParams(e){Array.isArray(e)&&this._eachFontIsValid(e)||M.warn(" wrong type in ProblematicFontsDetectionContract parameters. allFontsDiffs : {expected: [[string, number,number]], received: ".concat(ProblematicFontsDetectionContract_typeof(e),"}"))}},{key:"_eachFontIsValid",value:function _eachFontIsValid(e){var t=!0,n=!0,r=!0,o=ProblematicFontsDetectionContract_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var i=i.value;Array.isArray(i)?(3!==i.length&&(r=!1),n="string"==typeof i[0]&&"number"==typeof i[1]&&"number"==typeof i[2]):t=!1}}catch(e){o.e(e)}finally{o.f()}return t&&r&&n}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.allFontsDiffs];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&Array.isArray(e[1])||M.warn("problematic_fonts, FontsDetection - Contract verification failed")}},{key:"getName",value:function getName(){return"problematic_fonts"}}]),ProblematicFontsDetectionContract}();function FontsNotCachedFontsDetectionContract_typeof(e){return(FontsNotCachedFontsDetectionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FontsNotCachedFontsDetectionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FontsNotCachedFontsDetectionContract_setPrototypeOf(e,t){return(FontsNotCachedFontsDetectionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FontsNotCachedFontsDetectionContract_createSuper(n){var r=function FontsNotCachedFontsDetectionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FontsNotCachedFontsDetectionContract_getPrototypeOf(n);return function FontsNotCachedFontsDetectionContract_possibleConstructorReturn(e,t){{if(t&&("object"===FontsNotCachedFontsDetectionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function FontsNotCachedFontsDetectionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=FontsNotCachedFontsDetectionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FontsNotCachedFontsDetectionContract_getPrototypeOf(e){return(FontsNotCachedFontsDetectionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var er=function(){!function FontsNotCachedFontsDetectionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FontsNotCachedFontsDetectionContract_setPrototypeOf(e,t)}(FontsNotCachedFontsDetectionContract,qe);var n=FontsNotCachedFontsDetectionContract_createSuper(FontsNotCachedFontsDetectionContract);function FontsNotCachedFontsDetectionContract(e){var t;return function FontsNotCachedFontsDetectionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FontsNotCachedFontsDetectionContract),(t=n.call(this)).validateParams(e),t.fontListNotCached=e,t}return function FontsNotCachedFontsDetectionContract_createClass(e,t,n){t&&FontsNotCachedFontsDetectionContract_defineProperties(e.prototype,t),n&&FontsNotCachedFontsDetectionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FontsNotCachedFontsDetectionContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in FontsNotCachedFontsDetectionContract parameters. fontListNotCached : {expected: string, received: ".concat(FontsNotCachedFontsDetectionContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.fontListNotCached];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("fonts_not_cached, FontsDetection - Contract verification failed")}},{key:"getName",value:function getName(){return"fonts_not_cached"}}]),FontsNotCachedFontsDetectionContract}();function FontListFontsDetectionContract_typeof(e){return(FontListFontsDetectionContract_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FontListFontsDetectionContract_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FontListFontsDetectionContract_setPrototypeOf(e,t){return(FontListFontsDetectionContract_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FontListFontsDetectionContract_createSuper(n){var r=function FontListFontsDetectionContract_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FontListFontsDetectionContract_getPrototypeOf(n);return function FontListFontsDetectionContract_possibleConstructorReturn(e,t){{if(t&&("object"===FontListFontsDetectionContract_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function FontListFontsDetectionContract_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=FontListFontsDetectionContract_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FontListFontsDetectionContract_getPrototypeOf(e){return(FontListFontsDetectionContract_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tr=function(){!function FontListFontsDetectionContract_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FontListFontsDetectionContract_setPrototypeOf(e,t)}(FontListFontsDetectionContract,qe);var n=FontListFontsDetectionContract_createSuper(FontListFontsDetectionContract);function FontListFontsDetectionContract(e){var t;return function FontListFontsDetectionContract_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FontListFontsDetectionContract),(t=n.call(this)).validateParams(e),t.fontListCached=e,t}return function FontListFontsDetectionContract_createClass(e,t,n){t&&FontListFontsDetectionContract_defineProperties(e.prototype,t),n&&FontListFontsDetectionContract_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FontListFontsDetectionContract,[{key:"validateParams",value:function validateParams(e){"string"==typeof e||M.warn(" wrong type in FontListFontsDetectionContract parameters. fontListCached : {expected: string, received: ".concat(FontListFontsDetectionContract_typeof(e),"}"))}},{key:"buildQueueMessage",value:function buildQueueMessage(){var e=[this.getName(),this.fontListCached];return this.validateMessage(e),e}},{key:"validateMessage",value:function validateMessage(e){"string"==typeof e[0]&&"string"==typeof e[1]||M.warn("FontList, FontsDetection - Contract verification failed")}},{key:"getName",value:function getName(){return"fonts"}}]),FontListFontsDetectionContract}();function FontsDetectionFeature_typeof(e){return(FontsDetectionFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FontsDetectionFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FontsDetectionFeature_setPrototypeOf(e,t){return(FontsDetectionFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FontsDetectionFeature_createSuper(n){var r=function FontsDetectionFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FontsDetectionFeature_getPrototypeOf(n);return function FontsDetectionFeature_possibleConstructorReturn(e,t){{if(t&&("object"===FontsDetectionFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function FontsDetectionFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=FontsDetectionFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FontsDetectionFeature_getPrototypeOf(e){return(FontsDetectionFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nr={configKey:"isFonts",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},rr=function(){!function FontsDetectionFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FontsDetectionFeature_setPrototypeOf(e,t)}(FontsDetectionFeature,te);var i=FontsDetectionFeature_createSuper(FontsDetectionFeature);function FontsDetectionFeature(e,t,n,r){var o;return function FontsDetectionFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FontsDetectionFeature),(o=i.call(this))._utils=e,o._domUtils=t,o._dataQ=n,o._fontDetectorCtor=r,o._storageKeyName="detectedFonts_2.1.5",o._legacyStorageKeyName="detectedFonts",o._serif_fonts=["adobe jenson","adobe text","albertus","aldus","alexandria","algerian","american typewriter","antiqua","arno","aster","aurora","baskerville","bell","bembo","bembo schoolbook","benguiat","berkeley old style","bernhard modern","bodoni","book antiqua","bookman","bordeaux roman","californian fb","calisto","capitals","cambria","cartier","caslon","caslon antique","catull","centaur","century old style","century schoolbook","new century schoolbook","chaparral","charis sil","cheltenham","clearface","cochin","colonna","computer modern","concrete roman","constantia","cooper black","corona","dejavu fonts","ecotype","elephant","espy serif","excelsior","fairfield","ff scala","footlight","freeserif","friz quadrata","garamond","gentium","georgia","gloucester","goudy old style","goudy schoolbook","goudy pro font","granjon","heather","hercules","high tower text","hiroshige","hoefler text","humana serif","imprint","ionic no. 5","janson","jenson","joanna","korinna","kursivschrift","legacy serif","lexicon","liberation fonts","linux libertine","literaturnaya","lucida","melior","memphis","miller","minion","didone","mona lisa","mrs eaves","ms serif","new york","nimbus roman","nps rawlinson roadway","ocr a extended","palatino","perpetua","plantin","plantin schoolbook","playbill","poor richard","rawlinson roadway","renault","requiem","roman","rotis serif","sabon","seagull","sistina","souvenir","stix","stone informal","stone serif","sylfaen","times new roman","times","trajan","trinit","trump mediaeval","utopia","vale type","bitstream vera","versailles","wanted","weiss","wide latin","windsor","xits","apex","archer","athens","city","cholla slab","clarendon","courier","egyptienne","guardian egyptian","lexia","museo slab","rockwell","nilland","skeleton antique","tower"],o._sans_serif_fonts=["abadi","agency fb","akzidenz grotesk","aptifer","arial","arial unicode ms","avant garde","avenir","bank gothic","barmeno","bauhaus","bell centennial","bell gothic","benguiat gothic","berlin sans","beteckna","brandon grotesque","cabin","cafeteria","calibri","century gothic","charcoal","chicago","clearface gothic","clearview","co headline","co text","compacta","corbel","ff dax","dotum","droid","dyslexie","ecofont","eras","espy sans","nu sans","eurocrat","eurostile","ff meta","flama","formata","freesans","franklin gothic","frutiger","futura","geneva","gill sans","gill sans schoolbook","gotham","handel gothic","denmark","haettenschweiler","hei","helvetica","helvetica neue","swiss 721","highway gothic","hiroshige sans","hobo","impact","industria","interstate","johnston","kabel","lato","legacy sans","lexia readable","meiryo","microgramma","motorway","ms sans serif","museo sans","myriad","neutraface","neuzeit s","news gothic","nimbus sans l","nina","optima","parisine","pricedown","prima sans","pt sans","rail alphabet","revue","roboto","rotis sans","ff scala sans","segoe","skia","souvenir gothic","stone sans","syntax","tahoma","template gothic","tiresias","trade gothic","transport alphabet","trebuchet ms","trump gothic","tw cen","twentieth century","ubuntu font family","univers","zurich","verdana","virtue"],o._monospace_fonts=["andale mono","anonymous","consolas","courierhp","courier new","courierps","fontcraft courier","everson mono","fedra mono","fixed","fixedsys","fixedsys excelsior","inconsolata","hyperfont","letter gothic","magnetic ink character recognition","menlo","miriam fixed","monaco","monofur","monospace","ms gothic","ms mincho","nimbus mono l","ocr-a","ocr-b","orator","ormaxx","pragmatapro","prestige elite","profont","proggy programming fonts","small fonts","sydnie","terminal","tex gyre cursor","um typewriter","william monospace","balloon","brush script","dragonwick","choc","dom casual","mistral","papyrus","tempus sans","amazone","ams euler","apple chancery","aristocrat","bickley script","civitype","codex","edwardian script","forte","french script","kuenstler script","monotype corsiva","old english text mt","palace script","park avenue","scriptina","shelley volante","vivaldi","vladimir script","zapf chancery","zapfino","andy","ashley script","chalkboard","comic sans","cezanne","fontoon","irregularis","jefferson","kristen","lucida handwriting","rage italic","rufscript","scribble","soupbone","tekton","alecko","cinderella","cupola","curlz","magnificat","script","american text","cloister black","fraktur","goudy text","old english text","wedding text","aegyptus","aharoni","aisha","amienne","batak script","chandas","hanacaraka","japanese gothic typeface","jomolhari","kochi font","lontara script","maiola","minch","mona font","nassim","nastaliq navees","neacademia","perpetua greek","simsun","skolar","skolar devanagari","sundanese unicode","sutturah","tai le valentinium","tengwar","tibetan machine uni","tunga","wadalab","apple symbols","bookshelf symbol 7","braille","commercial pi","corel","erler dingbats","hm phonetic","mathematical pi","morse code","opensymbol","richstyle","symbol","symbolps","wingdings","wingdings 2","wingdings 3","webdings","zapf dingbats","abracadabra","ad lib","allegro","andreas","arnold bcklin","astur","balloon pop outlaw black","banco","beat","braggadocio","broadway","ellington","exablock","exocet","fig script","gigi","harlow solid","harrington","horizon","jim crow","jokerman","juice","lo-type","magneto","megadeth","neuland","peignot","ravie","san francisco","showcard gothic","snap","stencil","umbra","westminster","willow","bagel","lithos","aldhabi","andalus","angsana new","angsanaupc","aparajita","arabic typesetting","arial black","arial narrow","arial rounded mt bold","baskerville old face","batang","batangche","bauhaus 93","bell mt","berlin sans fb","berlin sans fb demi","bernard mt condensed","blackadder itc","bodoni mt","bodoni mt black","bodoni mt condensed","bodoni mt poster compressed","bookman old style","bradley hand itc","britannic bold","browallia new","browalliaupc","brush script mt","buxton sketch","calibri light","calisto mt","cambria math","candara","castellar","century","chiller","colonna mt","comic sans ms","copperplate gothic bold","copperplate gothic light","cordia new","cordiaupc","curlz mt","daunpenh","david","dfkai-sb","dilleniaupc","dokchampa","dotumche","ebrima","edwardian script itc","engravers mt","eras bold itc","eras demi itc","eras light itc","eras medium itc","estrangelo edessa","eucrosiaupc","euphemia","fangsong","felix titling","footlight mt light","franklin gothic book","franklin gothic demi","franklin gothic demi cond","franklin gothic heavy","franklin gothic medium","franklin gothic medium cond","frankruehl","freesiaupc","freestyle script","french script mt","gabriola","gadugi","gautami","gill sans mt","gill sans mt condensed","gill sans mt ext condensed bold","gill sans ultra bold","gill sans ultra bold condensed","gisha","gloucester mt extra condensed","goudy stout","gulim","gulimche","gungsuh","gungsuhche","harlow solid italic","imprint mt shadow","informal roman","irisupc","iskoola pota","jasmineupc","javanese text","juice itc","kaiti","kalinga","kartika","khmer ui","kodchiangupc","kokila","kristen itc","kunstler script","lao ui","latha","leelawadee","leelawadee ui","leelawadee ui semilight","levenim mt","lilyupc","lucida bright","lucida calligraphy","lucida console","lucida fax","lucida sans","lucida sans typewriter","lucida sans unicode","maiandra gd","malgun gothic","mangal","marlett","matura mt script capitals","meiryo ui","microsoft himalaya","microsoft jhenghei","microsoft jhenghei light","microsoft jhenghei ui","microsoft jhenghei ui light","microsoft new tai lue","microsoft phagspa","microsoft sans serif","microsoft tai le","microsoft uighur","microsoft yahei","microsoft yahei light","microsoft yahei ui","microsoft yahei ui light","microsoft yi baiti","mingliu","mingliu-extb","mingliu_hkscs","mingliu_hkscs-extb","miriam","modern","modern no. 20","mongolian baiti","moolboran","ms outlook","ms pgothic","ms pmincho","ms reference sans serif","ms reference specialty","ms ui gothic","mt extra","mv boli","myanmar text","narkisim","niagara engraved","niagara solid","nirmala ui","nirmala ui semilight","nsimsun","nyala","onyx","palace script mt","palatino linotype","parchment","perpetua titling mt","plantagenet cherokee","pmingliu","pmingliu-extb","pristina","raavi","rockwell condensed","rockwell extra bold","rod","sakkal majalla","script mt bold","segoe marker","segoe print","segoe script","segoe ui","segoe ui black","segoe ui emoji","segoe ui light","segoe ui semibold","segoe ui semilight","segoe ui symbol","shonar bangla","shruti","simhei","simplified arabic","simplified arabic fixed","simsun-extb","sitka banner","sitka display","sitka heading","sitka small","sitka subheading","sitka text","sketchflow print","snap itc","system","tempus sans itc","traditional arabic","tw cen mt","tw cen mt condensed","tw cen mt condensed extra bold","urdu typesetting","utsaah","vani","vijaya","viner hand itc","vrinda","yu gothic","yu gothic light","yu mincho","yu mincho demibold","yu mincho light"],o}return function FontsDetectionFeature_createClass(e,t,n){t&&FontsDetectionFeature_defineProperties(e.prototype,t),n&&FontsDetectionFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FontsDetectionFeature,[{key:"startFeature",value:function startFeature(){var t=this;M.info("Collecting Fonts");var n=(n=this._utils.StorageUtils.getFromLocalStorage(this._storageKeyName))||this._utils.StorageUtils.getFromLocalStorage(this._legacyStorageKeyName),r=this._utils.StorageUtils.getFromLocalStorage(this._legacyStorageKeyName,!1);r&&M.info("Detected legacy fonts data in the local storage. Will send them to server."),n&&this._utils.StorageUtils.saveToLocalStorage(this._storageKeyName,n),this._detectFonts(function(e){(!n||600<=n.split(",").length)&&(n=e,t._utils.StorageUtils.saveToLocalStorage(t._storageKeyName,n)),t._updateFonts(n,e,r),M.info("Fonts collected")})}},{key:"_detectFonts",value:function _detectFonts(o){var e=this;this._domUtils.onDocumentBody(window,function(){var r=new e._fontDetectorCtor(e._domUtils);r.init(function(){var t,n=e;n._utils.asyncCall.call(r.detectByChunksWithIndex,r,n._serif_fonts,2,function(e){t=e,n._utils.asyncCall.call(r.detectByChunksWithIndex,r,n._sans_serif_fonts,1,function(e){t=t.concat(e),n._utils.asyncCall.call(r.detectByChunksWithIndex,r,n._monospace_fonts,0,function(e){600<=(t=t.concat(e)).length?(e=r.getAllFontsDiffs(),e=new $n(e).buildQueueMessage(),n._dataQ.addToQueue("static_fields",e,!1)):o(t.toString()),r.clear()})})})})})}},{key:"_updateFonts",value:function _updateFonts(e,t,n){e=new tr(e).buildQueueMessage();this._dataQ.addToQueue("static_fields",e,!1);t=new er(t).buildQueueMessage();this._dataQ.addToQueue("static_fields",t,!1),n&&(n=new Yn(n).buildQueueMessage(),this._dataQ.addToQueue("static_fields",n,!1))}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return nr}}]),FontsDetectionFeature}();function ContextPropsFeature_typeof(e){return(ContextPropsFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ContextPropsFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ContextPropsFeature_setPrototypeOf(e,t){return(ContextPropsFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ContextPropsFeature_createSuper(n){var r=function ContextPropsFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ContextPropsFeature_getPrototypeOf(n);return function ContextPropsFeature_possibleConstructorReturn(e,t){{if(t&&("object"===ContextPropsFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ContextPropsFeature_assertThisInitialized(e)}(this,r?(e=ContextPropsFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ContextPropsFeature_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ContextPropsFeature_getPrototypeOf(e){return(ContextPropsFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var or={configKey:"isContextPropsFeature",isDefault:!1,shouldRunPerContext:!0,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},ir=function(){!function ContextPropsFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ContextPropsFeature_setPrototypeOf(e,t)}(ContextPropsFeature,te);var o=ContextPropsFeature_createSuper(ContextPropsFeature);function ContextPropsFeature(e,t,n){var r;return function ContextPropsFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ContextPropsFeature),(r=o.call(this))._dataQ=e,r._domUtils=t,r._perfMonitor=n,r._observerCallback=r._observerCallback.bind(ContextPropsFeature_assertThisInitialized(r)),r.calcTime=r.calcTime.bind(ContextPropsFeature_assertThisInitialized(r)),r._getEntriesByType=r._getEntriesByType.bind(ContextPropsFeature_assertThisInitialized(r)),r}return function ContextPropsFeature_createClass(e,t,n){t&&ContextPropsFeature_defineProperties(e.prototype,t),n&&ContextPropsFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ContextPropsFeature,[{key:"startFeature",value:function startFeature(){var e,t;self.screen&&(e=window.devicePixelRatio||-1,t=window.devicePixelRatio||-1,this._dataQ.addToQueue("static_fields",["display",[screen.colorDepth,screen.width,screen.height,screen.availHeight||-1,screen.availWidth||-1,e,t]],!1)),this.reportPageLoadTime()}},{key:"_observerCallback",value:function _observerCallback(e,t){e=e.getEntries()[0];e.duration&&(this.calcTime(e),"disconnect"in t&&t.disconnect())}},{key:"_isEntrySupportedByBrowser",value:function _isEntrySupportedByBrowser(e){return!("supportedEntryTypes"in window.PerformanceObserver)||PerformanceObserver.supportedEntryTypes.includes(e)}},{key:"_getEntriesByType",value:function _getEntriesByType(){var e;window.performance.timing&&window.performance.timing.loadEventEnd&&window.performance.timing.navigationStart&&(e={duration:window.performance.timing.loadEventEnd-window.performance.timing.navigationStart},this.calcTime(e))}},{key:"calcTime",value:function calcTime(e){f.isUndefinedNull(e)?M.warn("Context Props Feature: no entries of navigation timing were captured"):f.isUndefinedNull(e)||!f.isUndefinedNull(e.duration)?this._perfMonitor.reportMonitor("t.timeTillPageLoad",Math.round(e.duration)):M.warn("Context Props Feature: page duration loading was not calculated")}},{key:"reportPageLoadTime",value:function reportPageLoadTime(){if(window.performance&&"PerformanceNavigationTiming"in window){var e="navigation";if("PerformanceObserver"in window&&this._isEntrySupportedByBrowser(e)){var t=new PerformanceObserver(this._observerCallback);try{t.observe({type:e,buffered:!0})}catch(e){this.reportPageLoadTimeFallback()}}else this.reportPageLoadTimeFallback()}else this.reportPageLoadTimeFallback()}},{key:"reportPageLoadTimeFallback",value:function reportPageLoadTimeFallback(){var e=this;Z.isWindowDocumentReady(window)?f.asyncCall.call(this._getEntriesByType):f.addEventListener(self,"load",function(){f.asyncCall.call(e._getEntriesByType)})}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return or}}]),ContextPropsFeature}();function ScriptsFeature_typeof(e){return(ScriptsFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ScriptsFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ScriptsFeature_setPrototypeOf(e,t){return(ScriptsFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ScriptsFeature_createSuper(n){var r=function ScriptsFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ScriptsFeature_getPrototypeOf(n);return function ScriptsFeature_possibleConstructorReturn(e,t){{if(t&&("object"===ScriptsFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ScriptsFeature_assertThisInitialized(e)}(this,r?(e=ScriptsFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ScriptsFeature_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ScriptsFeature_getPrototypeOf(e){return(ScriptsFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sr={configKey:"isScriptsFeature",isDefault:!1,shouldRunPerContext:!0,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInUns:!0,runInSlave:!1,isRunning:!1,instance:null},ar=function(){!function ScriptsFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ScriptsFeature_setPrototypeOf(e,t)}(ScriptsFeature,te);var r=ScriptsFeature_createSuper(ScriptsFeature);function ScriptsFeature(e,t){var n;return function ScriptsFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ScriptsFeature),(n=r.call(this))._dataQ=e,n._timeoutValue=1e3,n._scriptsRepository=t,n._runDetectionLoopBinded=n._runDetectionLoop.bind(ScriptsFeature_assertThisInitialized(n)),n}return function ScriptsFeature_createClass(e,t,n){t&&ScriptsFeature_defineProperties(e.prototype,t),n&&ScriptsFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ScriptsFeature,[{key:"_checkScriptsData",value:function _checkScriptsData(){for(var e=document.scripts,t=0;t<e.length;t++){var n={src:e[t].src,text:e[t].text};this._scriptsRepository.exists(n)||(this._scriptsRepository.add(n),this._dataQ.addToQueue("scripts",[null,n.src,n.textHash]))}}},{key:"_runDetectionLoop",value:function _runDetectionLoop(){this._checkScriptsData(),this._timer=setTimeout(this._runDetectionLoopBinded,this._timeoutValue),this._timeoutValue<536870911&&(this._timeoutValue*=4)}},{key:"startFeature",value:function startFeature(){this._runDetectionLoop()}},{key:"stopFeature",value:function stopFeature(){this._timer&&clearTimeout(this._timer)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return sr}}]),ScriptsFeature}();function FilesFeature_typeof(e){return(FilesFeature_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FilesFeature_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FilesFeature_setPrototypeOf(e,t){return(FilesFeature_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FilesFeature_createSuper(n){var r=function FilesFeature_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FilesFeature_getPrototypeOf(n);return function FilesFeature_possibleConstructorReturn(e,t){{if(t&&("object"===FilesFeature_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return function FilesFeature_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=FilesFeature_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FilesFeature_getPrototypeOf(e){return(FilesFeature_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cr={configKey:"isFilesFeature",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!0,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},ur=function(){!function FilesFeature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FilesFeature_setPrototypeOf(e,t)}(FilesFeature,te);var s=FilesFeature_createSuper(FilesFeature);function FilesFeature(e,t,n,r,o){var i;return function FilesFeature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FilesFeature),(i=s.call(this))._utils=t,i._configurationRepository=e,i._sessionService=n,i._muidService=r,i._cidCache=o,i}return function FilesFeature_createClass(e,t,n){t&&FilesFeature_defineProperties(e.prototype,t),n&&FilesFeature_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FilesFeature,[{key:"getFiles",value:function getFiles(){if(this._customerId&&this._muid&&this._sid&&this._addrList&&0<this._addrList.length)for(var e,t=0;t<this._addrList.length;t++)e=this._addrList[t]+"?cid="+this._customerId+"&snum="+this._sid+"&muid="+this._muid,this._utils.getPostUrl(e,"GET",null,null,null),this._isSent=!0}},{key:"startFeature",value:function startFeature(){this._isSent=!1;try{this._addrList=JSON.parse(this._configurationRepository.get("getAddrList"))}catch(e){this._addrList=""}this._customerId=this._cidCache.get()||"",this._muid=this._muidService.muid||"",this._sid=this._sessionService.sessionId||"",this.getFiles()}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){try{this._addrList=JSON.parse(this._configurationRepository.get("getAddrList"))}catch(e){this._addrList=""}this._customerId=this._cidCache.get()||"",this._muid=this._muidService.muid||"",this._sid=this._sessionService.sessionId||"",this._isSent||this.getFiles()}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return cr}}]),FilesFeature}();function MetadataCollector_typeof(e){return(MetadataCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MetadataCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MetadataCollector_setPrototypeOf(e,t){return(MetadataCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MetadataCollector_createSuper(n){var r=function MetadataCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=MetadataCollector_getPrototypeOf(n);return function MetadataCollector_possibleConstructorReturn(e,t){{if(t&&("object"===MetadataCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return MetadataCollector_assertThisInitialized(e)}(this,r?(e=MetadataCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function MetadataCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MetadataCollector_getPrototypeOf(e){return(MetadataCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lr={configKey:"isMetadataCollect",isDefault:!0,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInSlave:!0,runInUns:!1,isRunning:!1,instance:null},fr=function(){!function MetadataCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MetadataCollector_setPrototypeOf(e,t)}(MetadataCollector,te);var i=MetadataCollector_createSuper(MetadataCollector);function MetadataCollector(e,t,n,r){var o;return function MetadataCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MetadataCollector),(o=i.call(this))._configurationRepository=e,o._dataQ=t,o._metaDataSiteMapper=n,o._utils=r,o._metaDataSiteMapper.updateObserver(o.onSiteMapperMatch.bind(MetadataCollector_assertThisInitialized(o))),o}return function MetadataCollector_createClass(e,t,n){t&&MetadataCollector_defineProperties(e.prototype,t),n&&MetadataCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MetadataCollector,[{key:"startFeature",value:function startFeature(){this._metaDataSiteMapper.initTracking()}},{key:"stopFeature",value:function stopFeature(){this._metaDataSiteMapper.stopTracking()}},{key:"onSiteMapperMatch",value:function onSiteMapperMatch(e){M.debug("Metadata Collector mapper match - ".concat(JSON.stringify(e))),e.metaVal&&this._dataQ.addToQueue("metadata_map",[null,e.metaVal,this._utils.dateNow()])}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){this._metaDataSiteMapper.onConfigUpdate(this._configurationRepository)}}],[{key:"getDefaultSettings",value:function getDefaultSettings(){return lr}}]),MetadataCollector}(),pr=null,dr=null,yr=null,hr=null;function _bindInputEvents(e){pr.removeElementEvents(e),pr.addElementEvents(e,!0)}function _bindOnClickEvents(e){dr.removeElementEvents(e),dr.addElementEvents(e,!0)}function _bindOnChangeEvents(e){yr.removeElementEvents(e),yr.addElementEvents(e,!0)}function _bindOnFormsEvents(e){hr.removeElementEvents(e),hr.addElementEvents(e,!0)}function CrossDomainMuidCollector_ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function CrossDomainMuidCollector_objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?CrossDomainMuidCollector_ownKeys(Object(n),!0).forEach(function(e){CrossDomainMuidCollector_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CrossDomainMuidCollector_ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function CrossDomainMuidCollector_typeof(e){return(CrossDomainMuidCollector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CrossDomainMuidCollector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CrossDomainMuidCollector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CrossDomainMuidCollector_createClass(e,t,n){return t&&CrossDomainMuidCollector_defineProperties(e.prototype,t),n&&CrossDomainMuidCollector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function CrossDomainMuidCollector_setPrototypeOf(e,t){return(CrossDomainMuidCollector_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function CrossDomainMuidCollector_createSuper(n){var r=function CrossDomainMuidCollector_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=CrossDomainMuidCollector_getPrototypeOf(n);return function CrossDomainMuidCollector_possibleConstructorReturn(e,t){{if(t&&("object"===CrossDomainMuidCollector_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return CrossDomainMuidCollector_assertThisInitialized(e)}(this,r?(e=CrossDomainMuidCollector_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function CrossDomainMuidCollector_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CrossDomainMuidCollector_getPrototypeOf(e){return(CrossDomainMuidCollector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CrossDomainMuidCollector_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vr={configKey:"isCrossdomain",isDefault:!1,shouldRunPerContext:!1,shouldRunPerSession:!1,shouldRun:!0,isFrameRelated:!1,runInUns:!1,runInSlave:!1,isRunning:!1,instance:null},_r={found:0,new:1},mr=/(?=(child\-src)|(frame\-src))([^;]+)/gi,gr=/http[s]?:\/\/([^\/]+)/gi,br={resource:null,iframeElement:!1,blockedByCSP:!1,iframeLoaded:!1,ACKMessageSent:!1,ACKMessageRecieved:!1,unavailable:!1},Cr=["eventSequence","timestamp","eventType","domainUrl","muid"],Er=function(){!function CrossDomainMuidCollector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CrossDomainMuidCollector_setPrototypeOf(e,t)}(CrossDomainMuidCollector,te);var t=CrossDomainMuidCollector_createSuper(CrossDomainMuidCollector);function CrossDomainMuidCollector(e){var i;return CrossDomainMuidCollector_classCallCheck(this,CrossDomainMuidCollector),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i=t.call(this)),"startFeature",function(e){i._domainsResources=i._configurationRepository.get(T.crossDomainsList),i._crossDomainsTimeout=i._configurationRepository.get(T.crossDomainsTimeout),Array.isArray(i._domainsResources)&&0<i._domainsResources.length&&(i._windowMessageEmitter.startObserver(e),i._domainsResources.forEach(function(e){var t=e.match(gr);null!==t&&"string"==typeof t[0]&&(t=t[0],"object"!==CrossDomainMuidCollector_typeof(i._domainsStates[t])&&(i._domainsStates[t]=CrossDomainMuidCollector_objectSpread({},br),i._domainsStates[t].resource=e,i._domains.push(t)))}),Array.isArray(i._domains)&&0<i._domains.length&&(i.isBlockedByCSP(e,i._domains),i._domUtils.onDocumentBody(e.Context,function(){i.connectDomains(e)})))}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"stopFeature",function(e){i._clearFeaturesObjects(e)}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"_clearFeaturesObjects",function(t){i._windowMessageEmitter.stopObserver(t),Array.isArray(i._domains)&&0<i._domains.length&&(i._domains.forEach(function(e){i.clearDomElements(t,e)}),i._domains=[],i._domainsStates={})}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"connectDomains",function(t){Array.isArray(i._domains)&&0<i._domains.length&&(i._domains.forEach(function(e){i._domainsStates[e].blockedByCSP||!1!==i._domainsStates[e].iframeElement||i.createIframe(t,e)}),i._domainsTimeoutFunc=setTimeout(function(){i._domains.forEach(function(e){"object"===CrossDomainMuidCollector_typeof(i._domainsStates[e])&&!1===i._domainsStates[e].ACKMessageRecieved&&!1===i._domainsStates[e].unavailable&&(M.warn("Cross Domain feature - domain ".concat(e," is unavailable")),i._domainsStates[e].unavailable=!0,i.clearDomElements(t,e))})},i._crossDomainsTimeout))}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"createIframe",function(e,t){var n=e.getDocument().createElement("iframe");n.onload=function(){i.postNextMessage(t)},n.id=A.ignorePrefixFrame+CrossDomainMuidCollector.generateRandomID(),n.src=i._domainsStates[t].resource,n.style.display="none",n.style.opacity="0",n.width="1",n.height="1",e.getDocument().body.appendChild(n),i._domainsStates[t].iframeElement=n}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"clearDomElements",function(e,t){var n=i._domainsStates[t].iframeElement;"object"===CrossDomainMuidCollector_typeof(n)&&null!==e.getDocument().getElementById(i._domainsStates[t].iframeElement.id)&&e.getDocument().body.removeChild(n)}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"postNextMessage",function(e){var t;!i._domainsStates[e].ACKMessageRecieved&&i._domainsStates[e].iframeElement&&(t={muid:i._generatedMUID},i._domainsStates[e].iframeElement.contentWindow.postMessage(JSON.stringify(t),e),i._domainsStates[e].ACKMessageSent=!0)}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"isBlockedByCSP",function(e,n){if(!Array.isArray(n)||n.length<1)throw new Error("Domains are expected for content security policy assertion");var r=!1;[].slice.call(e.getDocument().getElementsByTagName("meta")).forEach(function(e){var t;if("Content-Security-Policy"===e.getAttribute("http-equiv")&&(r=!0,t=e.getAttribute("content").match(mr),n.forEach(function(e){t&&-1===t[0].indexOf(e)&&"object"===CrossDomainMuidCollector_typeof(i._domainsStates[e])&&(i._domainsStates[e].blockedByCSP=!0,M.warn("Cross Domain feature - domain ".concat(e," is blocked by CSP")))})),r)return!1})}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"windowMessageHandler",function(e){var t=e.message.origin;i._domainsStates.hasOwnProperty(t)&&!0!==i._domainsStates[t].ACKMessageRecieved&&(i._domainsStates[t].ACKMessageRecieved=!0,i.clearDomElements(new j(e.message.currentTarget),t),e=e.message.data,i.sendToQueue(t,e))}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"sendToQueue",function(e,r){var o=e.replace(/http[s]?:\/\//i,"");"object"===CrossDomainMuidCollector_typeof(r.found)&&Object.keys(r.found).forEach(function(e){var t=i._utils.StorageUtils.getAndUpdateEventSequenceNumber(),n=o,e=r.found[e].split("__"),e={eventType:i._eventType.found,eventSequence:t,domainUrl:n,muid:e[0],timestamp:e[1]};i._dataQ.addToQueue("crossmuid_event",i._utils.convertToArrayByMap(Cr,e),!0)}),"object"===CrossDomainMuidCollector_typeof(r.new)&&Object.keys(r.new).forEach(function(e){var t=i._utils.StorageUtils.getAndUpdateEventSequenceNumber(),n=o,e=r.new[e].split("__"),e={eventType:i._eventType.new,eventSequence:t,domainUrl:n,muid:e[0],timestamp:e[1]};i._dataQ.addToQueue("crossmuid_event",i._utils.convertToArrayByMap(Cr,e))}),"object"===CrossDomainMuidCollector_typeof(r.error_message)&&M.warn("Cross Domain feature - domain ".concat(o," error. Error Message: \n                ").concat(r.error_message," Code: ").concat(r.error_code))}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"updateFeatureConfig",function(e){i._domainsResources=i._configurationRepository.get(T.crossDomainsList),i._crossDomainsTimeout=i._configurationRepository.get(T.crossDomainsTimeout),clearTimeout(i._domainsTimeoutFunc),i._domainsTimeoutFunc=null,i.updateDomainStates(e)}),CrossDomainMuidCollector_defineProperty(CrossDomainMuidCollector_assertThisInitialized(i),"updateDomainStates",function(e){Array.isArray(i._domainsResources)&&0<i._domainsResources.length&&(i._domains=[],i._domainsResources.forEach(function(e){var t=e.match(gr);null!==t&&"string"==typeof t[0]&&(t=t[0],"object"!==CrossDomainMuidCollector_typeof(i._domainsStates[t])&&(i._domainsStates[t]=CrossDomainMuidCollector_objectSpread({},br),i._domainsStates[t].resource=e),i._domains.push(t))}),Array.isArray(i._domains)&&0<i._domains.length&&(i.isBlockedByCSP(e,i._domains),i._domUtils.onDocumentBody(e.Context,function(){i.connectDomains(e)})))}),i._configurationRepository=e.configurationRepository,i._dataQ=e.dataQ,i._utils=e.utils,i._domUtils=e.domUtils,i._eventType=e.eventType,i._messageBus=e.messageBus,i._windowMessageEmitter=e.windowMessageEventEmitter,i._messageBus.subscribe(_.WindowMessageEvent,i.windowMessageHandler),i._generatedMUID=i._utils.dateNow()+"-"+i._utils.generateUUID().toUpperCase(),i._domainsStates={},i._domainsResources=[],i._domains=[],i._domainsTimeoutFunc=null,i}return CrossDomainMuidCollector_createClass(CrossDomainMuidCollector,null,[{key:"getDefaultSettings",value:function getDefaultSettings(){return vr}},{key:"Builder",get:function get(){return function(){function Builder(e,t,n,r,o){CrossDomainMuidCollector_classCallCheck(this,Builder),this.configurationRepository=e,this.dataQ=t,this.utils=n,this.domUtils=r,this.eventType=o}return CrossDomainMuidCollector_createClass(Builder,[{key:"withMessageBus",value:function withMessageBus(e){return this.messageBus=e,this}},{key:"withWindowMessageEventEmitter",value:function withWindowMessageEventEmitter(e){return this.windowMessageEventEmitter=e,this}},{key:"build",value:function build(){return new CrossDomainMuidCollector(this)}}]),Builder}()}},{key:"generateRandomID",value:function generateRandomID(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}}]),CrossDomainMuidCollector}();function Event_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pr=function(){function Event(){!function Event_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Event)}return function Event_createClass(e,t,n){t&&Event_defineProperties(e.prototype,t),n&&Event_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(Event,[{key:"getEventTimestamp",value:function getEventTimestamp(){return f.dateNow()}},{key:"getTimestampFromEvent",value:function getTimestampFromEvent(e){return e.timeStamp?f.cutDecimalPointDigits(e.timeStamp,3):0}},{key:"updateFeatureConfig",value:function updateFeatureConfig(){}}]),Event}();function InputEvents_typeof(e){return(InputEvents_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function InputEvents_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function InputEvents_setPrototypeOf(e,t){return(InputEvents_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function InputEvents_createSuper(n){var r=function InputEvents_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=InputEvents_getPrototypeOf(n);return function InputEvents_possibleConstructorReturn(e,t){{if(t&&("object"===InputEvents_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return InputEvents_assertThisInitialized(e)}(this,r?(e=InputEvents_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function InputEvents_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function InputEvents_getPrototypeOf(e){return(InputEvents_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function InputEvents_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ad(s){return{applyAction:function _applyAction(e,t,n){if(!["start","stop"].includes(t))return!1;for(var r=[],o=e.getDocument().querySelectorAll(wr),i=0;i<o.length;i++)r.push(o[i]);0<r.length&&s[t](r,e.Context,n)}}}var wr="input:not([type='color']):not([type='hidden']):not([type='file']):not([type='image']):not([type='button']):not([type='radio']):not([type='checkbox']), textarea",Or=function(){!function InputEvents_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&InputEvents_setPrototypeOf(e,t)}(InputEvents,Pr);var u=InputEvents_createSuper(InputEvents);function InputEvents(e,t,n,r,o,i,s,a){var c;return function InputEvents_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,InputEvents),InputEvents_defineProperty(InputEvents_assertThisInitialized(c=u.call(this)),"handleInputEvents",function(e){"InputEvent"===e.constructor.name&&c._inputEventsPerElement.set(e.target,{});var t=e.target.value||"";""!==t&&(t=c._maskingService.maskText(t)),c._sendToQueue(e,{length:t?t.length:0,elementValues:t,selected:-1})}),InputEvents_defineProperty(InputEvents_assertThisInitialized(c),"handleFocusBlurEvents",function(e){c._sendToQueue(e,{length:0,selected:-1,elementValues:""})}),InputEvents_defineProperty(InputEvents_assertThisInitialized(c),"handleSyntheticInputEvents",function(e){var t;c._inputEventsPerElement.has(e.target)&&(void 0===e.jQueryMask||"autotab"!==e.jQueryMask&&"prasleyValidator"!==e.jQueryMask)||(""!==(t=e.target.value||"")&&(t=c._maskingService.maskText(t)),c._sendToQueue(e,{length:t?t.length:0,elementValues:t,selected:-1}))}),c._elements=e,c._sendToQueue=t,c._messageBus=r,c._CDUtils=n,c._StandardInputEventsEmitter=o,c._SyntheticMaskInputEventsHandler=i,c._SyntheticAutotabInputEventsHandler=s,c._maskingService=a,c._inputEventsPerElement=new WeakMap,c}return function InputEvents_createClass(e,t,n){t&&InputEvents_defineProperties(e.prototype,t),n&&InputEvents_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(InputEvents,[{key:"bind",value:function bind(e){this._messageBus.subscribe(_.StandardInputEvent,this.handleInputEvents),this._messageBus.subscribe(_.StandardInputFocusEvent,this.handleFocusBlurEvents),this._messageBus.subscribe(_.StandardInputBlurEvent,this.handleFocusBlurEvents),this._messageBus.subscribe(_.SyntheticInputMaskEvent,this.handleSyntheticInputEvents),Ad(this._StandardInputEventsEmitter).applyAction(e,"start"),Ad(this._SyntheticMaskInputEventsHandler).applyAction(e,"start"),Ad(this._SyntheticAutotabInputEventsHandler).applyAction(e,"start")}},{key:"unbind",value:function unbind(e){Ad(this._StandardInputEventsEmitter).applyAction(e,"stop"),Ad(this._SyntheticMaskInputEventsHandler).applyAction(e,"stop"),Ad(this._SyntheticAutotabInputEventsHandler).applyAction(e,"stop"),this._messageBus.unsubscribe(_.StandardInputEvent,this.handleInputEvents),this._messageBus.unsubscribe(_.StandardInputFocusEvent,this.handleFocusBlurEvents),this._messageBus.unsubscribe(_.StandardInputBlurEvent,this.handleFocusBlurEvents),this._messageBus.unsubscribe(_.SyntheticInputMaskEvent,this.handleSyntheticInputEvents)}},{key:"addOnLoadInputData",value:function addOnLoadInputData(e,t){for(var n=e.getDocument().querySelectorAll(wr),r=0;r<n.length;r++){var o=n[r];this._elements.isListed(o)?t||this._elements.resendElementPerContext(o):this._elements.getElement(o,!1)}}}]),InputEvents}();function ClickEvents_typeof(e){return(ClickEvents_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ClickEvents_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ClickEvents_setPrototypeOf(e,t){return(ClickEvents_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ClickEvents_createSuper(n){var r=function ClickEvents_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=ClickEvents_getPrototypeOf(n);return function ClickEvents_possibleConstructorReturn(e,t){{if(t&&("object"===ClickEvents_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return ClickEvents_assertThisInitialized(e)}(this,r?(e=ClickEvents_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function ClickEvents_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ClickEvents_getPrototypeOf(e){return(ClickEvents_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sr="input[type='button'], input[type='radio'], input[type='checkbox'], button",kr=function(){!function ClickEvents_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ClickEvents_setPrototypeOf(e,t)}(ClickEvents,Pr);var s=ClickEvents_createSuper(ClickEvents);function ClickEvents(e,t,n,r,o){var i;return function ClickEvents_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ClickEvents),function ClickEvents_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ClickEvents_assertThisInitialized(i=s.call(this)),"handleOnClickEvents",function(e){var t=e.target,n=t.value||t.innerHTML||"",n=i._shouldMaskValueField?i._CDUtils.maskText(n):i._CDUtils.clearTextFromNumbers(n);i._sendToQueue(e,{length:n.length,elementValues:n,selected:void 0===t.checked?-1:t.checked?1:0})}),i._sendToQueue=e,i._CDUtils=t,i._messageBus=n,i._StandardOnClickEventsEmitter=o,i._configurationRepository=r,i._shouldMaskValueField=r.get(T.shouldMaskClickEventValueField),i}return function ClickEvents_createClass(e,t,n){t&&ClickEvents_defineProperties(e.prototype,t),n&&ClickEvents_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ClickEvents,[{key:"bind",value:function bind(e){e=e.getDocument();this._messageBus.subscribe(_.StandardOnClickEvent,this.handleOnClickEvents),this.addListenersBySelector(e)}},{key:"unbind",value:function unbind(e){for(var t=[],n=e.getDocument().querySelectorAll(Sr),r=0;r<n.length;r++)t.push(n[r]);this._StandardOnClickEventsEmitter.stop(t),this._messageBus.unsubscribe(_.StandardOnClickEvent,this.handleOnClickEvents)}},{key:"addListenersBySelector",value:function addListenersBySelector(e){for(var t=[],n=e.querySelectorAll(Sr),r=0;r<n.length;r++)t.push(n[r]);this._StandardOnClickEventsEmitter.start(t)}},{key:"updateSettings",value:function updateSettings(){this._shouldMaskValueField=this._configurationRepository.get(T.shouldMaskClickEventValueField)}}]),ClickEvents}();function SelectElementEvents_typeof(e){return(SelectElementEvents_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SelectElementEvents_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SelectElementEvents_setPrototypeOf(e,t){return(SelectElementEvents_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function SelectElementEvents_createSuper(n){var r=function SelectElementEvents_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=SelectElementEvents_getPrototypeOf(n);return function SelectElementEvents_possibleConstructorReturn(e,t){{if(t&&("object"===SelectElementEvents_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return SelectElementEvents_assertThisInitialized(e)}(this,r?(e=SelectElementEvents_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function SelectElementEvents_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SelectElementEvents_getPrototypeOf(e){return(SelectElementEvents_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SelectElementEvents_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Br=function(){!function SelectElementEvents_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SelectElementEvents_setPrototypeOf(e,t)}(SelectElementEvents,Pr);var c=SelectElementEvents_createSuper(SelectElementEvents);function SelectElementEvents(e,t,n,r,o,i,s){var a;return function SelectElementEvents_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SelectElementEvents),SelectElementEvents_defineProperty(SelectElementEvents_assertThisInitialized(a=c.call(this)),"handleOnChangeEvents",function(e){var t=a._CDUtils.getDropDownListValues(e.target).join(";"),t=a._CDUtils.clearTextFromNumbers(t),n=e.target.selectedIndex,r=e.target.value.length;a._sendToQueue(e,{length:r,selected:n,elementValues:t})}),SelectElementEvents_defineProperty(SelectElementEvents_assertThisInitialized(a),"handleBlurEvent",function(e){a._sendToQueue(e,{length:0,selected:-1,elementValues:""})}),SelectElementEvents_defineProperty(SelectElementEvents_assertThisInitialized(a),"handleFocusEvent",function(e){a._sendToQueue(e,{length:0,selected:-1,elementValues:""})}),a._sendToQueue=e,a._CDUtils=t,a._messageBus=n,a._StandardOnChangeEventsEmitter=r,a._elementFocusEventEmitter=o,a._elementBlurEventEmitter=i,a._configurationRepository=s,a._collectSelectElementBlurAndFocusEvents=a._configurationRepository.get(T.collectSelectElementBlurAndFocusEvents),a}return function SelectElementEvents_createClass(e,t,n){t&&SelectElementEvents_defineProperties(e.prototype,t),n&&SelectElementEvents_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SelectElementEvents,[{key:"bind",value:function bind(e){e=e.getDocument();this._messageBus.subscribe(_.StandardOnSelectEvent,this.handleOnChangeEvents),this._messageBus.subscribe(_.ElementFocusEvent,this.handleFocusEvent),this._messageBus.subscribe(_.ElementBlurEvent,this.handleBlurEvent),this.addListenersBySelector(e)}},{key:"unbind",value:function unbind(e){e=e.getDocument(),e=this._getSelectElementsFromDoc(e);this._StandardOnChangeEventsEmitter.stop(e),this._elementFocusEventEmitter.stop(e),this._elementBlurEventEmitter.stop(e),this._messageBus.unsubscribe(_.StandardOnSelectEvent,this.handleOnChangeEvents),this._messageBus.unsubscribe(_.ElementFocusEvent,this.handleFocusEvent),this._messageBus.unsubscribe(_.ElementBlurEvent,this.handleBlurEvent)}},{key:"addListenersBySelector",value:function addListenersBySelector(e){e=this._getSelectElementsFromDoc(e);this._StandardOnChangeEventsEmitter.start(e),this._collectSelectElementBlurAndFocusEvents&&(this._elementFocusEventEmitter.start(e),this._elementBlurEventEmitter.start(e))}},{key:"updateSettings",value:function updateSettings(e){this._collectSelectElementBlurAndFocusEvents=this._configurationRepository.get(T.collectSelectElementBlurAndFocusEvents),this._collectSelectElementBlurAndFocusEvents||(e=e.getDocument(),e=this._getSelectElementsFromDoc(e),this._elementFocusEventEmitter.stop(e),this._elementBlurEventEmitter.stop(e))}},{key:"_getSelectElementsFromDoc",value:function _getSelectElementsFromDoc(e){for(var t=[],n=e.querySelectorAll("select"),r=0;r<n.length;r++)t.push(n[r]);return t}}]),SelectElementEvents}();function FormEvents_typeof(e){return(FormEvents_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FormEvents_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FormEvents_setPrototypeOf(e,t){return(FormEvents_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function FormEvents_createSuper(n){var r=function FormEvents_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=FormEvents_getPrototypeOf(n);return function FormEvents_possibleConstructorReturn(e,t){{if(t&&("object"===FormEvents_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return FormEvents_assertThisInitialized(e)}(this,r?(e=FormEvents_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function FormEvents_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FormEvents_getPrototypeOf(e){return(FormEvents_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fr="form",Dr=function(){!function FormEvents_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FormEvents_setPrototypeOf(e,t)}(FormEvents,Pr);var o=FormEvents_createSuper(FormEvents);function FormEvents(e,t,n){var r;return function FormEvents_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FormEvents),function FormEvents_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(FormEvents_assertThisInitialized(r=o.call(this)),"handleOnFormEvents",function(e){M.trace("ElementEvents:_onFormSubmitEvent"),r._sendToQueue(e,{length:0,selected:-1,elementValues:""})}),r._sendToQueue=e,r._messageBus=t,r._StandardOnFormEventsEmitter=n,r}return function FormEvents_createClass(e,t,n){t&&FormEvents_defineProperties(e.prototype,t),n&&FormEvents_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FormEvents,[{key:"bind",value:function bind(e){e=e.getDocument();this._messageBus.subscribe(_.StandardOnFormSubmitEvent,this.handleOnFormEvents),this.addListenersBySelector(e)}},{key:"unbind",value:function unbind(e){for(var t=[],n=e.getDocument().querySelectorAll(Fr),r=0;r<n.length;r++)t.push(n[r]);this._StandardOnFormEventsEmitter.stop(t),this._messageBus.unsubscribe(_.StandardOnFormSubmitEvent,this.handleOnFormEvents)}},{key:"addListenersBySelector",value:function addListenersBySelector(e){for(var t=[],n=e.querySelectorAll(Fr),r=0;r<n.length;r++)t.push(n[r]);this._StandardOnFormEventsEmitter.start(t)}}]),FormEvents}();function PrivateBrowsingDetector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Tr=function(){function PrivateBrowsingDetector(){!function PrivateBrowsingDetector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PrivateBrowsingDetector)}return function PrivateBrowsingDetector_createClass(e,t,n){t&&PrivateBrowsingDetector_defineProperties(e.prototype,t),n&&PrivateBrowsingDetector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PrivateBrowsingDetector,[{key:"detectPrivateMode",value:function detectPrivateMode(e){this._isWebkitBrowser()?this._detectPrivateBrowsingOnWebkit(e):this._isMozillaBrowser()?this._detectPrivateBrowsingOnMozilla(e):this._isIE10OrLater(window.navigator.userAgent)?this._detectPrivateBrowsingOnIESinceVersion10(e):window.localStorage&&/Safari/.test(window.navigator.userAgent)?this._detectPrivateBrowsingOnSafari(e):e(null)}},{key:"_isWebkitBrowser",value:function _isWebkitBrowser(){return!!window.webkitRequestFileSystem}},{key:"_isMozillaBrowser",value:function _isMozillaBrowser(){return"MozAppearance"in document.documentElement.style}},{key:"_isIE10OrLater",value:function _isIE10OrLater(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);if(n&&10<=parseInt(n[1],10))return!0;if((n="documentElement"in document&&("filters"in document.documentElement||"documentMode"in document),n&&document.documentMode)&&10<=parseFloat((t.match(/.+(?:ie|rv)[\/: ]([\d.]+)/)||[])[1]))return!0;n=/edge/.test(t);e=!!t.match(/trident\/7\./);if((n||e)&&10<=parseFloat((t.match(/.+(?:edge|rv)[\/: ]([\d.]+)/)||[])[1]))return!0;return!1}},{key:"_detectPrivateBrowsingOnWebkit",value:function _detectPrivateBrowsingOnWebkit(e){void 0!==navigator.storage&&"function"==typeof navigator.storage.estimate?this._storageEstimateDetectionOnWebkit(e):this._fileSystemDetectionOnWebkit(e)}},{key:"_fileSystemDetectionOnWebkit",value:function _fileSystemDetectionOnWebkit(e){window.webkitRequestFileSystem(window.TEMPORARY,1,function(){e(!1)},function(){e(!0)})}},{key:"_storageEstimateDetectionOnWebkit",value:function _storageEstimateDetectionOnWebkit(t){navigator.storage.estimate().then(function(e){e=e.quota;t(e<12e7)}).catch(function(e){M.error("failed to detect private browsing",e)})}},{key:"_detectPrivateBrowsingOnMozilla",value:function _detectPrivateBrowsingOnMozilla(t){try{var e=(indexedDB||window.indexedDB).open("test");e.onerror=function(){t(!0)},e.onsuccess=function(){t(!1)}}catch(e){t(!0)}}},{key:"_detectPrivateBrowsingOnIESinceVersion10",value:function _detectPrivateBrowsingOnIESinceVersion10(e){var t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}e(t)}},{key:"_detectPrivateBrowsingOnSafari",value:function _detectPrivateBrowsingOnSafari(e){var t;try{window.openDatabase(null,null,null,null)}catch(e){t=!0}try{window.localStorage.setItem("test",1)}catch(e){t=!0}t||(t=!1,window.localStorage.removeItem("test")),e(t)}}]),PrivateBrowsingDetector}();function PointerHoverDetector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mr=1,Rr=2,jr=3,Ir=4,xr=5,Lr=1,Ar=2,Nr=3,Ur=4,Qr=function(){function PointerHoverDetector(){!function PointerHoverDetector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PointerHoverDetector)}return function PointerHoverDetector_createClass(e,t,n){t&&PointerHoverDetector_defineProperties(e.prototype,t),n&&PointerHoverDetector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PointerHoverDetector,null,[{key:"getPointerHover",value:function getPointerHover(){var e,t={pointer:xr,hover:xr};return window.matchMedia&&((e=window.matchMedia)("( any-pointer: fine )").matches?t.pointer=Mr:e("( any-pointer: coarse )").matches?t.pointer=Rr:e("( any-pointer: none )").matches?t.pointer=jr:e("( any-pointer )").matches&&(t.pointer=Ir),e("( any-hover: hover )").matches?t.hover=Lr:e("( any-hover: on-demand )").matches?t.hover=Ar:e("( any-hove: none )").matches?t.hover=Nr:window.matchMedia("( any-hover )").matches&&(t.hover=Ur)),t}}]),PointerHoverDetector}();function FontsDetector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hr=function(){function FontsDetector(e){!function FontsDetector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FontsDetector),this._domUtils=e,this._baseFonts=["monospace","sans-serif","serif"],this._testString="mmmmmmmmmmlli",this._testSize="72px",this._chunkSize=30,this._defaultWidth={},this._defaultHeight={},this._body=null,this._iframe=null,this._spanArray=null,this._allFontsDiffs=[]}return function FontsDetector_createClass(e,t,n){t&&FontsDetector_defineProperties(e.prototype,t),n&&FontsDetector_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FontsDetector,[{key:"clear",value:function clear(){this._body.removeChild(this._iframe),this._iframe=null,this._spanArray=null,this._allFontsDiffs=[]}},{key:"init",value:function init(e){var t=this;if(this._body=document.body,!this._body)return"";this._iframe=document.createElement("iframe"),this._iframe.setAttribute("sandbox","allow-same-origin"),this._iframe.id=A.fontDetectionFrame,this._iframe.style.visibility="hidden",this._iframe.style.zIndex="-1",this._iframe.style.width=0,this._iframe.style.height=0,this._body.appendChild(this._iframe),this._iframe.contentDocument.body||(this._iframe.style.width=null,this._iframe.style.height=null,this._iframe.contentDocument.appendChild(document.createElement("body"))),this._domUtils.onWindowDocumentReady(this._iframe.contentWindow,function(){t._createCalculationElements(e)})}},{key:"_createCalculationElements",value:function _createCalculationElements(e){var t=document.createElement("span");t.style.fontSize=this._testSize,t.style.visibility="hidden",t.style.position="absolute",t.style.zIndex="-1",t.style.lineHeight="normal",t.innerHTML=this._testString;for(var n=0;n<this._baseFonts.length;n++)t.style.fontFamily=this._baseFonts[n],this._iframe.contentDocument.body.appendChild(t),this._defaultWidth[this._baseFonts[n]]=t.offsetWidth,this._defaultHeight[this._baseFonts[n]]=t.offsetHeight,this._iframe.contentDocument.body.removeChild(t);M.debug("FontsDetector:init - base fonts width: \n                ".concat(this._baseFonts[0],":").concat(this._defaultWidth[this._baseFonts[0]],";\n                ").concat(this._baseFonts[1],":").concat(this._defaultWidth[this._baseFonts[1]],";\n                ").concat(this._baseFonts[2],":").concat(this._defaultWidth[this._baseFonts[2]])),M.debug("FontsDetector:init - base fonts height: \n                ".concat(this._baseFonts[0],":").concat(this._defaultHeight[this._baseFonts[0]],";\n                ").concat(this._baseFonts[1],":").concat(this._defaultHeight[this._baseFonts[1]],";\n                ").concat(this._baseFonts[2],":").concat(this._defaultHeight[this._baseFonts[2]])),this._createSpanArray(),e()}},{key:"_createSpanArray",value:function _createSpanArray(){var e=document.createElement("div");e.id="currentDiv",e.style.position="absolute",e.style.visibility="hidden";for(var t=0;t<this._chunkSize;t++){var n=document.createElement("span");n.style.lineHeight="normal",n.style.position="absolute",n.style.zIndex="-1",n.style.fontSize=this._testSize,n.innerHTML=this._testString,e.appendChild(n);n=document.createElement("br");e.appendChild(n)}this._iframe.contentDocument.body.appendChild(e),this._spanArray=e}},{key:"detectByChunksWithIndex",value:function detectByChunksWithIndex(e,t,n){var r=[],o=0,i=0;if(!this._spanArray)return r;for(var s=this._spanArray.getElementsByTagName("span"),a=this._defaultWidth[this._baseFonts[t]],c=this._defaultHeight[this._baseFonts[t]],u=0;u<e.length;u++){if(i>=this._chunkSize)for(var l=i=0;l<s.length;l++){var f=Math.abs(s[l].offsetWidth-a),p=Math.abs(s[l].offsetHeight-c);this._allFontsDiffs.push([s[l].id,f,p]),(1<f||1<p)&&(r[o]=s[l].id,o++)}s[i].style.fontFamily=e[u]+","+this._baseFonts[t],s[i].id=e[u],i++}n(r)}},{key:"getAllFontsDiffs",value:function getAllFontsDiffs(){return this._allFontsDiffs}}]),FontsDetector}();function MutationEmitter_typeof(e){return(MutationEmitter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MutationEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wr=function(){function MutationEmitter(e){var n=this;if(!function MutationEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MutationEmitter),function MutationEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleMutationEvent",function(e,t){e&&t&&n._messageBus.publish(_.MutationSingleEvent,{mutation:e,browserContext:t})}),this._messageBus=e,"object"!==MutationEmitter_typeof(this._messageBus))throw new Error("Bootstrap aborted! MessageBus missing for MutationEmitter");this._documentObservers=new WeakMap}return function MutationEmitter_createClass(e,t,n){t&&MutationEmitter_defineProperties(e.prototype,t),n&&MutationEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(MutationEmitter,[{key:"startObserver",value:function startObserver(r){var e,o=this,t=r.getDocument();this._documentObservers.has(t)||((e=new window.MutationObserver(function(e){try{for(var t=0;t<e.length;t++){var n=e[t];if(0<n.addedNodes.length){o.handleMutationEvent(n,r);break}}}catch(e){M.error("An error has occurred: ".concat(e.message))}})).observe(t,{childList:!0,subtree:!0}),this._documentObservers.set(t,{instance:e}))}},{key:"stopObserver",value:function stopObserver(e){var t,e=e.getDocument();this._documentObservers.has(e)&&(t=this._documentObservers.get(e))&&(t.instance&&t.instance.disconnect(),this._documentObservers.delete(e))}}]),MutationEmitter}();function StandardInputEventsEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function StandardInputEventsEmitter_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zr=function(){function StandardInputEventsEmitter(e,t,n){var r=this;!function StandardInputEventsEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StandardInputEventsEmitter),StandardInputEventsEmitter_defineProperty(this,"handleInputEvents",function(e){r._messageBus.publish(_.StandardInputEvent,e)}),StandardInputEventsEmitter_defineProperty(this,"handleFocusEvents",function(e){r._messageBus.publish(_.StandardInputFocusEvent,e)}),StandardInputEventsEmitter_defineProperty(this,"handleBlurEvents",function(e){r._messageBus.publish(_.StandardInputBlurEvent,e)}),this._messageBus=e,this._eventAggregator=t,this._elementBindingWMap=new WeakMap,this._utils=n,this.defaultInputEventListener=[{event:"input",handler:this.handleInputEvents},{event:"focus",handler:this.handleFocusEvents},{event:"blur",handler:this.handleBlurEvents}]}return function StandardInputEventsEmitter_createClass(e,t,n){t&&StandardInputEventsEmitter_defineProperties(e.prototype,t),n&&StandardInputEventsEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StandardInputEventsEmitter,[{key:"start",value:function start(e,r,o){var i=this;e.forEach(function(t){var n;i._elementBindingWMap.has(t)||(n=[],void 0!==o?"function"==typeof o.func&&Array.isArray(o.allowedEvents)&&0<o.allowedEvents.length&&(o.func(r,t)?i.defaultInputEventListener.forEach(function(e){o.allowedEvents.includes(e.event)&&n.push(e)}):n=Array.from(i.defaultInputEventListener)):n=Array.from(i.defaultInputEventListener),n.forEach(function(e){i._eventAggregator.addEventListener(t,e.event,e.handler)}),i._elementBindingWMap.set(t,{isBinded:!0,listeners:[i.handleInputEvents,i.handleFocusEvents,i.handleBlurEvents],isUsingJQuery:!1}))})}},{key:"stop",value:function stop(e){var n=this;e.forEach(function(t){var e=n._elementBindingWMap.get(t);e&&e.isBinded&&(n.defaultInputEventListener.forEach(function(e){n._eventAggregator.removeEventListener(t,e.event,e.handler)}),n._elementBindingWMap.delete(t))})}},{key:"addElementEvents",value:function addElementEvents(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._elementBindingWMap.has(t)){if(e){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to add event listeners for element using jQuery because jQuery is not available");this.defaultInputEventListener.forEach(function(e){n._utils.JQueryUtils.addEventListener(t,e.event,e.handler)})}else this.defaultInputEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)});this._elementBindingWMap.set(t,{isBinded:!0,listeners:[this.handleInputEvents,this.handleFocusEvents,this.handleBlurEvents],isUsingJQuery:e})}}},{key:"removeElementEvents",value:function removeElementEvents(t){var n=this,e=this._elementBindingWMap.get(t);if(e&&e.isBinded){if(e.isUsingJQuery){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to remove event listeners for element using jQuery because jQuery is not available");this.defaultInputEventListener.forEach(function(e){n._utils.JQueryUtils.removeEventListener(t,e.event,e.handler)})}else this.defaultInputEventListener.forEach(function(e){n._eventAggregator.removeEventListener(elements,e.event,e.handler)});this._elementBindingWMap.delete(t)}}}]),StandardInputEventsEmitter}();function StandardOnClickEventsEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Kr=function(){function StandardOnClickEventsEmitter(e,t,n){var r=this;!function StandardOnClickEventsEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StandardOnClickEventsEmitter),function StandardOnClickEventsEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleOnClickEvents",function(e){r._messageBus.publish(_.StandardOnClickEvent,e)}),this._messageBus=e,this._eventAggregator=t,this._elementBindingWMap=new WeakMap,this._utils=n,this.defaultOnClickEventListener=[{event:"click",handler:this.handleOnClickEvents}]}return function StandardOnClickEventsEmitter_createClass(e,t,n){t&&StandardOnClickEventsEmitter_defineProperties(e.prototype,t),n&&StandardOnClickEventsEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StandardOnClickEventsEmitter,[{key:"start",value:function start(e){var n=this;e.forEach(function(t){n._elementBindingWMap.has(t)||(n.defaultOnClickEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)}),n._elementBindingWMap.set(t,{isBinded:!0,listeners:[n.handleOnClickEvents],isUsingJQuery:!1}))})}},{key:"stop",value:function stop(e){var n=this;e.forEach(function(t){var e=n._elementBindingWMap.get(t);e&&e.isBinded&&(n.defaultOnClickEventListener.forEach(function(e){n._eventAggregator.removeEventListener(t,e.event,e.handler)}),n._elementBindingWMap.delete(t))})}},{key:"addElementEvents",value:function addElementEvents(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._elementBindingWMap.has(t)){if(e){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to add event listeners for element using jQuery because jQuery is not available");this.defaultOnClickEventListener.forEach(function(e){n._utils.JQueryUtils.addEventListener(t,e.event,e.handler)})}else this.defaultOnClickEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)});this._elementBindingWMap.set(t,{isBinded:!0,listeners:[this.handleOnClickEvents],isUsingJQuery:e})}}},{key:"removeElementEvents",value:function removeElementEvents(t){var n=this,e=this._elementBindingWMap.get(t);if(e&&e.isBinded){if(e.isUsingJQuery){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to remove event listeners for element using jQuery because jQuery is not available");this.defaultOnClickEventListener.forEach(function(e){n._utils.JQueryUtils.removeEventListener(t,e.event,e.handler)})}else this.defaultOnClickEventListener.forEach(function(e){n._eventAggregator.removeEventListener(elements,e.event,e.handler)});this._elementBindingWMap.delete(t)}}}]),StandardOnClickEventsEmitter}();function StandardOnChangeEventsEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vr=function(){function StandardOnChangeEventsEmitter(e,t,n){var r=this;!function StandardOnChangeEventsEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StandardOnChangeEventsEmitter),function StandardOnChangeEventsEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleOnChangeEvents",function(e){r._messageBus.publish(_.StandardOnSelectEvent,e)}),this._messageBus=e,this._eventAggregator=t,this._elementBindingWMap=new WeakMap,this._utils=n,this.defaultOnChangeEventListener=[{event:"change",handler:this.handleOnChangeEvents}]}return function StandardOnChangeEventsEmitter_createClass(e,t,n){t&&StandardOnChangeEventsEmitter_defineProperties(e.prototype,t),n&&StandardOnChangeEventsEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StandardOnChangeEventsEmitter,[{key:"start",value:function start(e){var n=this;e.forEach(function(t){n._elementBindingWMap.has(t)||(n.defaultOnChangeEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)}),n._elementBindingWMap.set(t,{isBinded:!0,listeners:[n.handleOnChangeEvents],isUsingJQuery:!1}))})}},{key:"stop",value:function stop(e){var n=this;e.forEach(function(t){var e=n._elementBindingWMap.get(t);e&&e.isBinded&&(n.defaultOnChangeEventListener.forEach(function(e){n._eventAggregator.removeEventListener(t,e.event,e.handler)}),n._elementBindingWMap.delete(t))})}},{key:"addElementEvents",value:function addElementEvents(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._elementBindingWMap.has(t)){if(e){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to add event listeners for element using jQuery because jQuery is not available");this.defaultOnChangeEventListener.forEach(function(e){n._utils.JQueryUtils.addEventListener(t,e.event,e.handler)})}else this.defaultOnChangeEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)});this._elementBindingWMap.set(t,{isBinded:!0,listeners:[this.handleOnChangeEvents],isUsingJQuery:e})}}},{key:"removeElementEvents",value:function removeElementEvents(t){var n=this,e=this._elementBindingWMap.get(t);if(e&&e.isBinded){if(e.isUsingJQuery){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to remove event listeners for element using jQuery because jQuery is not available");this.defaultOnChangeEventListener.forEach(function(e){n._utils.JQueryUtils.removeEventListener(t,e.event,e.handler)})}else this.defaultOnChangeEventListener.forEach(function(e){n._eventAggregator.removeEventListener(elements,e.event,e.handler)});this._elementBindingWMap.delete(t)}}}]),StandardOnChangeEventsEmitter}();function StandardOnFormEventsEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gr=function(){function StandardOnFormEventsEmitter(e,t,n){var r=this;!function StandardOnFormEventsEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StandardOnFormEventsEmitter),function StandardOnFormEventsEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleOnFormSubmitEvents",function(e){r._messageBus.publish(_.StandardOnFormSubmitEvent,e)}),this._messageBus=e,this._eventAggregator=t,this._elementBindingWMap=new WeakMap,this._utils=n,this.defaultOnFormEventListener=[{event:"submit",handler:this.handleOnFormSubmitEvents}]}return function StandardOnFormEventsEmitter_createClass(e,t,n){t&&StandardOnFormEventsEmitter_defineProperties(e.prototype,t),n&&StandardOnFormEventsEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(StandardOnFormEventsEmitter,[{key:"start",value:function start(e){var n=this;e.forEach(function(t){n._elementBindingWMap.has(t)||(n.defaultOnFormEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)}),n._elementBindingWMap.set(t,{isBinded:!0,listeners:[n.handleOnFormSubmitEvents],isUsingJQuery:!1}))})}},{key:"stop",value:function stop(e){var n=this;e.forEach(function(t){var e=n._elementBindingWMap.get(t);e&&e.isBinded&&(n.defaultOnFormEventListener.forEach(function(e){n._eventAggregator.removeEventListener(t,e.event,e.handler)}),n._elementBindingWMap.delete(t))})}},{key:"addElementEvents",value:function addElementEvents(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._elementBindingWMap.has(t)){if(e){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to add event listeners for element using jQuery because jQuery is not available");this.defaultOnFormEventListener.forEach(function(e){n._utils.JQueryUtils.addEventListener(t,e.event,e.handler)})}else this.defaultOnFormEventListener.forEach(function(e){n._eventAggregator.addEventListener(t,e.event,e.handler)});this._elementBindingWMap.set(t,{isBinded:!0,listeners:[this.handleOnFormSubmitEvents],isUsingJQuery:e})}}},{key:"removeElementEvents",value:function removeElementEvents(t){var n=this,e=this._elementBindingWMap.get(t);if(e&&e.isBinded){if(e.isUsingJQuery){if(!this._utils.JQueryUtils.isJQueryAvailable())return void M.error("Unable to remove event listeners for element using jQuery because jQuery is not available");this.defaultOnFormEventListener.forEach(function(e){n._utils.JQueryUtils.removeEventListener(t,e.event,e.handler)})}else this.defaultOnFormEventListener.forEach(function(e){n._eventAggregator.removeEventListener(elements,e.event,e.handler)});this._elementBindingWMap.delete(t)}}}]),StandardOnFormEventsEmitter}();function SyntheticInputEventsHandlerBase_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qr=function(){function SyntheticInputEventsHandlerBase(e,t,n){!function SyntheticInputEventsHandlerBase_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SyntheticInputEventsHandlerBase),function SyntheticInputEventsHandlerBase_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"isJQueryDataSupported",function(e){return!(!e.jQuery||!e.jQuery._data)}),this._messageBus=e,this._eventAggregator=t,this._elementBindingWMap=new WeakMap,this._utils=n,this.defaultEventListener=[{event:"keypress",handler:this.handleKeypressEvents}]}return function SyntheticInputEventsHandlerBase_createClass(e,t,n){t&&SyntheticInputEventsHandlerBase_defineProperties(e.prototype,t),n&&SyntheticInputEventsHandlerBase_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SyntheticInputEventsHandlerBase,[{key:"registerElement",value:function registerElement(e,n){var r,o=this;this._elementBindingWMap.has(e)||(r={},this.defaultEventListener.forEach(function(t){function wLa(e){t.handler(e,n)}r[t.event]=wLa,o._eventAggregator.addEventListener(e,t.event,wLa)}),this._elementBindingWMap.set(e,{isBinded:!0,listeners:r}))}},{key:"unregisterElements",value:function unregisterElements(e){var r=this;e.forEach(function(t){var n=r._elementBindingWMap.get(t);n&&n.isBinded&&(r.defaultEventListener.forEach(function(e){r._eventAggregator.removeEventListener(t,e.event,n.listeners[e.event])}),r._elementBindingWMap.delete(t))})}},{key:"publishEvent",value:function publishEvent(e,t,n,r){e={bubbles:!0,cancelBubble:!1,cancelable:!1,composed:!0,currentTarget:null,data:r,dataTransfer:null,defaultPrevented:!1,detail:0,eventPhase:0,inputType:n,isComposing:!1,isTrusted:!0,jqueryMask:t,returnValue:!0,sourceCapabilities:null,srcElement:Object.assign(e.target||e.srcElement,{}),target:Object.assign(e.target,{}),timeStamp:e.timeStamp,type:"input",view:null,which:0};this._messageBus.publish(_.SyntheticInputMaskEvent,e)}}]),SyntheticInputEventsHandlerBase}();function SyntheticMaskInputEventsHandler_typeof(e){return(SyntheticMaskInputEventsHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SyntheticMaskInputEventsHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SyntheticMaskInputEventsHandler_setPrototypeOf(e,t){return(SyntheticMaskInputEventsHandler_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function SyntheticMaskInputEventsHandler_createSuper(n){var r=function SyntheticMaskInputEventsHandler_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=SyntheticMaskInputEventsHandler_getPrototypeOf(n);return function SyntheticMaskInputEventsHandler_possibleConstructorReturn(e,t){{if(t&&("object"===SyntheticMaskInputEventsHandler_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return SyntheticMaskInputEventsHandler_assertThisInitialized(e)}(this,r?(e=SyntheticMaskInputEventsHandler_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function SyntheticMaskInputEventsHandler_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SyntheticMaskInputEventsHandler_getPrototypeOf(e){return(SyntheticMaskInputEventsHandler_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jr=function(){!function SyntheticMaskInputEventsHandler_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SyntheticMaskInputEventsHandler_setPrototypeOf(e,t)}(SyntheticMaskInputEventsHandler,qr);var o=SyntheticMaskInputEventsHandler_createSuper(SyntheticMaskInputEventsHandler);function SyntheticMaskInputEventsHandler(){var n;!function SyntheticMaskInputEventsHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SyntheticMaskInputEventsHandler);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function SyntheticMaskInputEventsHandler_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(SyntheticMaskInputEventsHandler_assertThisInitialized(n=o.call.apply(o,[this].concat(t))),"handleKeypressEvents",function(e,t){n.isJQueryDataSupported(t)&&n.hasMaskEventSupported(e.target,t)&&(t=e.key,n.publishEvent(e,"maskedInput","insertText",t))}),n}return function SyntheticMaskInputEventsHandler_createClass(e,t,n){t&&SyntheticMaskInputEventsHandler_defineProperties(e.prototype,t),n&&SyntheticMaskInputEventsHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SyntheticMaskInputEventsHandler,[{key:"start",value:function start(e,t){var n=this;t=t||window.self,e.forEach(function(e){n.isJQueryDataSupported(t)&&n.hasMaskEventSupported(e,t)&&n.registerElement(e,t)})}},{key:"stop",value:function stop(e){this.unregisterElements(e)}},{key:"hasMaskEventSupported",value:function hasMaskEventSupported(e,t){e=t.jQuery._data(e,"events");if(void 0===e)return!1;for(var n=Object.keys(e),r=0;r<n.length;r++)if("unmask"===n[r])return!0;return!1}}]),SyntheticMaskInputEventsHandler}();function SyntheticAutotabInputEventsHandler_typeof(e){return(SyntheticAutotabInputEventsHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SyntheticAutotabInputEventsHandler_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SyntheticAutotabInputEventsHandler_setPrototypeOf(e,t){return(SyntheticAutotabInputEventsHandler_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function SyntheticAutotabInputEventsHandler_createSuper(n){var r=function SyntheticAutotabInputEventsHandler_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function _createSuperInternal(){var e,t=SyntheticAutotabInputEventsHandler_getPrototypeOf(n);return function SyntheticAutotabInputEventsHandler_possibleConstructorReturn(e,t){{if(t&&("object"===SyntheticAutotabInputEventsHandler_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined")}return SyntheticAutotabInputEventsHandler_assertThisInitialized(e)}(this,r?(e=SyntheticAutotabInputEventsHandler_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function SyntheticAutotabInputEventsHandler_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SyntheticAutotabInputEventsHandler_getPrototypeOf(e){return(SyntheticAutotabInputEventsHandler_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zr=function(){!function SyntheticAutotabInputEventsHandler_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SyntheticAutotabInputEventsHandler_setPrototypeOf(e,t)}(SyntheticAutotabInputEventsHandler,qr);var o=SyntheticAutotabInputEventsHandler_createSuper(SyntheticAutotabInputEventsHandler);function SyntheticAutotabInputEventsHandler(){var n;!function SyntheticAutotabInputEventsHandler_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SyntheticAutotabInputEventsHandler);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function SyntheticAutotabInputEventsHandler_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(SyntheticAutotabInputEventsHandler_assertThisInitialized(n=o.call.apply(o,[this].concat(t))),"handleKeypressEvents",function(e,t){n.isJQueryDataSupported(t)&&n.hasjQueryAutoTab(e.target,t)&&(t=e.key,8!==e.keyCode&&n.publishEvent(e,"autotab","insertText",t))}),n}return function SyntheticAutotabInputEventsHandler_createClass(e,t,n){t&&SyntheticAutotabInputEventsHandler_defineProperties(e.prototype,t),n&&SyntheticAutotabInputEventsHandler_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SyntheticAutotabInputEventsHandler,[{key:"start",value:function start(e,t){var n=this;e.forEach(function(e){n.isJQueryDataSupported(t)&&n.hasjQueryAutoTab(e,t)&&n.registerElement(e,t)})}},{key:"stop",value:function stop(e){this.unregisterElements(e)}},{key:"hasjQueryAutoTab",value:function hasjQueryAutoTab(e,t){if(void 0===t.jQuery._data(e,"events"))return!1;for(var n=Object.keys(t.jQuery._data(e,"events")),r=0;r<n.length;r++)if(-1!==n[r].indexOf("autotab"))return!0;return!1}}]),SyntheticAutotabInputEventsHandler}();function FocusEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xr=function(){function FocusEventEmitter(e,t){var n=this;!function FocusEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FocusEventEmitter),function FocusEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleFocusEvent",function(e){n._messageBus.publish(_.FocusEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function FocusEventEmitter_createClass(e,t,n){t&&FocusEventEmitter_defineProperties(e.prototype,t),n&&FocusEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FocusEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.addEventListener(e,"focus",this.handleFocusEvent,!1,!0)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.removeEventListener(e,"focus",this.handleFocusEvent)}}]),FocusEventEmitter}();function BlurEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yr=function(){function BlurEventEmitter(e,t){var n=this;!function BlurEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BlurEventEmitter),function BlurEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleBlurEvent",function(e){n._messageBus.publish(_.BlurEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function BlurEventEmitter_createClass(e,t,n){t&&BlurEventEmitter_defineProperties(e.prototype,t),n&&BlurEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BlurEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.addEventListener(e,"blur",this.handleBlurEvent,!1,!0)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.removeEventListener(e,"blur",this.handleBlurEvent)}}]),BlurEventEmitter}();function ResizeEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $r=function(){function ResizeEventEmitter(e,t){var n=this;!function ResizeEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResizeEventEmitter),function ResizeEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleResizeEvent",function(e){n._messageBus.publish(_.ResizeEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function ResizeEventEmitter_createClass(e,t,n){t&&ResizeEventEmitter_defineProperties(e.prototype,t),n&&ResizeEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ResizeEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.addEventListener(e,"resize",this.handleResizeEvent,!1,!0)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.removeEventListener(e,"resize",this.handleResizeEvent)}}]),ResizeEventEmitter}();function DOMContentLoadedEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var eo=function(){function DOMContentLoadedEventEmitter(e,t){var n=this;!function DOMContentLoadedEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DOMContentLoadedEventEmitter),function DOMContentLoadedEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleDOMContentLoadedEvent",function(e){n._messageBus.publish(_.DOMContentLoadedEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function DOMContentLoadedEventEmitter_createClass(e,t,n){t&&DOMContentLoadedEventEmitter_defineProperties(e.prototype,t),n&&DOMContentLoadedEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DOMContentLoadedEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.addEventListener(e,"DOMContentLoaded",this.handleDOMContentLoadedEvent)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.removeEventListener(e,"DOMContentLoaded",this.handleDOMContentLoadedEvent)}}]),DOMContentLoadedEventEmitter}();function VisibilityChangeEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var to=function(){function VisibilityChangeEventEmitter(e,t){var n=this;!function VisibilityChangeEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VisibilityChangeEventEmitter),function VisibilityChangeEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleVisibilityChangeEvent",function(e){n._messageBus.publish(_.VisibilityChangeEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function VisibilityChangeEventEmitter_createClass(e,t,n){t&&VisibilityChangeEventEmitter_defineProperties(e.prototype,t),n&&VisibilityChangeEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(VisibilityChangeEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.addEventListener(e,"visibilitychange",this.handleVisibilityChangeEvent,!1,!0)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.removeEventListener(e,"visibilitychange",this.handleVisibilityChangeEvent)}}]),VisibilityChangeEventEmitter}();function ScrollEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var no=function(){function ScrollEventEmitter(e,t){var n=this;!function ScrollEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ScrollEventEmitter),function ScrollEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleScrollEvent",function(e){n._messageBus.publish(_.ScrollEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function ScrollEventEmitter_createClass(e,t,n){t&&ScrollEventEmitter_defineProperties(e.prototype,t),n&&ScrollEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ScrollEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.addEventListener(e,"scroll",this.handleScrollEvent,!1,!0)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.removeEventListener(e,"scroll",this.handleScrollEvent)}}]),ScrollEventEmitter}();function WindowMessageEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ro=function(){function WindowMessageEventEmitter(e,t){var n=this;!function WindowMessageEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WindowMessageEventEmitter),function WindowMessageEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleWindowMessage",function(e){e&&n._messageBus.publish(_.WindowMessageEvent,{message:e})}),this._messageBus=e,this._EventAggregator=t,this._windowListeners=new WeakMap,this.defaultPostMessageEventListener=[{event:"message",handler:this.handleWindowMessage}]}return function WindowMessageEventEmitter_createClass(e,t,n){t&&WindowMessageEventEmitter_defineProperties(e.prototype,t),n&&WindowMessageEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(WindowMessageEventEmitter,[{key:"startObserver",value:function startObserver(t){var n=this;this._windowListeners.has(t.Context)||(this.defaultPostMessageEventListener.forEach(function(e){n._EventAggregator.addEventListener(t.Context,e.event,e.handler)}),this._windowListeners.set(t.Context,{isBinded:!0,listeners:[this.handleWindowMessage]}))}},{key:"stopObserver",value:function stopObserver(t){var n=this,e=this._windowListeners.get(t.Context);e&&e.isBinded&&(this.defaultPostMessageEventListener.forEach(function(e){n._EventAggregator.removeEventListener(t.Context,e.event,e.handler)}),this._windowListeners.delete(t.Context))}}]),WindowMessageEventEmitter}();function DeviceOrientationEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oo=function(){function DeviceOrientationEventEmitter(e,t){var n=this;!function DeviceOrientationEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceOrientationEventEmitter),function DeviceOrientationEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleDeviceOrientationEvent",function(e){n._messageBus.publish(_.DeviceOrientationEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function DeviceOrientationEventEmitter_createClass(e,t,n){t&&DeviceOrientationEventEmitter_defineProperties(e.prototype,t),n&&DeviceOrientationEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(DeviceOrientationEventEmitter,[{key:"start",value:function start(){this._eventAggregator.addEventListener(window,"deviceorientation",this.handleDeviceOrientationEvent)}},{key:"stop",value:function stop(){this._eventAggregator.removeEventListener(window,"deviceorientation",this.handleDeviceOrientationEvent)}}]),DeviceOrientationEventEmitter}();function BeforeInstallPromptEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var io=function(){function BeforeInstallPromptEventEmitter(e,t){var n=this;!function BeforeInstallPromptEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BeforeInstallPromptEventEmitter),function BeforeInstallPromptEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleBeforeInstallPrompt",function(e){n._messageBus.publish(_.BeforeInstallPromptEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function BeforeInstallPromptEventEmitter_createClass(e,t,n){t&&BeforeInstallPromptEventEmitter_defineProperties(e.prototype,t),n&&BeforeInstallPromptEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(BeforeInstallPromptEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.addEventListener(e,"beforeinstallprompt",this.handleBeforeInstallPrompt)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid window parameter");this._eventAggregator.removeEventListener(e,"beforeinstallprompt",this.handleBeforeInstallPrompt)}}]),BeforeInstallPromptEventEmitter}();function CutEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var so=function(){function CutEventEmitter(e,t){var n=this;!function CutEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CutEventEmitter),function CutEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleCutEvent",function(e){n._messageBus.publish(_.CutEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function CutEventEmitter_createClass(e,t,n){t&&CutEventEmitter_defineProperties(e.prototype,t),n&&CutEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CutEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.addEventListener(e,"cut",this.handleCutEvent)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.removeEventListener(e,"cut",this.handleCutEvent)}}]),CutEventEmitter}();function CopyEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ao=function(){function CopyEventEmitter(e,t){var n=this;!function CopyEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CopyEventEmitter),function CopyEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleCopyEvent",function(e){n._messageBus.publish(_.CopyEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function CopyEventEmitter_createClass(e,t,n){t&&CopyEventEmitter_defineProperties(e.prototype,t),n&&CopyEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(CopyEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.addEventListener(e,"copy",this.handleCopyEvent)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.removeEventListener(e,"copy",this.handleCopyEvent)}}]),CopyEventEmitter}();function PasteEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var co=function(){function PasteEventEmitter(e,t){var n=this;!function PasteEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PasteEventEmitter),function PasteEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handlePasteEvent",function(e){n._messageBus.publish(_.PasteEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function PasteEventEmitter_createClass(e,t,n){t&&PasteEventEmitter_defineProperties(e.prototype,t),n&&PasteEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(PasteEventEmitter,[{key:"start",value:function start(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.addEventListener(e,"paste",this.handlePasteEvent)}},{key:"stop",value:function stop(e){if(!e)throw new Error("invalid document parameter");this._eventAggregator.removeEventListener(e,"paste",this.handlePasteEvent)}}]),PasteEventEmitter}();function ElementFocusEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var uo=function(){function ElementFocusEventEmitter(e,t){var n=this;!function ElementFocusEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementFocusEventEmitter),function ElementFocusEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleElementFocusEvents",function(e){n._messageBus.publish(_.ElementFocusEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function ElementFocusEventEmitter_createClass(e,t,n){t&&ElementFocusEventEmitter_defineProperties(e.prototype,t),n&&ElementFocusEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ElementFocusEventEmitter,[{key:"start",value:function start(e){var t=this;e.forEach(function(e){t._eventAggregator.addEventListener(e,"focus",t.handleElementFocusEvents)})}},{key:"stop",value:function stop(e){var t=this;e.forEach(function(e){t._eventAggregator.removeEventListener(e,"focus",t.handleElementFocusEvents)})}}]),ElementFocusEventEmitter}();function ElementBlurEventEmitter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lo=function(){function ElementBlurEventEmitter(e,t){var n=this;!function ElementBlurEventEmitter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementBlurEventEmitter),function ElementBlurEventEmitter_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleElementBlurEvents",function(e){n._messageBus.publish(_.ElementBlurEvent,e)}),this._messageBus=e,this._eventAggregator=t}return function ElementBlurEventEmitter_createClass(e,t,n){t&&ElementBlurEventEmitter_defineProperties(e.prototype,t),n&&ElementBlurEventEmitter_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(ElementBlurEventEmitter,[{key:"start",value:function start(e){var t=this;e.forEach(function(e){t._eventAggregator.addEventListener(e,"blur",t.handleElementBlurEvents)})}},{key:"stop",value:function stop(e){var t=this;e.forEach(function(e){t._eventAggregator.removeEventListener(e,"blur",t.handleElementBlurEvents)})}}]),ElementBlurEventEmitter}();function FeaturesList_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fo=[{name:"MouseEvents",className:sn,init:function init(){return function(){this._features.list.MouseEvents.instance=new sn(this._utils,Z,this._elements,this._dataQ,this._configurationRepository)}}},{name:"KeyEvents",className:he,init:function init(){return function(){this._features.list.KeyEvents.instance=new he(this._configurationRepository,this._utils,this._elements,this._dataQ,this._msgBus,this._sameCharService,this._maskingService)}}},{name:"TouchEvents",className:ce,init:function init(){return function(){this._features.list.TouchEvents.instance=new ce(this._utils,this._elements,this._dataQ,this._msgBus)}}},{name:"ClipboardEvents",className:ut,init:function init(){return function(){var e=new ut.Builder(this._utils,this._elements,this._dataQ),t=new so(this._msgBus,Be),n=new ao(this._msgBus,Be),r=new co(this._msgBus,Be);e.withMessageBus(this._msgBus).withCutEventEmitter(t).withCopyEventEmitter(n).withPasteEventEmitter(r),this._features.list.ClipboardEvents.instance=e.build()}}},{name:"ElementEvents",className:it,init:function init(){return function(){var e=new zr(this._msgBus,Be,this._utils),t=new Kr(this._msgBus,Be,this._utils),n=new Vr(this._msgBus,Be,this._utils),r=new uo(this._msgBus,Be,this._utils),o=new lo(this._msgBus,Be,this._utils),i=new Gr(this._msgBus,Be,this._utils),s=new ge(MutationObserver,this._utils,Z,"jQueryElementListenerConfig",null,!1),a=function JqueryElementsHandler(e,t,n,r){return pr=e,dr=t,yr=n,hr=r,{bindInputEvents:_bindInputEvents,bindOnClickEvents:_bindOnClickEvents,bindOnChangeEvents:_bindOnChangeEvents,bindOnFormsEvents:_bindOnFormsEvents}}(e,t,n,i),c=new it.Builder(this._configurationRepository,this._utils,Z,this._elements,this._dataQ),u=new Wr(this._msgBus),l=new Jr(this._msgBus,Be,this._utils),f=new Zr(this._msgBus,Be,this._utils);c.withjQueryElementListenerSiteMapper(s),c.withMessageBus(this._msgBus),c.withMutationEmitter(u),c.withjQueryElementsHandler(a),c.withInputEvents(Or,wr,this._maskingService),c.withStandardInputEventsEmitter(e),c.withSyntheticMaskInputEventsHandler(l),c.withSyntheticAutotabInputEventsHandler(f),c.withClickEvents(kr,Sr),c.withStandardOnClickEventsEmitter(t),c.withSelectElementEvents(Br,"select"),c.withElementFocusEventsEmitter(r),c.withElementBlurEventsEmitter(o),c.withStandardOnChangeEventsEmitter(n),c.withFormEvents(Dr,Fr),c.withStandardOnFormEventsEmitter(i),this._features.list.ElementEvents.instance=c.build()}}},{name:"WindowEvents",className:mt,init:function init(){return function(){var e=new mt.Builder(this._configurationRepository,f,this._dataQ),t=new Xr(this._msgBus,Be),n=new Yr(this._msgBus,Be),r=new $r(this._msgBus,Be),o=new eo(this._msgBus,Be),i=new to(this._msgBus,Be),s=new no(this._msgBus,Be);e.withMessageBus(this._msgBus),e.withFocusEventEmitter(t),e.withBlurEventEmitter(n),e.withResizeEventEmitter(r),e.withDOMContentLoadedEventEmitter(o),e.withVisibilityChangeEventEmitter(i),e.withScrollEventEmitter(s),this._features.list.WindowEvents.instance=e.build()}}},{name:"MetadataCollector",className:fr,init:function init(){return function(){var e=new ge(MutationObserver,this._utils,Z,"metadataConfig",null,!1);this._features.list.MetadataCollector.instance=new fr(this._configurationRepository,this._dataQ,e,this._utils)}}},{name:"TabsEvents",className:pn,init:function init(){return function(){this._features.list.TabsEvents.instance=new pn(this._utils,this._dataQ)}}},{name:"DoNotTrack",className:Ln,init:function init(){return function(){this._features.list.DoNotTrack.instance=new Ln(this._dataQ)}}},{name:"BrowserProps",className:jn,init:function init(){return function(){this._features.list.BrowserProps.instance=new jn(this._dataQ,Qr,this._utils,this._configurationRepository)}}},{name:"IsPrivateBrowsing",className:Xn,init:function init(){return function(){var e=new Tr;this._features.list.IsPrivateBrowsing.instance=new Xn(this._dataQ,e)}}},{name:"FontsDetectionFeature",className:rr,init:function init(){return function(){this._features.list.FontsDetectionFeature.instance=new rr(f,Z,this._dataQ,Hr)}}},{name:"GraphicDetectFeature",className:Un,init:function init(){return function(){this._features.list.GraphicDetectFeature.instance=new Un(this._dataQ)}}},{name:"BrowserDetect",className:mn,init:function init(){return function(){this._features.list.BrowserDetect.instance=new mn(this._dataQ)}}},{name:"FilesFeature",className:ur,init:function init(){return function(){this._features.list.FilesFeature.instance=new ur(this._configurationRepository,this._utils,this._sessionService,this._muidService,this._cidCache)}}},{name:"UserPermissions",className:qn,init:function init(){return function(){this._features.list.UserPermissions.instance=new qn(this._dataQ)}}},{name:"MediaDevicesFeature",className:Wn,init:function init(){return function(){this._features.list.MediaDevicesFeature.instance=new Wn(this._dataQ)}}},{name:"ContextPropsFeature",className:ir,init:function init(){return function(){this._features.list.ContextPropsFeature.instance=new ir(this._dataQ,Z,this._perfMonitor)}}},{name:"ScriptsFeature",className:ar,init:function init(){return function(){var e=new $(this._utils);this._features.list.ScriptsFeature.instance=new ar(this._dataQ,e)}}},{name:"AccelerometerEvents",className:bt,init:function init(){return function(){this._features.list.AccelerometerEvents.instance=new bt(this._configurationRepository,this._utils,this._sensorDataQ)}}},{name:"PinchZoomEvents",className:St,init:function init(){return function(){this._features.list.PinchZoomEvents.instance=new St(this._utils,this._elements,this._dataQ,this._msgBus)}}},{name:"ScriptEvents",className:Dt,init:function init(){return function(){this._features.list.ScriptEvents.instance=new Dt(this._utils,this._dataQ)}}},{name:"NetInfoEvents",className:Rt,init:function init(){return function(){this._features.list.NetInfoEvents.instance=new Rt(this._utils,this._dataQ)}}},{name:"DeviceOrientationCollector",className:Lt,init:function init(){return function(){this._features.list.DeviceOrientationCollector.instance=new Lt(this._utils,this._dataQ)}}},{name:"TapEvents",className:Wt,init:function init(){return function(){this._features.list.TapEvents.instance=new Wt(this._configurationRepository,this._utils,this._elements,this._dataQ)}}},{name:"LocationEvents",className:hn,init:function init(){return function(){this._features.list.LocationEvents.instance=new hn(this._dataQ,this._utils,this._configurationRepository)}}},{name:"StorageEvents",className:Gt,init:function init(){return function(){this._features.list.StorageEvents.instance=new Gt(this._utils,this._elements,this._dataQ,this._msgBus)}}},{name:"PrintEvents",className:Yt,init:function init(){return function(){this._features.list.PrintEvents.instance=new Yt(this._utils,this._dataQ)}}},{name:"LightSensorEvents",className:nn,init:function init(){return function(){this._features.list.LightSensorEvents.instance=new nn(this._dataQ,this._utils,this._configurationRepository)}}},{name:"CrossDomain",className:Er,init:function init(){return function(){var e=new Er.Builder(this._configurationRepository,this._dataQ,this._utils,Z,_r),t=new ro(this._msgBus,Be);e.withMessageBus(this._msgBus),e.withWindowMessageEventEmitter(t),this._features.list.CrossDomain.instance=e.build()}}},{name:"OrientationEvents",className:ft,init:function init(){return function(){var e=new oo(this._msgBus,Be);this._features.list.OrientationEvents.instance=new ft(this._configurationRepository,this._utils,this._sensorDataQ,this._msgBus,e)}}},{name:"BeforeInstallPromptEvents",className:yt,init:function init(){return function(){var e=new io(this._msgBus,Be);this._features.list.BeforeInstallPromptEvents.instance=new yt(this._dataQ,this._utils,this._msgBus,e)}}}],po=function(){function FeaturesList(){!function FeaturesList_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FeaturesList)}return function FeaturesList_createClass(e,t,n){t&&FeaturesList_defineProperties(e.prototype,t),n&&FeaturesList_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(FeaturesList,null,[{key:"register",value:function register(){var t=this;FeaturesList.list={},fo.forEach(function(e){t._addFeature(e)})}},{key:"getDefaultFeatures",value:function getDefaultFeatures(){return this.getFeaturesByCondition(function(e){return e.isDefault})}},{key:"getPerContextFeatures",value:function getPerContextFeatures(){return this.getFeaturesByCondition(function(e){return e.shouldRunPerContext})}},{key:"getPerSessionFeatures",value:function getPerSessionFeatures(){return this.getFeaturesByCondition(function(e){return e.shouldRunPerSession})}},{key:"getNonDefaultFeatures",value:function getNonDefaultFeatures(){return this.getFeaturesByCondition(function(e){return!e.isDefault&&!e.shouldRunPerContext&&!e.shouldRunPerSession})}},{key:"getFeaturesByCondition",value:function getFeaturesByCondition(n){var r={};return Object.keys(FeaturesList.list).forEach(function(e){var t=FeaturesList.list[e];n(t)&&(r[e]=t)}),r}},{key:"_addFeature",value:function _addFeature(e){var t=e.className.getDefaultSettings(),n=e.name;t.init=e.init(),FeaturesList.list[n]=t}}]),FeaturesList}();function SupportedBrowserChecker_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function FeaturesList_defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(po,"list",void 0);var yo=function(){function SupportedBrowserChecker(){!function SupportedBrowserChecker_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SupportedBrowserChecker)}return function SupportedBrowserChecker_createClass(e,t,n){t&&SupportedBrowserChecker_defineProperties(e.prototype,t),n&&SupportedBrowserChecker_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SupportedBrowserChecker,null,[{key:"isSupported",value:function isSupported(){return!("undefined"==typeof WeakMap||!window.Worker||!window.MutationObserver)}}]),SupportedBrowserChecker}(),ho="getConfigurations";function SlaveConfigurations_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vo=function(){function SlaveConfigurations(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length?arguments[1]:void 0;!function SlaveConfigurations_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveConfigurations),this._enableCustomElementDetector=e,this._enableBufferAckMessage=t}return function SlaveConfigurations_createClass(e,t,n){t&&SlaveConfigurations_defineProperties(e.prototype,t),n&&SlaveConfigurations_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveConfigurations,[{key:"getEnableCustomElementDetector",value:function getEnableCustomElementDetector(){return this._enableCustomElementDetector}},{key:"getEnableBufferAckMessage",value:function getEnableBufferAckMessage(){return this._enableBufferAckMessage}}]),SlaveConfigurations}(),_o="enableCustomElementDetector",mo="enableAcknowledgeMessageEvents";function SlaveCdApiFacade_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var go=function(){function SlaveCdApiFacade(){!function SlaveCdApiFacade_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveCdApiFacade)}return function SlaveCdApiFacade_createClass(e,t,n){t&&SlaveCdApiFacade_defineProperties(e.prototype,t),n&&SlaveCdApiFacade_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveCdApiFacade,[{key:"isSlaveCdApiAvailable",value:function isSlaveCdApiAvailable(){return!f.isUndefinedNull(window.slaveCdApi)}},{key:"isApiAvailable",value:function isApiAvailable(e){return this.isSlaveCdApiAvailable()&&!f.isUndefinedNull(window.slaveCdApi[e])}},{key:"_isValidConfiguration",value:function _isValidConfiguration(e){return!f.isUndefinedNull(e)&&f.isBoolean(e)}},{key:"getConfigurations",value:function getConfigurations(){var n=this,r=!0,o=null;return this.isApiAvailable(ho)&&window.slaveCdApi[ho](function(e){var t;e&&(e.hasOwnProperty(_o)&&(t=e[_o],r=n._isValidConfiguration(t)?t:r),e.hasOwnProperty(mo)&&(e=e[mo],o=n._isValidConfiguration(e)?e:o))}),new vo(r,o)}}]),SlaveCdApiFacade}();function SlaveStartPoint_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bo=function(){function SlaveStartPoint(){!function SlaveStartPoint_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SlaveStartPoint)}return function SlaveStartPoint_createClass(e,t,n){t&&SlaveStartPoint_defineProperties(e.prototype,t),n&&SlaveStartPoint_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(SlaveStartPoint,[{key:"start",value:function start(){if(yo.isSupported()){var e=(new go).getConfigurations(),t=new tt;return po.register(),t.loadSystem(po,e),t.getFeatureService().buildFrameRelatedLists(),t.getFeatureBuilder().buildFeatures(),t.getFeatureService().runDefault(),t.getContextMgr().initContextHandling(),M.info("Started default features collection"),t.getSlaveBrowserProps().startFeature(),t.getParentCommunicator().registerToParent(),t}}}]),SlaveStartPoint}();function Application_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Co={Application:function(){function Application(){!function Application_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Application),function PolyfillsApplier_apply(){apply(self),Polyfills_apply(),WeakMapPolyfill_apply("undefined"!=typeof self?self:"undefined"!=typeof window?window:this)}()}return function Application_createClass(e,t,n){t&&Application_defineProperties(e.prototype,t),n&&Application_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(Application,[{key:"start",value:function start(){return(new bo).start()}}]),Application}()}}},r={};function __webpack_require__(e){var t=r[e];if(void 0!==t)return t.exports;t=r[e]={exports:{}};return n[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.amdO={},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var e={};(__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),(new(__webpack_require__(492).default.Application)).start(),cdwpb=e}();